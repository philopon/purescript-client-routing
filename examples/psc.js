// Generated by psc version 0.6.8
var PS = PS || {};
PS.Prelude = (function () {
    "use strict";
    
    function cons(e) {
      return function(l) {
        return [e].concat(l);
      };
    }
    ;
    
    function showStringImpl(s) {
      return JSON.stringify(s);
    }
    ;
    
    function showNumberImpl(n) {
      return n.toString();
    }
    ;
    
    function showArrayImpl(f) {
      return function(xs) {
        var ss = [];
        for (var i = 0, l = xs.length; i < l; i++) {
          ss[i] = f(xs[i]);
        }
        return '[' + ss.join(',') + ']';
      };
    }
    ;
    
    function numAdd(n1) {
      return function(n2) {
        return n1 + n2;
      };
    }
    ;
    
    function numSub(n1) {
      return function(n2) {
        return n1 - n2;
      };
    }
    ;
    
    function numMul(n1) {
      return function(n2) {
        return n1 * n2;
      };
    }
    ;
    
    function numDiv(n1) {
      return function(n2) {
        return n1 / n2;
      };
    }
    ;
    
    function numMod(n1) {
      return function(n2) {
        return n1 % n2;
      };
    }
    ;
    
    function refEq(r1) {
      return function(r2) {
        return r1 === r2;
      };
    }
    ;
    
    function refIneq(r1) {
      return function(r2) {
        return r1 !== r2;
      };
    }
    ;
    
    function eqArrayImpl(f) {
      return function(xs) {
        return function(ys) {
          if (xs.length !== ys.length) return false;
          for (var i = 0; i < xs.length; i++) {
            if (!f(xs[i])(ys[i])) return false;
          }
          return true;
        };
      };
    }
    ;
    
    function unsafeCompareImpl(lt) {
      return function(eq) {
        return function(gt) {
          return function(x) {
            return function(y) {
              return x < y ? lt : x > y ? gt : eq;
            };
          };
        };
      };
    }
    ;
    
    function numShl(n1) {
      return function(n2) {
        return n1 << n2;
      };
    }
    ;
    
    function numShr(n1) {
      return function(n2) {
        return n1 >> n2;
      };
    }
    ;
    
    function numZshr(n1) {
      return function(n2) {
        return n1 >>> n2;
      };
    }
    ;
    
    function numAnd(n1) {
      return function(n2) {
        return n1 & n2;
      };
    }
    ;
    
    function numOr(n1) {
      return function(n2) {
        return n1 | n2;
      };
    }
    ;
    
    function numXor(n1) {
      return function(n2) {
        return n1 ^ n2;
      };
    }
    ;
    
    function numComplement(n) {
      return ~n;
    }
    ;
    
    function boolAnd(b1) {
      return function(b2) {
        return b1 && b2;
      };
    }
    ;
    
    function boolOr(b1) {
      return function(b2) {
        return b1 || b2;
      };
    }
    ;
    
    function boolNot(b) {
      return !b;
    }
    ;
    
    function concatString(s1) {
      return function(s2) {
        return s1 + s2;
      };
    }
    ;
    var Unit = function (x) {
        return x;
    };
    var LT = (function () {
        function LT() {

        };
        LT.value = new LT();
        return LT;
    })();
    var GT = (function () {
        function GT() {

        };
        GT.value = new GT();
        return GT;
    })();
    var EQ = (function () {
        function EQ() {

        };
        EQ.value = new EQ();
        return EQ;
    })();
    var Semigroupoid = function ($less$less$less) {
        this["<<<"] = $less$less$less;
    };
    var Category = function (__superclass_Prelude$dotSemigroupoid_0, id) {
        this["__superclass_Prelude.Semigroupoid_0"] = __superclass_Prelude$dotSemigroupoid_0;
        this.id = id;
    };
    var Show = function (show) {
        this.show = show;
    };
    var Functor = function ($less$dollar$greater) {
        this["<$>"] = $less$dollar$greater;
    };
    var Apply = function ($less$times$greater, __superclass_Prelude$dotFunctor_0) {
        this["<*>"] = $less$times$greater;
        this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
    };
    var Applicative = function (__superclass_Prelude$dotApply_0, pure) {
        this["__superclass_Prelude.Apply_0"] = __superclass_Prelude$dotApply_0;
        this.pure = pure;
    };
    var Bind = function ($greater$greater$eq, __superclass_Prelude$dotApply_0) {
        this[">>="] = $greater$greater$eq;
        this["__superclass_Prelude.Apply_0"] = __superclass_Prelude$dotApply_0;
    };
    var Monad = function (__superclass_Prelude$dotApplicative_0, __superclass_Prelude$dotBind_1) {
        this["__superclass_Prelude.Applicative_0"] = __superclass_Prelude$dotApplicative_0;
        this["__superclass_Prelude.Bind_1"] = __superclass_Prelude$dotBind_1;
    };
    
    /**
     *  | Addition and multiplication
     */
    var Semiring = function ($times, $plus, one, zero) {
        this["*"] = $times;
        this["+"] = $plus;
        this.one = one;
        this.zero = zero;
    };
    
    /**
     *  | Semiring with modulo operation and division where
     *  | ```a / b * b + (a `mod` b) = a```
     */
    var ModuloSemiring = function ($div, __superclass_Prelude$dotSemiring_0, mod) {
        this["/"] = $div;
        this["__superclass_Prelude.Semiring_0"] = __superclass_Prelude$dotSemiring_0;
        this.mod = mod;
    };
    
    /**
     *  | Addition, multiplication, and subtraction
     */
    var Ring = function ($minus, __superclass_Prelude$dotSemiring_0) {
        this["-"] = $minus;
        this["__superclass_Prelude.Semiring_0"] = __superclass_Prelude$dotSemiring_0;
    };
    
    /**
     *  | Ring where every nonzero element has a multiplicative inverse (possibly
     *  | a non-commutative field) so that ```a `mod` b = zero```
     */
    var DivisionRing = function (__superclass_Prelude$dotModuloSemiring_1, __superclass_Prelude$dotRing_0) {
        this["__superclass_Prelude.ModuloSemiring_1"] = __superclass_Prelude$dotModuloSemiring_1;
        this["__superclass_Prelude.Ring_0"] = __superclass_Prelude$dotRing_0;
    };
    
    /**
     *  | A commutative field
     */
    var Num = function (__superclass_Prelude$dotDivisionRing_0) {
        this["__superclass_Prelude.DivisionRing_0"] = __superclass_Prelude$dotDivisionRing_0;
    };
    var Eq = function ($div$eq, $eq$eq) {
        this["/="] = $div$eq;
        this["=="] = $eq$eq;
    };
    var Ord = function (__superclass_Prelude$dotEq_0, compare) {
        this["__superclass_Prelude.Eq_0"] = __superclass_Prelude$dotEq_0;
        this.compare = compare;
    };
    var Bits = function ($dot$amp$dot, $dot$up$dot, $dot$bar$dot, complement, shl, shr, zshr) {
        this[".&."] = $dot$amp$dot;
        this[".^."] = $dot$up$dot;
        this[".|."] = $dot$bar$dot;
        this.complement = complement;
        this.shl = shl;
        this.shr = shr;
        this.zshr = zshr;
    };
    var BoolLike = function ($amp$amp, not, $bar$bar) {
        this["&&"] = $amp$amp;
        this.not = not;
        this["||"] = $bar$bar;
    };
    var Semigroup = function ($less$greater) {
        this["<>"] = $less$greater;
    };
    var $bar$bar = function (dict) {
        return dict["||"];
    };
    var $greater$greater$eq = function (dict) {
        return dict[">>="];
    };
    var $eq$eq = function (dict) {
        return dict["=="];
    };
    var $less$greater = function (dict) {
        return dict["<>"];
    };
    var $less$less$less = function (dict) {
        return dict["<<<"];
    };
    var $greater$greater$greater = function (__dict_Semigroupoid_0) {
        return function (f) {
            return function (g) {
                return $less$less$less(__dict_Semigroupoid_0)(g)(f);
            };
        };
    };
    var $less$times$greater = function (dict) {
        return dict["<*>"];
    };
    var $less$dollar$greater = function (dict) {
        return dict["<$>"];
    };
    var $less$hash$greater = function (__dict_Functor_1) {
        return function (fa) {
            return function (f) {
                return $less$dollar$greater(__dict_Functor_1)(f)(fa);
            };
        };
    };
    var $colon = cons;
    var $div$eq = function (dict) {
        return dict["/="];
    };
    
    /**
     *  | Semiring with modulo operation and division where
     *  | ```a / b * b + (a `mod` b) = a```
     */
    var $div = function (dict) {
        return dict["/"];
    };
    var $dot$bar$dot = function (dict) {
        return dict[".|."];
    };
    var $dot$up$dot = function (dict) {
        return dict[".^."];
    };
    var $dot$amp$dot = function (dict) {
        return dict[".&."];
    };
    
    /**
     *  | Addition, multiplication, and subtraction
     */
    var $minus = function (dict) {
        return dict["-"];
    };
    var $plus$plus = function (__dict_Semigroup_2) {
        return $less$greater(__dict_Semigroup_2);
    };
    
    /**
     *  | Addition and multiplication
     */
    var $plus = function (dict) {
        return dict["+"];
    };
    
    /**
     *  | Addition and multiplication
     */
    var $times = function (dict) {
        return dict["*"];
    };
    var $amp$amp = function (dict) {
        return dict["&&"];
    };
    var $percent = numMod;
    var $dollar = function (f) {
        return function (x) {
            return f(x);
        };
    };
    var $hash = function (x) {
        return function (f) {
            return f(x);
        };
    };
    var zshr = function (dict) {
        return dict.zshr;
    };
    
    /**
     *  | Addition and multiplication
     */
    var zero = function (dict) {
        return dict.zero;
    };
    var unsafeCompare = unsafeCompareImpl(LT.value)(EQ.value)(GT.value);
    var unit = {};
    var shr = function (dict) {
        return dict.shr;
    };
    var showUnit = new Show(function (_44) {
        return "Unit {}";
    });
    var showString = new Show(showStringImpl);
    var showOrdering = new Show(function (_54) {
        if (_54 instanceof LT) {
            return "LT";
        };
        if (_54 instanceof GT) {
            return "GT";
        };
        if (_54 instanceof EQ) {
            return "EQ";
        };
        throw new Error("Failed pattern match");
    });
    var showNumber = new Show(showNumberImpl);
    var showBoolean = new Show(function (_45) {
        if (_45) {
            return "true";
        };
        if (!_45) {
            return "false";
        };
        throw new Error("Failed pattern match");
    });
    var show = function (dict) {
        return dict.show;
    };
    var showArray = function (__dict_Show_3) {
        return new Show(showArrayImpl(show(__dict_Show_3)));
    };
    var shl = function (dict) {
        return dict.shl;
    };
    var semiringNumber = new Semiring(numMul, numAdd, 1, 0);
    var semigroupoidArr = new Semigroupoid(function (f) {
        return function (g) {
            return function (x) {
                return f(g(x));
            };
        };
    });
    var semigroupUnit = new Semigroup(function (_61) {
        return function (_62) {
            return {};
        };
    });
    var semigroupString = new Semigroup(concatString);
    var semigroupArr = function (__dict_Semigroup_4) {
        return new Semigroup(function (f) {
            return function (g) {
                return function (x) {
                    return $less$greater(__dict_Semigroup_4)(f(x))(g(x));
                };
            };
        });
    };
    var ringNumber = new Ring(numSub, function () {
        return semiringNumber;
    });
    var pure = function (dict) {
        return dict.pure;
    };
    var $$return = function (__dict_Monad_5) {
        return pure(__dict_Monad_5["__superclass_Prelude.Applicative_0"]());
    };
    
    /**
     *  | An alias for `true`, which can be useful in guard clauses:
     *  |
     *  | E.g.
     *  |
     *  |     max x y | x >= y = x
     *  |             | otherwise = y
     */
    var otherwise = true;
    
    /**
     *  | Addition and multiplication
     */
    var one = function (dict) {
        return dict.one;
    };
    var not = function (dict) {
        return dict.not;
    };
    var negate = function (__dict_Ring_6) {
        return function (a) {
            return $minus(__dict_Ring_6)(zero(__dict_Ring_6["__superclass_Prelude.Semiring_0"]()))(a);
        };
    };
    var moduloSemiringNumber = new ModuloSemiring(numDiv, function () {
        return semiringNumber;
    }, function (_46) {
        return function (_47) {
            return 0;
        };
    });
    
    /**
     *  | Semiring with modulo operation and division where
     *  | ```a / b * b + (a `mod` b) = a```
     */
    var mod = function (dict) {
        return dict.mod;
    };
    var liftM1 = function (__dict_Monad_7) {
        return function (f) {
            return function (a) {
                return $greater$greater$eq(__dict_Monad_7["__superclass_Prelude.Bind_1"]())(a)(function (_0) {
                    return $$return(__dict_Monad_7)(f(_0));
                });
            };
        };
    };
    var liftA1 = function (__dict_Applicative_8) {
        return function (f) {
            return function (a) {
                return $less$times$greater(__dict_Applicative_8["__superclass_Prelude.Apply_0"]())(pure(__dict_Applicative_8)(f))(a);
            };
        };
    };
    var id = function (dict) {
        return dict.id;
    };
    var functorArr = new Functor($less$less$less(semigroupoidArr));
    
    /**
     *  | Flips the order of the arguments to a function of two arguments.
     */
    var flip = function (f) {
        return function (b) {
            return function (a) {
                return f(a)(b);
            };
        };
    };
    var eqUnit = new Eq(function (_50) {
        return function (_51) {
            return false;
        };
    }, function (_48) {
        return function (_49) {
            return true;
        };
    });
    var ordUnit = new Ord(function () {
        return eqUnit;
    }, function (_55) {
        return function (_56) {
            return EQ.value;
        };
    });
    var eqString = new Eq(refIneq, refEq);
    var ordString = new Ord(function () {
        return eqString;
    }, unsafeCompare);
    var eqNumber = new Eq(refIneq, refEq);
    var ordNumber = new Ord(function () {
        return eqNumber;
    }, unsafeCompare);
    var eqBoolean = new Eq(refIneq, refEq);
    var ordBoolean = new Ord(function () {
        return eqBoolean;
    }, function (_57) {
        return function (_58) {
            if (!_57 && !_58) {
                return EQ.value;
            };
            if (!_57 && _58) {
                return LT.value;
            };
            if (_57 && _58) {
                return EQ.value;
            };
            if (_57 && !_58) {
                return GT.value;
            };
            throw new Error("Failed pattern match");
        };
    });
    var divisionRingNumber = new DivisionRing(function () {
        return moduloSemiringNumber;
    }, function () {
        return ringNumber;
    });
    var numNumber = new Num(function () {
        return divisionRingNumber;
    });
    
    /**
     *  | Returns its first argument and ignores its second.
     */
    var $$const = function (_40) {
        return function (_41) {
            return _40;
        };
    };
    var $$void = function (__dict_Functor_10) {
        return function (fa) {
            return $less$dollar$greater(__dict_Functor_10)($$const(unit))(fa);
        };
    };
    var complement = function (dict) {
        return dict.complement;
    };
    var compare = function (dict) {
        return dict.compare;
    };
    var $less = function (__dict_Ord_12) {
        return function (a1) {
            return function (a2) {
                var _505 = compare(__dict_Ord_12)(a1)(a2);
                if (_505 instanceof LT) {
                    return true;
                };
                return false;
            };
        };
    };
    var $less$eq = function (__dict_Ord_13) {
        return function (a1) {
            return function (a2) {
                var _506 = compare(__dict_Ord_13)(a1)(a2);
                if (_506 instanceof GT) {
                    return false;
                };
                return true;
            };
        };
    };
    var $greater = function (__dict_Ord_14) {
        return function (a1) {
            return function (a2) {
                var _507 = compare(__dict_Ord_14)(a1)(a2);
                if (_507 instanceof GT) {
                    return true;
                };
                return false;
            };
        };
    };
    var $greater$eq = function (__dict_Ord_15) {
        return function (a1) {
            return function (a2) {
                var _508 = compare(__dict_Ord_15)(a1)(a2);
                if (_508 instanceof LT) {
                    return false;
                };
                return true;
            };
        };
    };
    var categoryArr = new Category(function () {
        return semigroupoidArr;
    }, function (x) {
        return x;
    });
    var boolLikeBoolean = new BoolLike(boolAnd, boolNot, boolOr);
    var eqArray = function (__dict_Eq_9) {
        return new Eq(function (xs) {
            return function (ys) {
                return not(boolLikeBoolean)($eq$eq(eqArray(__dict_Eq_9))(xs)(ys));
            };
        }, function (xs) {
            return function (ys) {
                return eqArrayImpl($eq$eq(__dict_Eq_9))(xs)(ys);
            };
        });
    };
    var ordArray = function (__dict_Ord_11) {
        return new Ord(function () {
            return eqArray(__dict_Ord_11["__superclass_Prelude.Eq_0"]());
        }, function (_59) {
            return function (_60) {
                if (_59.length === 0 && _60.length === 0) {
                    return EQ.value;
                };
                if (_59.length === 0) {
                    return LT.value;
                };
                if (_60.length === 0) {
                    return GT.value;
                };
                if (_59.length >= 1) {
                    var _515 = _59.slice(1);
                    if (_60.length >= 1) {
                        var _513 = _60.slice(1);
                        var _511 = compare(__dict_Ord_11)(_59[0])(_60[0]);
                        if (_511 instanceof EQ) {
                            return compare(ordArray(__dict_Ord_11))(_515)(_513);
                        };
                        return _511;
                    };
                };
                throw new Error("Failed pattern match");
            };
        });
    };
    var eqOrdering = new Eq(function (x) {
        return function (y) {
            return not(boolLikeBoolean)($eq$eq(eqOrdering)(x)(y));
        };
    }, function (_52) {
        return function (_53) {
            if (_52 instanceof LT && _53 instanceof LT) {
                return true;
            };
            if (_52 instanceof GT && _53 instanceof GT) {
                return true;
            };
            if (_52 instanceof EQ && _53 instanceof EQ) {
                return true;
            };
            return false;
        };
    });
    var bitsNumber = new Bits(numAnd, numXor, numOr, numComplement, numShl, numShr, numZshr);
    
    /**
     *  | This function returns its first argument, and can be used to assert type equalities.
     *  | This can be useful when types are otherwise ambiguous.
     *  |
     *  | E.g.
     *  |
     *  |     main = print $ [] `asTypeOf` [0]
     *  |
     *  | If instead, we had written `main = print []`, the type of the argument `[]` would have
     *  | been ambiguous, resulting in a compile-time error.
     */
    var asTypeOf = function (_42) {
        return function (_43) {
            return _42;
        };
    };
    var applyArr = new Apply(function (f) {
        return function (g) {
            return function (x) {
                return f(x)(g(x));
            };
        };
    }, function () {
        return functorArr;
    });
    var bindArr = new Bind(function (m) {
        return function (f) {
            return function (x) {
                return f(m(x))(x);
            };
        };
    }, function () {
        return applyArr;
    });
    var applicativeArr = new Applicative(function () {
        return applyArr;
    }, $$const);
    var monadArr = new Monad(function () {
        return applicativeArr;
    }, function () {
        return bindArr;
    });
    var ap = function (__dict_Monad_16) {
        return function (f) {
            return function (a) {
                return $greater$greater$eq(__dict_Monad_16["__superclass_Prelude.Bind_1"]())(f)(function (_2) {
                    return $greater$greater$eq(__dict_Monad_16["__superclass_Prelude.Bind_1"]())(a)(function (_1) {
                        return $$return(__dict_Monad_16)(_2(_1));
                    });
                });
            };
        };
    };
    return {
        Unit: Unit, 
        LT: LT, 
        GT: GT, 
        EQ: EQ, 
        Semigroup: Semigroup, 
        BoolLike: BoolLike, 
        Bits: Bits, 
        Ord: Ord, 
        Eq: Eq, 
        Num: Num, 
        DivisionRing: DivisionRing, 
        Ring: Ring, 
        ModuloSemiring: ModuloSemiring, 
        Semiring: Semiring, 
        Monad: Monad, 
        Bind: Bind, 
        Applicative: Applicative, 
        Apply: Apply, 
        Functor: Functor, 
        Show: Show, 
        Category: Category, 
        Semigroupoid: Semigroupoid, 
        unit: unit, 
        "++": $plus$plus, 
        "<>": $less$greater, 
        not: not, 
        "||": $bar$bar, 
        "&&": $amp$amp, 
        complement: complement, 
        zshr: zshr, 
        shr: shr, 
        shl: shl, 
        ".^.": $dot$up$dot, 
        ".|.": $dot$bar$dot, 
        ".&.": $dot$amp$dot, 
        ">=": $greater$eq, 
        "<=": $less$eq, 
        ">": $greater, 
        "<": $less, 
        compare: compare, 
        refIneq: refIneq, 
        refEq: refEq, 
        "/=": $div$eq, 
        "==": $eq$eq, 
        negate: negate, 
        "%": $percent, 
        "-": $minus, 
        mod: mod, 
        "/": $div, 
        one: one, 
        "*": $times, 
        zero: zero, 
        "+": $plus, 
        ap: ap, 
        liftM1: liftM1, 
        "return": $$return, 
        ">>=": $greater$greater$eq, 
        liftA1: liftA1, 
        pure: pure, 
        "<*>": $less$times$greater, 
        "void": $$void, 
        "<#>": $less$hash$greater, 
        "<$>": $less$dollar$greater, 
        show: show, 
        cons: cons, 
        ":": $colon, 
        "#": $hash, 
        "$": $dollar, 
        id: id, 
        ">>>": $greater$greater$greater, 
        "<<<": $less$less$less, 
        asTypeOf: asTypeOf, 
        "const": $$const, 
        flip: flip, 
        otherwise: otherwise, 
        semigroupoidArr: semigroupoidArr, 
        categoryArr: categoryArr, 
        showUnit: showUnit, 
        showString: showString, 
        showBoolean: showBoolean, 
        showNumber: showNumber, 
        showArray: showArray, 
        functorArr: functorArr, 
        applyArr: applyArr, 
        applicativeArr: applicativeArr, 
        bindArr: bindArr, 
        monadArr: monadArr, 
        semiringNumber: semiringNumber, 
        ringNumber: ringNumber, 
        moduloSemiringNumber: moduloSemiringNumber, 
        divisionRingNumber: divisionRingNumber, 
        numNumber: numNumber, 
        eqUnit: eqUnit, 
        eqString: eqString, 
        eqNumber: eqNumber, 
        eqBoolean: eqBoolean, 
        eqArray: eqArray, 
        eqOrdering: eqOrdering, 
        showOrdering: showOrdering, 
        ordUnit: ordUnit, 
        ordBoolean: ordBoolean, 
        ordNumber: ordNumber, 
        ordString: ordString, 
        ordArray: ordArray, 
        bitsNumber: bitsNumber, 
        boolLikeBoolean: boolLikeBoolean, 
        semigroupUnit: semigroupUnit, 
        semigroupString: semigroupString, 
        semigroupArr: semigroupArr
    };
})();
var PS = PS || {};
PS.Prelude_Unsafe = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    
    function unsafeIndex(xs) {
      return function(n) {
        return xs[n];
      };
    }
    ;
    return {
        unsafeIndex: unsafeIndex
    };
})();
var PS = PS || {};
PS.Network_Routing_Client_Foreign = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    
var director = (function(exports){


//
// Generated on Sat Dec 06 2014 16:08:09 GMT-0500 (EST) by Charlie Robbins, Paolo Fragomeni & the Contributors (Using Codesurgeon).
// Version 1.2.4
//

(function (exports) {

/*
 * browser.js: Browser specific functionality for director.
 *
 * (C) 2011, Charlie Robbins, Paolo Fragomeni, & the Contributors.
 * MIT LICENSE
 *
 */

var dloc = document.location;

function dlocHashEmpty() {
  // Non-IE browsers return '' when the address bar shows '#'; Director's logic
  // assumes both mean empty.
  return dloc.hash === '' || dloc.hash === '#';
}

var listener = {
  mode: 'modern',
  hash: dloc.hash,
  history: false,

  check: function () {
    var h = dloc.hash;
    if (h != this.hash) {
      this.hash = h;
      this.onHashChanged();
    }
  },

  fire: function () {
    if (this.mode === 'modern') {
      this.history === true ? window.onpopstate() : window.onhashchange();
    }
    else {
      this.onHashChanged();
    }
  },

  init: function (fn, history) {
    var self = this;
    this.history = history;

    if (!Router.listeners) {
      Router.listeners = [];
    }

    function onchange(onChangeEvent) {
      for (var i = 0, l = Router.listeners.length; i < l; i++) {
        Router.listeners[i](onChangeEvent);
      }
    }

    //note IE8 is being counted as 'modern' because it has the hashchange event
    if ('onhashchange' in window && (document.documentMode === undefined
      || document.documentMode > 7)) {
      // At least for now HTML5 history is available for 'modern' browsers only
      if (this.history === true) {
        // There is an old bug in Chrome that causes onpopstate to fire even
        // upon initial page load. Since the handler is run manually in init(),
        // this would cause Chrome to run it twise. Currently the only
        // workaround seems to be to set the handler after the initial page load
        // http://code.google.com/p/chromium/issues/detail?id=63040
        setTimeout(function() {
          window.onpopstate = onchange;
        }, 500);
      }
      else {
        window.onhashchange = onchange;
      }
      this.mode = 'modern';
    }
    else {
      //
      // IE support, based on a concept by Erik Arvidson ...
      //
      var frame = document.createElement('iframe');
      frame.id = 'state-frame';
      frame.style.display = 'none';
      document.body.appendChild(frame);
      this.writeFrame('');

      if ('onpropertychange' in document && 'attachEvent' in document) {
        document.attachEvent('onpropertychange', function () {
          if (event.propertyName === 'location') {
            self.check();
          }
        });
      }

      window.setInterval(function () { self.check(); }, 50);

      this.onHashChanged = onchange;
      this.mode = 'legacy';
    }

    Router.listeners.push(fn);

    return this.mode;
  },

  destroy: function (fn) {
    if (!Router || !Router.listeners) {
      return;
    }

    var listeners = Router.listeners;

    for (var i = listeners.length - 1; i >= 0; i--) {
      if (listeners[i] === fn) {
        listeners.splice(i, 1);
      }
    }
  },

  setHash: function (s) {
    // Mozilla always adds an entry to the history
    if (this.mode === 'legacy') {
      this.writeFrame(s);
    }

    if (this.history === true) {
      window.history.pushState({}, document.title, s);
      // Fire an onpopstate event manually since pushing does not obviously
      // trigger the pop event.
      this.fire();
    } else {
      dloc.hash = (s[0] === '/') ? s : '/' + s;
    }
    return this;
  },

  writeFrame: function (s) {
    // IE support...
    var f = document.getElementById('state-frame');
    var d = f.contentDocument || f.contentWindow.document;
    d.open();
    d.write("<script>_hash = '" + s + "'; onload = parent.listener.syncHash;<script>");
    d.close();
  },

  syncHash: function () {
    // IE support...
    var s = this._hash;
    if (s != dloc.hash) {
      dloc.hash = s;
    }
    return this;
  },

  onHashChanged: function () {}
};

var Router = exports.Router = function (routes) {
  if (!(this instanceof Router)) return new Router(routes);

  this.params   = {};
  this.routes   = {};
  this.methods  = ['on', 'once', 'after', 'before'];
  this.scope    = [];
  this._methods = {};

  this._insert = this.insert;
  this.insert = this.insertEx;

  this.historySupport = (window.history != null ? window.history.pushState : null) != null

  this.configure();
  this.mount(routes || {});
};

Router.prototype.init = function (r) {
  var self = this
    , routeTo;
  this.handler = function(onChangeEvent) {
    var newURL = onChangeEvent && onChangeEvent.newURL || window.location.hash;
    var url = self.history === true ? self.getPath() : newURL.replace(/.*#/, '');
    self.dispatch('on', url.charAt(0) === '/' ? url : '/' + url);
  };

  listener.init(this.handler, this.history);

  if (this.history === false) {
    if (dlocHashEmpty() && r) {
      dloc.hash = r;
    } else if (!dlocHashEmpty()) {
      self.dispatch('on', '/' + dloc.hash.replace(/^(#\/|#|\/)/, ''));
    }
  }
  else {
    if (this.convert_hash_in_init) {
      // Use hash as route
      routeTo = dlocHashEmpty() && r ? r : !dlocHashEmpty() ? dloc.hash.replace(/^#/, '') : null;
      if (routeTo) {
        window.history.replaceState({}, document.title, routeTo);
      }
    }
    else {
      // Use canonical url
      routeTo = this.getPath();
    }

    // Router has been initialized, but due to the chrome bug it will not
    // yet actually route HTML5 history state changes. Thus, decide if should route.
    if (routeTo || this.run_in_init === true) {
      this.handler();
    }
  }

  return this;
};

Router.prototype.explode = function () {
  var v = this.history === true ? this.getPath() : dloc.hash;
  if (v.charAt(1) === '/') { v=v.slice(1) }
  return v.slice(1, v.length).split("/");
};

Router.prototype.setRoute = function (i, v, val) {
  var url = this.explode();

  if (typeof i === 'number' && typeof v === 'string') {
    url[i] = v;
  }
  else if (typeof val === 'string') {
    url.splice(i, v, s);
  }
  else {
    url = [i];
  }

  listener.setHash(url.join('/'));
  return url;
};

//
// ### function insertEx(method, path, route, parent)
// #### @method {string} Method to insert the specific `route`.
// #### @path {Array} Parsed path to insert the `route` at.
// #### @route {Array|function} Route handlers to insert.
// #### @parent {Object} **Optional** Parent "routes" to insert into.
// insert a callback that will only occur once per the matched route.
//
Router.prototype.insertEx = function(method, path, route, parent) {
  if (method === "once") {
    method = "on";
    route = function(route) {
      var once = false;
      return function() {
        if (once) return;
        once = true;
        return route.apply(this, arguments);
      };
    }(route);
  }
  return this._insert(method, path, route, parent);
};

Router.prototype.getRoute = function (v) {
  var ret = v;

  if (typeof v === "number") {
    ret = this.explode()[v];
  }
  else if (typeof v === "string"){
    var h = this.explode();
    ret = h.indexOf(v);
  }
  else {
    ret = this.explode();
  }

  return ret;
};

Router.prototype.destroy = function () {
  listener.destroy(this.handler);
  return this;
};

Router.prototype.getPath = function () {
  var path = window.location.pathname;
  if (path.substr(0, 1) !== '/') {
    path = '/' + path;
  }
  return path;
};
function _every(arr, iterator) {
  for (var i = 0; i < arr.length; i += 1) {
    if (iterator(arr[i], i, arr) === false) {
      return;
    }
  }
}

function _flatten(arr) {
  var flat = [];
  for (var i = 0, n = arr.length; i < n; i++) {
    flat = flat.concat(arr[i]);
  }
  return flat;
}

function _asyncEverySeries(arr, iterator, callback) {
  if (!arr.length) {
    return callback();
  }
  var completed = 0;
  (function iterate() {
    iterator(arr[completed], function(err) {
      if (err || err === false) {
        callback(err);
        callback = function() {};
      } else {
        completed += 1;
        if (completed === arr.length) {
          callback();
        } else {
          iterate();
        }
      }
    });
  })();
}

function paramifyString(str, params, mod) {
  mod = str;
  for (var param in params) {
    if (params.hasOwnProperty(param)) {
      mod = params[param](str);
      if (mod !== str) {
        break;
      }
    }
  }
  return mod === str ? "([._a-zA-Z0-9-]+)" : mod;
}

function regifyString(str, params) {
  var matches, last = 0, out = "";
  while (matches = str.substr(last).match(/[^\w\d\- %@&]*\*[^\w\d\- %@&]*/)) {
    last = matches.index + matches[0].length;
    matches[0] = matches[0].replace(/^\*/, "([_.()!\\ %@&a-zA-Z0-9-]+)");
    out += str.substr(0, matches.index) + matches[0];
  }
  str = out += str.substr(last);
  var captures = str.match(/:([^\/]+)/ig), capture, length;
  if (captures) {
    length = captures.length;
    for (var i = 0; i < length; i++) {
      capture = captures[i];
      if (capture.slice(0, 2) === "::") {
        str = capture.slice(1);
      } else {
        str = str.replace(capture, paramifyString(capture, params));
      }
    }
  }
  return str;
}

function terminator(routes, delimiter, start, stop) {
  var last = 0, left = 0, right = 0, start = (start || "(").toString(), stop = (stop || ")").toString(), i;
  for (i = 0; i < routes.length; i++) {
    var chunk = routes[i];
    if (chunk.indexOf(start, last) > chunk.indexOf(stop, last) || ~chunk.indexOf(start, last) && !~chunk.indexOf(stop, last) || !~chunk.indexOf(start, last) && ~chunk.indexOf(stop, last)) {
      left = chunk.indexOf(start, last);
      right = chunk.indexOf(stop, last);
      if (~left && !~right || !~left && ~right) {
        var tmp = routes.slice(0, (i || 1) + 1).join(delimiter);
        routes = [ tmp ].concat(routes.slice((i || 1) + 1));
      }
      last = (right > left ? right : left) + 1;
      i = 0;
    } else {
      last = 0;
    }
  }
  return routes;
}

var QUERY_SEPARATOR = /\?.*/;

Router.prototype.configure = function(options) {
  options = options || {};
  for (var i = 0; i < this.methods.length; i++) {
    this._methods[this.methods[i]] = true;
  }
  this.recurse = options.recurse || this.recurse || false;
  this.async = options.async || false;
  this.delimiter = options.delimiter || "/";
  this.strict = typeof options.strict === "undefined" ? true : options.strict;
  this.notfound = options.notfound;
  this.resource = options.resource;
  this.history = options.html5history && this.historySupport || false;
  this.run_in_init = this.history === true && options.run_handler_in_init !== false;
  this.convert_hash_in_init = this.history === true && options.convert_hash_in_init !== false;
  this.every = {
    after: options.after || null,
    before: options.before || null,
    on: options.on || null
  };
  return this;
};

Router.prototype.param = function(token, matcher) {
  if (token[0] !== ":") {
    token = ":" + token;
  }
  var compiled = new RegExp(token, "g");
  this.params[token] = function(str) {
    return str.replace(compiled, matcher.source || matcher);
  };
  return this;
};

Router.prototype.on = Router.prototype.route = function(method, path, route) {
  var self = this;
  if (!route && typeof path == "function") {
    route = path;
    path = method;
    method = "on";
  }
  if (Array.isArray(path)) {
    return path.forEach(function(p) {
      self.on(method, p, route);
    });
  }
  if (path.source) {
    path = path.source.replace(/\\\//ig, "/");
  }
  if (Array.isArray(method)) {
    return method.forEach(function(m) {
      self.on(m.toLowerCase(), path, route);
    });
  }
  path = path.split(new RegExp(this.delimiter));
  path = terminator(path, this.delimiter);
  this.insert(method, this.scope.concat(path), route);
};

Router.prototype.path = function(path, routesFn) {
  var self = this, length = this.scope.length;
  if (path.source) {
    path = path.source.replace(/\\\//ig, "/");
  }
  path = path.split(new RegExp(this.delimiter));
  path = terminator(path, this.delimiter);
  this.scope = this.scope.concat(path);
  routesFn.call(this, this);
  this.scope.splice(length, path.length);
};

Router.prototype.dispatch = function(method, path, callback) {
  var self = this, fns = this.traverse(method, path.replace(QUERY_SEPARATOR, ""), this.routes, ""), invoked = this._invoked, after;
  this._invoked = true;
  if (!fns || fns.length === 0) {
    this.last = [];
    if (typeof this.notfound === "function") {
      this.invoke([ this.notfound ], {
        method: method,
        path: path
      }, callback);
    }
    return false;
  }
  if (this.recurse === "forward") {
    fns = fns.reverse();
  }
  function updateAndInvoke() {
    self.last = fns.after;
    self.invoke(self.runlist(fns), self, callback);
  }
  after = this.every && this.every.after ? [ this.every.after ].concat(this.last) : [ this.last ];
  if (after && after.length > 0 && invoked) {
    if (this.async) {
      this.invoke(after, this, updateAndInvoke);
    } else {
      this.invoke(after, this);
      updateAndInvoke();
    }
    return true;
  }
  updateAndInvoke();
  return true;
};

Router.prototype.invoke = function(fns, thisArg, callback) {
  var self = this;
  var apply;
  if (this.async) {
    apply = function(fn, next) {
      if (Array.isArray(fn)) {
        return _asyncEverySeries(fn, apply, next);
      } else if (typeof fn == "function") {
        fn.apply(thisArg, (fns.captures || []).concat(next));
      }
    };
    _asyncEverySeries(fns, apply, function() {
      if (callback) {
        callback.apply(thisArg, arguments);
      }
    });
  } else {
    apply = function(fn) {
      if (Array.isArray(fn)) {
        return _every(fn, apply);
      } else if (typeof fn === "function") {
        return fn.apply(thisArg, fns.captures || []);
      } else if (typeof fn === "string" && self.resource) {
        self.resource[fn].apply(thisArg, fns.captures || []);
      }
    };
    _every(fns, apply);
  }
};

Router.prototype.traverse = function(method, path, routes, regexp, filter) {
  var fns = [], current, exact, match, next, that;
  function filterRoutes(routes) {
    if (!filter) {
      return routes;
    }
    function deepCopy(source) {
      var result = [];
      for (var i = 0; i < source.length; i++) {
        result[i] = Array.isArray(source[i]) ? deepCopy(source[i]) : source[i];
      }
      return result;
    }
    function applyFilter(fns) {
      for (var i = fns.length - 1; i >= 0; i--) {
        if (Array.isArray(fns[i])) {
          applyFilter(fns[i]);
          if (fns[i].length === 0) {
            fns.splice(i, 1);
          }
        } else {
          if (!filter(fns[i])) {
            fns.splice(i, 1);
          }
        }
      }
    }
    var newRoutes = deepCopy(routes);
    newRoutes.matched = routes.matched;
    newRoutes.captures = routes.captures;
    newRoutes.after = routes.after.filter(filter);
    applyFilter(newRoutes);
    return newRoutes;
  }
  if (path === this.delimiter && routes[method]) {
    next = [ [ routes.before, routes[method] ].filter(Boolean) ];
    next.after = [ routes.after ].filter(Boolean);
    next.matched = true;
    next.captures = [];
    return filterRoutes(next);
  }
  for (var r in routes) {
    if (routes.hasOwnProperty(r) && (!this._methods[r] || this._methods[r] && typeof routes[r] === "object" && !Array.isArray(routes[r]))) {
      current = exact = regexp + this.delimiter + r;
      if (!this.strict) {
        exact += "[" + this.delimiter + "]?";
      }
      match = path.match(new RegExp("^" + exact));
      if (!match) {
        continue;
      }
      if (match[0] && match[0] == path && routes[r][method]) {
        next = [ [ routes[r].before, routes[r][method] ].filter(Boolean) ];
        next.after = [ routes[r].after ].filter(Boolean);
        next.matched = true;
        next.captures = match.slice(1);
        if (this.recurse && routes === this.routes) {
          next.push([ routes.before, routes.on ].filter(Boolean));
          next.after = next.after.concat([ routes.after ].filter(Boolean));
        }
        return filterRoutes(next);
      }
      next = this.traverse(method, path, routes[r], current);
      if (next.matched) {
        if (next.length > 0) {
          fns = fns.concat(next);
        }
        if (this.recurse) {
          fns.push([ routes[r].before, routes[r].on ].filter(Boolean));
          next.after = next.after.concat([ routes[r].after ].filter(Boolean));
          if (routes === this.routes) {
            fns.push([ routes["before"], routes["on"] ].filter(Boolean));
            next.after = next.after.concat([ routes["after"] ].filter(Boolean));
          }
        }
        fns.matched = true;
        fns.captures = next.captures;
        fns.after = next.after;
        return filterRoutes(fns);
      }
    }
  }
  return false;
};

Router.prototype.insert = function(method, path, route, parent) {
  var methodType, parentType, isArray, nested, part;
  path = path.filter(function(p) {
    return p && p.length > 0;
  });
  parent = parent || this.routes;
  part = path.shift();
  if (/\:|\*/.test(part) && !/\\d|\\w/.test(part)) {
    part = regifyString(part, this.params);
  }
  if (path.length > 0) {
    parent[part] = parent[part] || {};
    return this.insert(method, path, route, parent[part]);
  }
  if (!part && !path.length && parent === this.routes) {
    methodType = typeof parent[method];
    switch (methodType) {
     case "function":
      parent[method] = [ parent[method], route ];
      return;
     case "object":
      parent[method].push(route);
      return;
     case "undefined":
      parent[method] = route;
      return;
    }
    return;
  }
  parentType = typeof parent[part];
  isArray = Array.isArray(parent[part]);
  if (parent[part] && !isArray && parentType == "object") {
    methodType = typeof parent[part][method];
    switch (methodType) {
     case "function":
      parent[part][method] = [ parent[part][method], route ];
      return;
     case "object":
      parent[part][method].push(route);
      return;
     case "undefined":
      parent[part][method] = route;
      return;
    }
  } else if (parentType == "undefined") {
    nested = {};
    nested[method] = route;
    parent[part] = nested;
    return;
  }
  throw new Error("Invalid route context: " + parentType);
};



Router.prototype.extend = function(methods) {
  var self = this, len = methods.length, i;
  function extend(method) {
    self._methods[method] = true;
    self[method] = function() {
      var extra = arguments.length === 1 ? [ method, "" ] : [ method ];
      self.on.apply(self, extra.concat(Array.prototype.slice.call(arguments)));
    };
  }
  for (i = 0; i < len; i++) {
    extend(methods[i]);
  }
};

Router.prototype.runlist = function(fns) {
  var runlist = this.every && this.every.before ? [ this.every.before ].concat(_flatten(fns)) : _flatten(fns);
  if (this.every && this.every.on) {
    runlist.push(this.every.on);
  }
  runlist.captures = fns.captures;
  runlist.source = fns.source;
  return runlist;
};

Router.prototype.mount = function(routes, path) {
  if (!routes || typeof routes !== "object" || Array.isArray(routes)) {
    return;
  }
  var self = this;
  path = path || [];
  if (!Array.isArray(path)) {
    path = path.split(self.delimiter);
  }
  function insertOrMount(route, local) {
    var rename = route, parts = route.split(self.delimiter), routeType = typeof routes[route], isRoute = parts[0] === "" || !self._methods[parts[0]], event = isRoute ? "on" : rename;
    if (isRoute) {
      rename = rename.slice((rename.match(new RegExp("^" + self.delimiter)) || [ "" ])[0].length);
      parts.shift();
    }
    if (isRoute && routeType === "object" && !Array.isArray(routes[route])) {
      local = local.concat(parts);
      self.mount(routes[route], local);
      return;
    }
    if (isRoute) {
      local = local.concat(rename.split(self.delimiter));
      local = terminator(local, self.delimiter);
    }
    self.insert(event, local, routes[route]);
  }
  for (var route in routes) {
    if (routes.hasOwnProperty(route)) {
      insertOrMount(route, path.slice(0));
    }
  }
};



}(typeof exports === "object" ? exports : window));
return exports.Router;
}({}));;
    return {
        director: director
    };
})();
var PS = PS || {};
PS.Data_Function = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    
    function mkFn0(fn) {
      return function() {
        return fn({});
      };
    }
    ;
    
    function mkFn1(fn) {
      return function(a) {
        return fn(a);
      };
    }
    ;
    
    function mkFn2(fn) {
      return function(a, b) {
        return fn(a)(b);
      };
    }
    ;
    
    function mkFn3(fn) {
      return function(a, b, c) {
        return fn(a)(b)(c);
      };
    }
    ;
    
    function mkFn4(fn) {
      return function(a, b, c, d) {
        return fn(a)(b)(c)(d);
      };
    }
    ;
    
    function mkFn5(fn) {
      return function(a, b, c, d, e) {
        return fn(a)(b)(c)(d)(e);
      };
    }
    ;
    
    function mkFn6(fn) {
      return function(a, b, c, d, e, f) {
        return fn(a)(b)(c)(d)(e)(f);
      };
    }
    ;
    
    function mkFn7(fn) {
      return function(a, b, c, d, e, f, g) {
        return fn(a)(b)(c)(d)(e)(f)(g);
      };
    }
    ;
    
    function mkFn8(fn) {
      return function(a, b, c, d, e, f, g, h) {
        return fn(a)(b)(c)(d)(e)(f)(g)(h);
      };
    }
    ;
    
    function mkFn9(fn) {
      return function(a, b, c, d, e, f, g, h, i) {
        return fn(a)(b)(c)(d)(e)(f)(g)(h)(i);
      };
    }
    ;
    
    function mkFn10(fn) {
      return function(a, b, c, d, e, f, g, h, i, j) {
        return fn(a)(b)(c)(d)(e)(f)(g)(h)(i)(j);
      };
    }
    ;
    
    function runFn0(fn) {
      return fn();
    }
    ;
    
    function runFn1(fn) {
      return function(a) {
        return fn(a);
      };
    }
    ;
    
    function runFn2(fn) {
      return function(a) {
        return function(b) {
          return fn(a, b);
        };
      };
    }
    ;
    
    function runFn3(fn) {
      return function(a) {
        return function(b) {
          return function(c) {
            return fn(a, b, c);
          };
        };
      };
    }
    ;
    
    function runFn4(fn) {
      return function(a) {
        return function(b) {
          return function(c) {
            return function(d) {
              return fn(a, b, c, d);
            };
          };
        };
      };
    }
    ;
    
    function runFn5(fn) {
      return function(a) {
        return function(b) {
          return function(c) {
            return function(d) {
              return function(e) {
                return fn(a, b, c, d, e);
              };
            };
          };
        };
      };
    }
    ;
    
    function runFn6(fn) {
      return function(a) {
        return function(b) {
          return function(c) {
            return function(d) {
              return function(e) {
                return function(f) {
                  return fn(a, b, c, d, e, f);
                };
              };
            };
          };
        };
      };
    }
    ;
    
    function runFn7(fn) {
      return function(a) {
        return function(b) {
          return function(c) {
            return function(d) {
              return function(e) {
                return function(f) {
                  return function(g) {
                    return fn(a, b, c, d, e, f, g);
                  };
                };
              };
            };
          };
        };
      };
    }
    ;
    
    function runFn8(fn) {
      return function(a) {
        return function(b) {
          return function(c) {
            return function(d) {
              return function(e) {
                return function(f) {
                  return function(g) {
                    return function(h) {
                      return fn(a, b, c, d, e, f, g, h);
                    };
                  };
                };
              };
            };
          };
        };
      };
    }
    ;
    
    function runFn9(fn) {
      return function(a) {
        return function(b) {
          return function(c) {
            return function(d) {
              return function(e) {
                return function(f) {
                  return function(g) {
                    return function(h) {
                      return function(i) {
                        return fn(a, b, c, d, e, f, g, h, i);
                      };
                    };
                  };
                };
              };
            };
          };
        };
      };
    }
    ;
    
    function runFn10(fn) {
      return function(a) {
        return function(b) {
          return function(c) {
            return function(d) {
              return function(e) {
                return function(f) {
                  return function(g) {
                    return function(h) {
                      return function(i) {
                        return function(j) {
                          return fn(a, b, c, d, e, f, g, h, i, j);
                        };
                      };
                    };
                  };
                };
              };
            };
          };
        };
      };
    }
    ;
    var on = function (f) {
        return function (g) {
            return function (x) {
                return function (y) {
                    return f(g(x))(g(y));
                };
            };
        };
    };
    return {
        runFn10: runFn10, 
        runFn9: runFn9, 
        runFn8: runFn8, 
        runFn7: runFn7, 
        runFn6: runFn6, 
        runFn5: runFn5, 
        runFn4: runFn4, 
        runFn3: runFn3, 
        runFn2: runFn2, 
        runFn1: runFn1, 
        runFn0: runFn0, 
        mkFn10: mkFn10, 
        mkFn9: mkFn9, 
        mkFn8: mkFn8, 
        mkFn7: mkFn7, 
        mkFn6: mkFn6, 
        mkFn5: mkFn5, 
        mkFn4: mkFn4, 
        mkFn3: mkFn3, 
        mkFn2: mkFn2, 
        mkFn1: mkFn1, 
        mkFn0: mkFn0, 
        on: on
    };
})();
var PS = PS || {};
PS.Data_Char = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    
    function toCharCode(c) {
      return c.charCodeAt(0);
    }
    ;
    
    function fromCharCode(c) {
      return String.fromCharCode(c);
    }
    ;
    var Char = function (x) {
        return x;
    };
    var showChar = new Prelude.Show(function (_68) {
        return "Char " + Prelude.show(Prelude.showString)(_68);
    });
    var eqChar = new Prelude.Eq(function (a) {
        return function (b) {
            return !Prelude["=="](eqChar)(a)(b);
        };
    }, function (_64) {
        return function (_65) {
            return _64 === _65;
        };
    });
    var ordChar = new Prelude.Ord(function () {
        return eqChar;
    }, function (_66) {
        return function (_67) {
            return Prelude.compare(Prelude.ordString)(_66)(_67);
        };
    });
    var charString = function (_63) {
        return _63;
    };
    return {
        toCharCode: toCharCode, 
        fromCharCode: fromCharCode, 
        charString: charString, 
        eqChar: eqChar, 
        ordChar: ordChar, 
        showChar: showChar
    };
})();
var PS = PS || {};
PS.Data_String_Unsafe = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Char = PS.Data_Char;
    
    function charCodeAt(i) {
      return function(s) {
        return s.charCodeAt(i);
      };
    }
    ;
    
    function charAt(i) {
      return function(s) {
        return s.charAt(i);
      };
    }
    ;
    return {
        charCodeAt: charCodeAt, 
        charAt: charAt
    };
})();
var PS = PS || {};
PS.Control_Monad_Trans = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var MonadTrans = function (lift) {
        this.lift = lift;
    };
    var lift = function (dict) {
        return dict.lift;
    };
    return {
        MonadTrans: MonadTrans, 
        lift: lift
    };
})();
var PS = PS || {};
PS.Control_Monad_Error = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var $$Error = function (noMsg, strMsg) {
        this.noMsg = noMsg;
        this.strMsg = strMsg;
    };
    var strMsg = function (dict) {
        return dict.strMsg;
    };
    var noMsg = function (dict) {
        return dict.noMsg;
    };
    var errorString = new $$Error("", Prelude.id(Prelude.categoryArr));
    return {
        "Error": $$Error, 
        strMsg: strMsg, 
        noMsg: noMsg, 
        errorString: errorString
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    
    function returnE(a) {
      return function() {
        return a;
      };
    }
    ;
    
    function bindE(a) {
      return function(f) {
        return function() {
          return f(a())();
        };
      };
    }
    ;
    
    function runPure(f) {
      return f();
    }
    ;
    
    function untilE(f) {
      return function() {
        while (!f());
        return {};
      };
    }
    ;
    
    function whileE(f) {
      return function(a) {
        return function() {
          while (f()) {
            a();
          }
          return {};
        };
      };
    }
    ;
    
    function forE(lo) {
      return function(hi) {
        return function(f) {
          return function() {
            for (var i = lo; i < hi; i++) {
              f(i)();
            }
          };
        };
      };
    }
    ;
    
    function foreachE(as) {
      return function(f) {
        return function() {
          for (var i = 0; i < as.length; i++) {
            f(as[i])();
          }
        };
      };
    }
    ;
    var monadEff = new Prelude.Monad(function () {
        return applicativeEff;
    }, function () {
        return bindEff;
    });
    var bindEff = new Prelude.Bind(bindE, function () {
        return applyEff;
    });
    var applyEff = new Prelude.Apply(Prelude.ap(monadEff), function () {
        return functorEff;
    });
    var applicativeEff = new Prelude.Applicative(function () {
        return applyEff;
    }, returnE);
    var functorEff = new Prelude.Functor(Prelude.liftA1(applicativeEff));
    return {
        foreachE: foreachE, 
        forE: forE, 
        whileE: whileE, 
        untilE: untilE, 
        runPure: runPure, 
        bindE: bindE, 
        returnE: returnE, 
        functorEff: functorEff, 
        applyEff: applyEff, 
        applicativeEff: applicativeEff, 
        bindEff: bindEff, 
        monadEff: monadEff
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff_Unsafe = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    
    function unsafeInterleaveEff(f) {
      return f;
    }
    ;
    return {
        unsafeInterleaveEff: unsafeInterleaveEff
    };
})();
var PS = PS || {};
PS.Control_Monad_ST = (function () {
    "use strict";
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Prelude = PS.Prelude;
    
    function newSTRef(val) {
      return function() {
        return { value: val };
      };
    }
    ;
    
    function readSTRef(ref) {
      return function() {
        return ref.value;
      };
    }
    ;
    
    function modifySTRef(ref) {
      return function(f) {
        return function() {
          return ref.value = f(ref.value);
        };
      };
    }
    ;
    
    function writeSTRef(ref) {
      return function(a) {
        return function() {
          return ref.value = a;
        };
      };
    }
    ;
    
    function runST(f) {
      return f;
    }
    ;
    var pureST = function (st) {
        return Control_Monad_Eff.runPure(runST(st));
    };
    return {
        pureST: pureST, 
        runST: runST, 
        writeSTRef: writeSTRef, 
        modifySTRef: modifySTRef, 
        readSTRef: readSTRef, 
        newSTRef: newSTRef
    };
})();
var PS = PS || {};
PS.Debug_Trace = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    
    function trace(s) {
      return function() {
        console.log(s);
        return {};
      };
    }
    ;
    var print = function (__dict_Show_17) {
        return function (o) {
            return trace(Prelude.show(__dict_Show_17)(o));
        };
    };
    return {
        print: print, 
        trace: trace
    };
})();
var PS = PS || {};
PS.Control_Monad_Cont_Trans = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Trans = PS.Control_Monad_Trans;
    var ContT = function (x) {
        return x;
    };
    var runContT = function (_70) {
        return function (_71) {
            return _70(_71);
        };
    };
    var withContT = function (f) {
        return function (m) {
            return function (k) {
                return runContT(m)(f(k));
            };
        };
    };
    var monadTransContT = new Control_Monad_Trans.MonadTrans(function (__dict_Monad_18) {
        return function (m) {
            return function (k) {
                return Prelude[">>="](__dict_Monad_18["__superclass_Prelude.Bind_1"]())(m)(k);
            };
        };
    });
    var mapContT = function (f) {
        return function (m) {
            return function (k) {
                return f(runContT(m)(k));
            };
        };
    };
    var functorContT = function (__dict_Monad_20) {
        return new Prelude.Functor(function (f) {
            return function (m) {
                return function (k) {
                    return runContT(m)(function (a) {
                        return k(f(a));
                    });
                };
            };
        });
    };
    var callCC = function (f) {
        return function (k) {
            return runContT(f(function (a) {
                return function (_69) {
                    return k(a);
                };
            }))(k);
        };
    };
    var applyContT = function (__dict_Functor_22) {
        return function (__dict_Monad_23) {
            return new Prelude.Apply(function (f) {
                return function (v) {
                    return function (k) {
                        return runContT(f)(function (g) {
                            return runContT(v)(function (a) {
                                return k(g(a));
                            });
                        });
                    };
                };
            }, function () {
                return functorContT(__dict_Monad_23);
            });
        };
    };
    var bindContT = function (__dict_Monad_21) {
        return new Prelude.Bind(function (m) {
            return function (k) {
                return function (k$prime) {
                    return runContT(m)(function (a) {
                        return runContT(k(a))(k$prime);
                    });
                };
            };
        }, function () {
            return applyContT(((__dict_Monad_21["__superclass_Prelude.Applicative_0"]())["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(__dict_Monad_21);
        });
    };
    var applicativeContT = function (__dict_Functor_24) {
        return function (__dict_Monad_25) {
            return new Prelude.Applicative(function () {
                return applyContT(__dict_Functor_24)(__dict_Monad_25);
            }, function (a) {
                return function (k) {
                    return k(a);
                };
            });
        };
    };
    var monadContT = function (__dict_Monad_19) {
        return new Prelude.Monad(function () {
            return applicativeContT(((__dict_Monad_19["__superclass_Prelude.Applicative_0"]())["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(__dict_Monad_19);
        }, function () {
            return bindContT(__dict_Monad_19);
        });
    };
    return {
        ContT: ContT, 
        callCC: callCC, 
        withContT: withContT, 
        mapContT: mapContT, 
        runContT: runContT, 
        functorContT: functorContT, 
        applyContT: applyContT, 
        applicativeContT: applicativeContT, 
        bindContT: bindContT, 
        monadContT: monadContT, 
        monadTransContT: monadTransContT
    };
})();
var PS = PS || {};
PS.Control_Monad = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var when = function (__dict_Monad_26) {
        return function (_77) {
            return function (_78) {
                if (_77) {
                    return _78;
                };
                if (!_77) {
                    return Prelude["return"](__dict_Monad_26)(Prelude.unit);
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    var unless = function (__dict_Monad_27) {
        return function (_79) {
            return function (_80) {
                if (!_79) {
                    return _80;
                };
                if (_79) {
                    return Prelude["return"](__dict_Monad_27)(Prelude.unit);
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    var replicateM = function (__dict_Monad_28) {
        return function (_72) {
            return function (_73) {
                if (_72 === 0) {
                    return Prelude["return"](__dict_Monad_28)([  ]);
                };
                return Prelude[">>="](__dict_Monad_28["__superclass_Prelude.Bind_1"]())(_73)(function (_4) {
                    return Prelude[">>="](__dict_Monad_28["__superclass_Prelude.Bind_1"]())(replicateM(__dict_Monad_28)(_72 - 1)(_73))(function (_3) {
                        return Prelude["return"](__dict_Monad_28)(Prelude[":"](_4)(_3));
                    });
                });
            };
        };
    };
    var foldM = function (__dict_Monad_29) {
        return function (_74) {
            return function (_75) {
                return function (_76) {
                    if (_76.length === 0) {
                        return Prelude["return"](__dict_Monad_29)(_75);
                    };
                    if (_76.length >= 1) {
                        var _543 = _76.slice(1);
                        return Prelude[">>="](__dict_Monad_29["__superclass_Prelude.Bind_1"]())(_74(_75)(_76[0]))(function (a$prime) {
                            return foldM(__dict_Monad_29)(_74)(a$prime)(_543);
                        });
                    };
                    throw new Error("Failed pattern match");
                };
            };
        };
    };
    return {
        unless: unless, 
        when: when, 
        foldM: foldM, 
        replicateM: replicateM
    };
})();
var PS = PS || {};
PS.Control_Lazy = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Lazy = function (defer) {
        this.defer = defer;
    };
    var Lazy1 = function (defer1) {
        this.defer1 = defer1;
    };
    var Lazy2 = function (defer2) {
        this.defer2 = defer2;
    };
    var defer2 = function (dict) {
        return dict.defer2;
    };
    var fix2 = function (__dict_Lazy2_30) {
        return function (f) {
            return defer2(__dict_Lazy2_30)(function (_83) {
                return f(fix2(__dict_Lazy2_30)(f));
            });
        };
    };
    var defer1 = function (dict) {
        return dict.defer1;
    };
    var fix1 = function (__dict_Lazy1_31) {
        return function (f) {
            return defer1(__dict_Lazy1_31)(function (_82) {
                return f(fix1(__dict_Lazy1_31)(f));
            });
        };
    };
    var defer = function (dict) {
        return dict.defer;
    };
    var fix = function (__dict_Lazy_32) {
        return function (f) {
            return defer(__dict_Lazy_32)(function (_81) {
                return f(fix(__dict_Lazy_32)(f));
            });
        };
    };
    return {
        Lazy2: Lazy2, 
        Lazy1: Lazy1, 
        Lazy: Lazy, 
        fix2: fix2, 
        fix1: fix1, 
        fix: fix, 
        defer2: defer2, 
        defer1: defer1, 
        defer: defer
    };
})();
var PS = PS || {};
PS.Control_Functor = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var $less$dollar = function (__dict_Functor_33) {
        return function (x) {
            return function (f) {
                return Prelude["<$>"](__dict_Functor_33)(Prelude["const"](x))(f);
            };
        };
    };
    var $dollar$greater = function (__dict_Functor_34) {
        return function (f) {
            return function (x) {
                return Prelude["<$>"](__dict_Functor_34)(Prelude["const"](x))(f);
            };
        };
    };
    return {
        "$>": $dollar$greater, 
        "<$": $less$dollar
    };
})();
var PS = PS || {};
PS.Control_Extend = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Extend = function ($less$less$eq, __superclass_Prelude$dotFunctor_0) {
        this["<<="] = $less$less$eq;
        this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
    };
    var $less$less$eq = function (dict) {
        return dict["<<="];
    };
    var $eq$less$eq = function (__dict_Extend_35) {
        return function (f) {
            return function (g) {
                return function (w) {
                    return f($less$less$eq(__dict_Extend_35)(g)(w));
                };
            };
        };
    };
    var $eq$greater$eq = function (__dict_Extend_36) {
        return function (f) {
            return function (g) {
                return function (w) {
                    return g($less$less$eq(__dict_Extend_36)(f)(w));
                };
            };
        };
    };
    var $eq$greater$greater = function (__dict_Extend_37) {
        return function (w) {
            return function (f) {
                return $less$less$eq(__dict_Extend_37)(f)(w);
            };
        };
    };
    var extendArr = function (__dict_Semigroup_38) {
        return new Extend(function (f) {
            return function (g) {
                return function (w) {
                    return f(function (w$prime) {
                        return g(Prelude["<>"](__dict_Semigroup_38)(w)(w$prime));
                    });
                };
            };
        }, function () {
            return Prelude.functorArr;
        });
    };
    var duplicate = function (__dict_Extend_39) {
        return function (w) {
            return $less$less$eq(__dict_Extend_39)(Prelude.id(Prelude.categoryArr))(w);
        };
    };
    return {
        Extend: Extend, 
        duplicate: duplicate, 
        "=<=": $eq$less$eq, 
        "=>=": $eq$greater$eq, 
        "=>>": $eq$greater$greater, 
        "<<=": $less$less$eq, 
        extendArr: extendArr
    };
})();
var PS = PS || {};
PS.Control_Comonad = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Extend = PS.Control_Extend;
    var Comonad = function (__superclass_Control$dotExtend$dotExtend_0, extract) {
        this["__superclass_Control.Extend.Extend_0"] = __superclass_Control$dotExtend$dotExtend_0;
        this.extract = extract;
    };
    var extract = function (dict) {
        return dict.extract;
    };
    return {
        Comonad: Comonad, 
        extract: extract
    };
})();
var PS = PS || {};
PS.Control_Comonad_Trans = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Comonad = PS.Control_Comonad;
    var ComonadTrans = function (lower) {
        this.lower = lower;
    };
    var lower = function (dict) {
        return dict.lower;
    };
    return {
        ComonadTrans: ComonadTrans, 
        lower: lower
    };
})();
var PS = PS || {};
PS.Control_Bind = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var $greater$eq$greater = function (__dict_Bind_40) {
        return function (f) {
            return function (g) {
                return function (a) {
                    return Prelude[">>="](__dict_Bind_40)(f(a))(g);
                };
            };
        };
    };
    var $eq$less$less = function (__dict_Bind_41) {
        return function (f) {
            return function (m) {
                return Prelude[">>="](__dict_Bind_41)(m)(f);
            };
        };
    };
    var $less$eq$less = function (__dict_Bind_42) {
        return function (f) {
            return function (g) {
                return function (a) {
                    return $eq$less$less(__dict_Bind_42)(f)(g(a));
                };
            };
        };
    };
    var join = function (__dict_Bind_43) {
        return function (m) {
            return Prelude[">>="](__dict_Bind_43)(m)(Prelude.id(Prelude.categoryArr));
        };
    };
    var ifM = function (__dict_Bind_44) {
        return function (cond) {
            return function (t) {
                return function (f) {
                    return Prelude[">>="](__dict_Bind_44)(cond)(function (cond$prime) {
                        if (cond$prime) {
                            return t;
                        };
                        if (!cond$prime) {
                            return f;
                        };
                        throw new Error("Failed pattern match");
                    });
                };
            };
        };
    };
    return {
        ifM: ifM, 
        join: join, 
        "<=<": $less$eq$less, 
        ">=>": $greater$eq$greater, 
        "=<<": $eq$less$less
    };
})();
var PS = PS || {};
PS.Control_Apply = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var $less$times = function (__dict_Apply_45) {
        return function (a) {
            return function (b) {
                return Prelude["<*>"](__dict_Apply_45)(Prelude["<$>"](__dict_Apply_45["__superclass_Prelude.Functor_0"]())(Prelude["const"])(a))(b);
            };
        };
    };
    var $times$greater = function (__dict_Apply_46) {
        return function (a) {
            return function (b) {
                return Prelude["<*>"](__dict_Apply_46)(Prelude["<$>"](__dict_Apply_46["__superclass_Prelude.Functor_0"]())(Prelude["const"](Prelude.id(Prelude.categoryArr)))(a))(b);
            };
        };
    };
    var lift5 = function (__dict_Apply_47) {
        return function (f) {
            return function (a) {
                return function (b) {
                    return function (c) {
                        return function (d) {
                            return function (e) {
                                return Prelude["<*>"](__dict_Apply_47)(Prelude["<*>"](__dict_Apply_47)(Prelude["<*>"](__dict_Apply_47)(Prelude["<*>"](__dict_Apply_47)(Prelude["<$>"](__dict_Apply_47["__superclass_Prelude.Functor_0"]())(f)(a))(b))(c))(d))(e);
                            };
                        };
                    };
                };
            };
        };
    };
    var lift4 = function (__dict_Apply_48) {
        return function (f) {
            return function (a) {
                return function (b) {
                    return function (c) {
                        return function (d) {
                            return Prelude["<*>"](__dict_Apply_48)(Prelude["<*>"](__dict_Apply_48)(Prelude["<*>"](__dict_Apply_48)(Prelude["<$>"](__dict_Apply_48["__superclass_Prelude.Functor_0"]())(f)(a))(b))(c))(d);
                        };
                    };
                };
            };
        };
    };
    var lift3 = function (__dict_Apply_49) {
        return function (f) {
            return function (a) {
                return function (b) {
                    return function (c) {
                        return Prelude["<*>"](__dict_Apply_49)(Prelude["<*>"](__dict_Apply_49)(Prelude["<$>"](__dict_Apply_49["__superclass_Prelude.Functor_0"]())(f)(a))(b))(c);
                    };
                };
            };
        };
    };
    var lift2 = function (__dict_Apply_50) {
        return function (f) {
            return function (a) {
                return function (b) {
                    return Prelude["<*>"](__dict_Apply_50)(Prelude["<$>"](__dict_Apply_50["__superclass_Prelude.Functor_0"]())(f)(a))(b);
                };
            };
        };
    };
    var forever = function (__dict_Apply_51) {
        return function (a) {
            return $times$greater(__dict_Apply_51)(a)(forever(__dict_Apply_51)(a));
        };
    };
    return {
        forever: forever, 
        lift5: lift5, 
        lift4: lift4, 
        lift3: lift3, 
        lift2: lift2, 
        "*>": $times$greater, 
        "<*": $less$times
    };
})();
var PS = PS || {};
PS.Control_Alt = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Alt = function ($less$bar$greater, __superclass_Prelude$dotFunctor_0) {
        this["<|>"] = $less$bar$greater;
        this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
    };
    var $less$bar$greater = function (dict) {
        return dict["<|>"];
    };
    return {
        Alt: Alt, 
        "<|>": $less$bar$greater
    };
})();
var PS = PS || {};
PS.Control_Plus = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Alt = PS.Control_Alt;
    var Plus = function (__superclass_Control$dotAlt$dotAlt_0, empty) {
        this["__superclass_Control.Alt.Alt_0"] = __superclass_Control$dotAlt$dotAlt_0;
        this.empty = empty;
    };
    var empty = function (dict) {
        return dict.empty;
    };
    return {
        Plus: Plus, 
        empty: empty
    };
})();
var PS = PS || {};
PS.Control_Alternative = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Lazy = PS.Control_Lazy;
    var Control_Alt = PS.Control_Alt;
    var Control_Plus = PS.Control_Plus;
    var Alternative = function (__superclass_Control$dotPlus$dotPlus_1, __superclass_Prelude$dotApplicative_0) {
        this["__superclass_Control.Plus.Plus_1"] = __superclass_Control$dotPlus$dotPlus_1;
        this["__superclass_Prelude.Applicative_0"] = __superclass_Prelude$dotApplicative_0;
    };
    var some = function (__dict_Alternative_52) {
        return function (__dict_Lazy1_53) {
            return function (v) {
                return Prelude["<*>"]((__dict_Alternative_52["__superclass_Prelude.Applicative_0"]())["__superclass_Prelude.Apply_0"]())(Prelude["<$>"](((__dict_Alternative_52["__superclass_Control.Plus.Plus_1"]())["__superclass_Control.Alt.Alt_0"]())["__superclass_Prelude.Functor_0"]())(Prelude[":"])(v))(Control_Lazy.defer1(__dict_Lazy1_53)(function (_84) {
                    return many(__dict_Alternative_52)(__dict_Lazy1_53)(v);
                }));
            };
        };
    };
    var many = function (__dict_Alternative_54) {
        return function (__dict_Lazy1_55) {
            return function (v) {
                return Control_Alt["<|>"]((__dict_Alternative_54["__superclass_Control.Plus.Plus_1"]())["__superclass_Control.Alt.Alt_0"]())(some(__dict_Alternative_54)(__dict_Lazy1_55)(v))(Prelude.pure(__dict_Alternative_54["__superclass_Prelude.Applicative_0"]())([  ]));
            };
        };
    };
    return {
        Alternative: Alternative, 
        many: many, 
        some: some
    };
})();
var PS = PS || {};
PS.Control_MonadPlus = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Plus = PS.Control_Plus;
    var Control_Alternative = PS.Control_Alternative;
    var MonadPlus = function (__superclass_Control$dotAlternative$dotAlternative_1, __superclass_Prelude$dotMonad_0) {
        this["__superclass_Control.Alternative.Alternative_1"] = __superclass_Control$dotAlternative$dotAlternative_1;
        this["__superclass_Prelude.Monad_0"] = __superclass_Prelude$dotMonad_0;
    };
    var guard = function (__dict_MonadPlus_56) {
        return function (_85) {
            if (_85) {
                return Prelude["return"](__dict_MonadPlus_56["__superclass_Prelude.Monad_0"]())(Prelude.unit);
            };
            if (!_85) {
                return Control_Plus.empty((__dict_MonadPlus_56["__superclass_Control.Alternative.Alternative_1"]())["__superclass_Control.Plus.Plus_1"]());
            };
            throw new Error("Failed pattern match");
        };
    };
    return {
        MonadPlus: MonadPlus, 
        guard: guard
    };
})();
var PS = PS || {};
PS.Control_Monad_Reader_Trans = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Alt = PS.Control_Alt;
    var Control_Plus = PS.Control_Plus;
    var Control_Alternative = PS.Control_Alternative;
    var Control_Monad_Trans = PS.Control_Monad_Trans;
    var Control_MonadPlus = PS.Control_MonadPlus;
    var ReaderT = function (x) {
        return x;
    };
    var runReaderT = function (_86) {
        return _86;
    };
    var withReaderT = function (f) {
        return function (m) {
            return ReaderT(Prelude["<<<"](Prelude.semigroupoidArr)(runReaderT(m))(f));
        };
    };
    var mapReaderT = function (f) {
        return function (m) {
            return ReaderT(Prelude["<<<"](Prelude.semigroupoidArr)(f)(runReaderT(m)));
        };
    };
    var liftReaderT = function (m) {
        return Prelude["const"](m);
    };
    var monadTransReaderT = new Control_Monad_Trans.MonadTrans(function (__dict_Monad_59) {
        return liftReaderT;
    });
    var liftCatchReader = function ($$catch) {
        return function (m) {
            return function (h) {
                return ReaderT(function (r) {
                    return $$catch(runReaderT(m)(r))(function (e) {
                        return runReaderT(h(e))(r);
                    });
                });
            };
        };
    };
    var liftCallCCReader = function (callCC) {
        return function (f) {
            return ReaderT(function (r) {
                return callCC(function (c) {
                    return runReaderT(f(function (a) {
                        return ReaderT(Prelude["const"](c(a)));
                    }))(r);
                });
            });
        };
    };
    var functorReaderT = function (__dict_Functor_61) {
        return new Prelude.Functor(function (f) {
            return mapReaderT(Prelude["<$>"](__dict_Functor_61)(f));
        });
    };
    var applyReaderT = function (__dict_Applicative_63) {
        return new Prelude.Apply(function (f) {
            return function (v) {
                return function (r) {
                    return Prelude["<*>"](__dict_Applicative_63["__superclass_Prelude.Apply_0"]())(runReaderT(f)(r))(runReaderT(v)(r));
                };
            };
        }, function () {
            return functorReaderT((__dict_Applicative_63["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]());
        });
    };
    var bindReaderT = function (__dict_Monad_62) {
        return new Prelude.Bind(function (m) {
            return function (k) {
                return function (r) {
                    return Prelude[">>="](__dict_Monad_62["__superclass_Prelude.Bind_1"]())(runReaderT(m)(r))(function (_5) {
                        return runReaderT(k(_5))(r);
                    });
                };
            };
        }, function () {
            return applyReaderT(__dict_Monad_62["__superclass_Prelude.Applicative_0"]());
        });
    };
    var applicativeReaderT = function (__dict_Applicative_64) {
        return new Prelude.Applicative(function () {
            return applyReaderT(__dict_Applicative_64);
        }, Prelude["<<<"](Prelude.semigroupoidArr)(liftReaderT)(Prelude.pure(__dict_Applicative_64)));
    };
    var monadReaderT = function (__dict_Monad_57) {
        return new Prelude.Monad(function () {
            return applicativeReaderT(__dict_Monad_57["__superclass_Prelude.Applicative_0"]());
        }, function () {
            return bindReaderT(__dict_Monad_57);
        });
    };
    var altReaderT = function (__dict_Alt_66) {
        return new Control_Alt.Alt(function (m) {
            return function (n) {
                return function (r) {
                    return Control_Alt["<|>"](__dict_Alt_66)(runReaderT(m)(r))(runReaderT(n)(r));
                };
            };
        }, function () {
            return functorReaderT(__dict_Alt_66["__superclass_Prelude.Functor_0"]());
        });
    };
    var plusReaderT = function (__dict_Plus_60) {
        return new Control_Plus.Plus(function () {
            return altReaderT(__dict_Plus_60["__superclass_Control.Alt.Alt_0"]());
        }, liftReaderT(Control_Plus.empty(__dict_Plus_60)));
    };
    var alternativeReaderT = function (__dict_Alternative_65) {
        return new Control_Alternative.Alternative(function () {
            return plusReaderT(__dict_Alternative_65["__superclass_Control.Plus.Plus_1"]());
        }, function () {
            return applicativeReaderT(__dict_Alternative_65["__superclass_Prelude.Applicative_0"]());
        });
    };
    var monadPlusReaderT = function (__dict_MonadPlus_58) {
        return new Control_MonadPlus.MonadPlus(function () {
            return alternativeReaderT(__dict_MonadPlus_58["__superclass_Control.Alternative.Alternative_1"]());
        }, function () {
            return monadReaderT(__dict_MonadPlus_58["__superclass_Prelude.Monad_0"]());
        });
    };
    return {
        ReaderT: ReaderT, 
        liftCallCCReader: liftCallCCReader, 
        liftCatchReader: liftCatchReader, 
        liftReaderT: liftReaderT, 
        mapReaderT: mapReaderT, 
        withReaderT: withReaderT, 
        runReaderT: runReaderT, 
        functorReaderT: functorReaderT, 
        applyReaderT: applyReaderT, 
        applicativeReaderT: applicativeReaderT, 
        altReaderT: altReaderT, 
        plusReaderT: plusReaderT, 
        alternativeReaderT: alternativeReaderT, 
        bindReaderT: bindReaderT, 
        monadReaderT: monadReaderT, 
        monadPlusReaderT: monadPlusReaderT, 
        monadTransReaderT: monadTransReaderT
    };
})();
var PS = PS || {};
PS.Data_Either = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Alt = PS.Control_Alt;
    var Left = (function () {
        function Left(value0) {
            this.value0 = value0;
        };
        Left.create = function (value0) {
            return new Left(value0);
        };
        return Left;
    })();
    var Right = (function () {
        function Right(value0) {
            this.value0 = value0;
        };
        Right.create = function (value0) {
            return new Right(value0);
        };
        return Right;
    })();
    var showEither = function (__dict_Show_67) {
        return function (__dict_Show_68) {
            return new Prelude.Show(function (_97) {
                if (_97 instanceof Left) {
                    return "Left (" + (Prelude.show(__dict_Show_67)(_97.value0) + ")");
                };
                if (_97 instanceof Right) {
                    return "Right (" + (Prelude.show(__dict_Show_68)(_97.value0) + ")");
                };
                throw new Error("Failed pattern match");
            });
        };
    };
    var functorEither = new Prelude.Functor(function (_91) {
        return function (_92) {
            if (_92 instanceof Left) {
                return new Left(_92.value0);
            };
            if (_92 instanceof Right) {
                return new Right(_91(_92.value0));
            };
            throw new Error("Failed pattern match");
        };
    });
    var eqEither = function (__dict_Eq_71) {
        return function (__dict_Eq_72) {
            return new Prelude.Eq(function (a) {
                return function (b) {
                    return !Prelude["=="](eqEither(__dict_Eq_71)(__dict_Eq_72))(a)(b);
                };
            }, function (_98) {
                return function (_99) {
                    if (_98 instanceof Left && _99 instanceof Left) {
                        return Prelude["=="](__dict_Eq_71)(_98.value0)(_99.value0);
                    };
                    if (_98 instanceof Right && _99 instanceof Right) {
                        return Prelude["=="](__dict_Eq_72)(_98.value0)(_99.value0);
                    };
                    return false;
                };
            });
        };
    };
    var ordEither = function (__dict_Ord_69) {
        return function (__dict_Ord_70) {
            return new Prelude.Ord(function () {
                return eqEither(__dict_Ord_69["__superclass_Prelude.Eq_0"]())(__dict_Ord_70["__superclass_Prelude.Eq_0"]());
            }, function (_100) {
                return function (_101) {
                    if (_100 instanceof Left && _101 instanceof Left) {
                        return Prelude.compare(__dict_Ord_69)(_100.value0)(_101.value0);
                    };
                    if (_100 instanceof Right && _101 instanceof Right) {
                        return Prelude.compare(__dict_Ord_70)(_100.value0)(_101.value0);
                    };
                    if (_100 instanceof Left) {
                        return Prelude.LT.value;
                    };
                    if (_101 instanceof Left) {
                        return Prelude.GT.value;
                    };
                    throw new Error("Failed pattern match");
                };
            });
        };
    };
    var either = function (_88) {
        return function (_89) {
            return function (_90) {
                if (_90 instanceof Left) {
                    return _88(_90.value0);
                };
                if (_90 instanceof Right) {
                    return _89(_90.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    var isLeft = either(Prelude["const"](true))(Prelude["const"](false));
    var isRight = either(Prelude["const"](false))(Prelude["const"](true));
    var applyEither = new Prelude.Apply(function (_93) {
        return function (_94) {
            if (_93 instanceof Left) {
                return new Left(_93.value0);
            };
            if (_93 instanceof Right) {
                return Prelude["<$>"](functorEither)(_93.value0)(_94);
            };
            throw new Error("Failed pattern match");
        };
    }, function () {
        return functorEither;
    });
    var bindEither = new Prelude.Bind(either(function (e) {
        return function (_87) {
            return new Left(e);
        };
    })(function (a) {
        return function (f) {
            return f(a);
        };
    }), function () {
        return applyEither;
    });
    var applicativeEither = new Prelude.Applicative(function () {
        return applyEither;
    }, Right.create);
    var monadEither = new Prelude.Monad(function () {
        return applicativeEither;
    }, function () {
        return bindEither;
    });
    var altEither = new Control_Alt.Alt(function (_95) {
        return function (_96) {
            if (_95 instanceof Left) {
                return _96;
            };
            return _95;
        };
    }, function () {
        return functorEither;
    });
    return {
        Left: Left, 
        Right: Right, 
        isRight: isRight, 
        isLeft: isLeft, 
        either: either, 
        functorEither: functorEither, 
        applyEither: applyEither, 
        applicativeEither: applicativeEither, 
        altEither: altEither, 
        bindEither: bindEither, 
        monadEither: monadEither, 
        showEither: showEither, 
        eqEither: eqEither, 
        ordEither: ordEither
    };
})();
var PS = PS || {};
PS.Data_Either_Nested = (function () {
    "use strict";
    var Data_Either = PS.Data_Either;
    var Prelude = PS.Prelude;
    var choice2 = Data_Either.either;
    var choice3 = function (a) {
        return function (b) {
            return function (c) {
                return Data_Either.either(a)(choice2(b)(c));
            };
        };
    };
    var choice4 = function (a) {
        return function (b) {
            return function (c) {
                return function (d) {
                    return Data_Either.either(a)(choice3(b)(c)(d));
                };
            };
        };
    };
    var choice5 = function (a) {
        return function (b) {
            return function (c) {
                return function (d) {
                    return function (e) {
                        return Data_Either.either(a)(choice4(b)(c)(d)(e));
                    };
                };
            };
        };
    };
    var choice6 = function (a) {
        return function (b) {
            return function (c) {
                return function (d) {
                    return function (e) {
                        return function (f) {
                            return Data_Either.either(a)(choice5(b)(c)(d)(e)(f));
                        };
                    };
                };
            };
        };
    };
    var choice7 = function (a) {
        return function (b) {
            return function (c) {
                return function (d) {
                    return function (e) {
                        return function (f) {
                            return function (g) {
                                return Data_Either.either(a)(choice6(b)(c)(d)(e)(f)(g));
                            };
                        };
                    };
                };
            };
        };
    };
    var choice8 = function (a) {
        return function (b) {
            return function (c) {
                return function (d) {
                    return function (e) {
                        return function (f) {
                            return function (g) {
                                return function (h) {
                                    return Data_Either.either(a)(choice7(b)(c)(d)(e)(f)(g)(h));
                                };
                            };
                        };
                    };
                };
            };
        };
    };
    var choice9 = function (a) {
        return function (b) {
            return function (c) {
                return function (d) {
                    return function (e) {
                        return function (f) {
                            return function (g) {
                                return function (h) {
                                    return function (i) {
                                        return Data_Either.either(a)(choice8(b)(c)(d)(e)(f)(g)(h)(i));
                                    };
                                };
                            };
                        };
                    };
                };
            };
        };
    };
    var choice10 = function (a) {
        return function (b) {
            return function (c) {
                return function (d) {
                    return function (e) {
                        return function (f) {
                            return function (g) {
                                return function (h) {
                                    return function (i) {
                                        return function (j) {
                                            return Data_Either.either(a)(choice9(b)(c)(d)(e)(f)(g)(h)(i)(j));
                                        };
                                    };
                                };
                            };
                        };
                    };
                };
            };
        };
    };
    return {
        choice10: choice10, 
        choice9: choice9, 
        choice8: choice8, 
        choice7: choice7, 
        choice6: choice6, 
        choice5: choice5, 
        choice4: choice4, 
        choice3: choice3, 
        choice2: choice2
    };
})();
var PS = PS || {};
PS.Data_Maybe = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Alt = PS.Control_Alt;
    var Control_Alternative = PS.Control_Alternative;
    var Control_Extend = PS.Control_Extend;
    var Control_MonadPlus = PS.Control_MonadPlus;
    var Control_Plus = PS.Control_Plus;
    var Nothing = (function () {
        function Nothing() {

        };
        Nothing.value = new Nothing();
        return Nothing;
    })();
    var Just = (function () {
        function Just(value0) {
            this.value0 = value0;
        };
        Just.create = function (value0) {
            return new Just(value0);
        };
        return Just;
    })();
    var showMaybe = function (__dict_Show_73) {
        return new Prelude.Show(function (_117) {
            if (_117 instanceof Just) {
                return "Just (" + (Prelude.show(__dict_Show_73)(_117.value0) + ")");
            };
            if (_117 instanceof Nothing) {
                return "Nothing";
            };
            throw new Error("Failed pattern match");
        });
    };
    var semigroupMaybe = function (__dict_Semigroup_74) {
        return new Prelude.Semigroup(function (_115) {
            return function (_116) {
                if (_115 instanceof Nothing) {
                    return _116;
                };
                if (_116 instanceof Nothing) {
                    return _115;
                };
                if (_115 instanceof Just && _116 instanceof Just) {
                    return new Just(Prelude["<>"](__dict_Semigroup_74)(_115.value0)(_116.value0));
                };
                throw new Error("Failed pattern match");
            };
        });
    };
    var maybe = function (_102) {
        return function (_103) {
            return function (_104) {
                if (_104 instanceof Nothing) {
                    return _102;
                };
                if (_104 instanceof Just) {
                    return _103(_104.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    var isNothing = maybe(true)(Prelude["const"](false));
    var isJust = maybe(false)(Prelude["const"](true));
    var functorMaybe = new Prelude.Functor(function (_105) {
        return function (_106) {
            if (_106 instanceof Just) {
                return new Just(_105(_106.value0));
            };
            return Nothing.value;
        };
    });
    var fromMaybe = function (a) {
        return maybe(a)(Prelude.id(Prelude.categoryArr));
    };
    var extendMaybe = new Control_Extend.Extend(function (_113) {
        return function (_114) {
            if (_114 instanceof Nothing) {
                return Nothing.value;
            };
            return Just.create(_113(_114));
        };
    }, function () {
        return functorMaybe;
    });
    var eqMaybe = function (__dict_Eq_76) {
        return new Prelude.Eq(function (a) {
            return function (b) {
                return !Prelude["=="](eqMaybe(__dict_Eq_76))(a)(b);
            };
        }, function (_118) {
            return function (_119) {
                if (_118 instanceof Nothing && _119 instanceof Nothing) {
                    return true;
                };
                if (_118 instanceof Just && _119 instanceof Just) {
                    return Prelude["=="](__dict_Eq_76)(_118.value0)(_119.value0);
                };
                return false;
            };
        });
    };
    var ordMaybe = function (__dict_Ord_75) {
        return new Prelude.Ord(function () {
            return eqMaybe(__dict_Ord_75["__superclass_Prelude.Eq_0"]());
        }, function (_120) {
            return function (_121) {
                if (_120 instanceof Just && _121 instanceof Just) {
                    return Prelude.compare(__dict_Ord_75)(_120.value0)(_121.value0);
                };
                if (_120 instanceof Nothing && _121 instanceof Nothing) {
                    return Prelude.EQ.value;
                };
                if (_120 instanceof Nothing) {
                    return Prelude.LT.value;
                };
                if (_121 instanceof Nothing) {
                    return Prelude.GT.value;
                };
                throw new Error("Failed pattern match");
            };
        });
    };
    var applyMaybe = new Prelude.Apply(function (_107) {
        return function (_108) {
            if (_107 instanceof Just) {
                return Prelude["<$>"](functorMaybe)(_107.value0)(_108);
            };
            if (_107 instanceof Nothing) {
                return Nothing.value;
            };
            throw new Error("Failed pattern match");
        };
    }, function () {
        return functorMaybe;
    });
    var bindMaybe = new Prelude.Bind(function (_111) {
        return function (_112) {
            if (_111 instanceof Just) {
                return _112(_111.value0);
            };
            if (_111 instanceof Nothing) {
                return Nothing.value;
            };
            throw new Error("Failed pattern match");
        };
    }, function () {
        return applyMaybe;
    });
    var applicativeMaybe = new Prelude.Applicative(function () {
        return applyMaybe;
    }, Just.create);
    var monadMaybe = new Prelude.Monad(function () {
        return applicativeMaybe;
    }, function () {
        return bindMaybe;
    });
    var altMaybe = new Control_Alt.Alt(function (_109) {
        return function (_110) {
            if (_109 instanceof Nothing) {
                return _110;
            };
            return _109;
        };
    }, function () {
        return functorMaybe;
    });
    var plusMaybe = new Control_Plus.Plus(function () {
        return altMaybe;
    }, Nothing.value);
    var alternativeMaybe = new Control_Alternative.Alternative(function () {
        return plusMaybe;
    }, function () {
        return applicativeMaybe;
    });
    var monadPlusMaybe = new Control_MonadPlus.MonadPlus(function () {
        return alternativeMaybe;
    }, function () {
        return monadMaybe;
    });
    return {
        Nothing: Nothing, 
        Just: Just, 
        isNothing: isNothing, 
        isJust: isJust, 
        fromMaybe: fromMaybe, 
        maybe: maybe, 
        functorMaybe: functorMaybe, 
        applyMaybe: applyMaybe, 
        applicativeMaybe: applicativeMaybe, 
        altMaybe: altMaybe, 
        plusMaybe: plusMaybe, 
        alternativeMaybe: alternativeMaybe, 
        bindMaybe: bindMaybe, 
        monadMaybe: monadMaybe, 
        monadPlusMaybe: monadPlusMaybe, 
        extendMaybe: extendMaybe, 
        semigroupMaybe: semigroupMaybe, 
        showMaybe: showMaybe, 
        eqMaybe: eqMaybe, 
        ordMaybe: ordMaybe
    };
})();
var PS = PS || {};
PS.Data_Array = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Maybe = PS.Data_Maybe;
    var Control_Alt = PS.Control_Alt;
    var Control_Plus = PS.Control_Plus;
    var Control_Alternative = PS.Control_Alternative;
    var Control_MonadPlus = PS.Control_MonadPlus;
    var Prelude_Unsafe = PS.Prelude_Unsafe;
    function snoc(l) {  return function (e) {    var l1 = l.slice();    l1.push(e);     return l1;  };};
    function length (xs) {  return xs.length;};
    function findIndex (f) {  return function (arr) {    for (var i = 0, l = arr.length; i < l; i++) {      if (f(arr[i])) {        return i;      }    }    return -1;  };};
    function findLastIndex (f) {  return function (arr) {    for (var i = arr.length - 1; i >= 0; i--) {      if (f(arr[i])) {        return i;      }    }    return -1;  };};
    function append (l1) {  return function (l2) {    return l1.concat(l2);  };};
    function concat (xss) {  var result = [];  for (var i = 0, l = xss.length; i < l; i++) {    result.push.apply(result, xss[i]);  }  return result;};
    function reverse (l) {  return l.slice().reverse();};
    function drop (n) {  return function (l) {    return l.slice(n);  };};
    function slice (s) {  return function (e) {    return function (l) {      return l.slice(s, e);    };  };};
    function insertAt (index) {  return function (a) {    return function (l) {      var l1 = l.slice();      l1.splice(index, 0, a);      return l1;    };   };};
    function deleteAt (index) {  return function (n) {    return function (l) {      var l1 = l.slice();      l1.splice(index, n);      return l1;    };   };};
    function updateAt (index) {  return function (a) {    return function (l) {      var i = ~~index;      if (i < 0 || i >= l.length) return l;      var l1 = l.slice();      l1[i] = a;      return l1;    };   };};
    function concatMap (f) {  return function (arr) {    var result = [];    for (var i = 0, l = arr.length; i < l; i++) {      Array.prototype.push.apply(result, f(arr[i]));    }    return result;  };};
    function map (f) {  return function (arr) {    var l = arr.length;    var result = new Array(l);    for (var i = 0; i < l; i++) {      result[i] = f(arr[i]);    }    return result;  };};
    function filter (f) {  return function (arr) {    var n = 0;    var result = [];    for (var i = 0, l = arr.length; i < l; i++) {      if (f(arr[i])) {        result[n++] = arr[i];      }    }    return result;  };};
    function range (start) {  return function (end) {    var i = ~~start, e = ~~end;    var step = i > e ? -1 : 1;    var result = [i], n = 1;    while (i !== e) {      i += step;      result[n++] = i;    }    return result;  };};
    function zipWith (f) {  return function (xs) {    return function (ys) {      var l = xs.length < ys.length ? xs.length : ys.length;      var result = new Array(l);      for (var i = 0; i < l; i++) {        result[i] = f(xs[i])(ys[i]);      }      return result;    };  };};
    function sortJS (f) {  return function (l) {    return l.slice().sort(function (x, y) {      return f(x)(y);    });  };};
    var $dot$dot = range;
    var $bang$bang = function (xs) {
        return function (n) {
            var isInt = function (n_1) {
                return n_1 !== ~~n_1;
            };
            var _617 = n < 0 || (n >= length(xs) || isInt(n));
            if (_617) {
                return Data_Maybe.Nothing.value;
            };
            if (!_617) {
                return new Data_Maybe.Just(xs[n]);
            };
            throw new Error("Failed pattern match");
        };
    };
    var take = function (n) {
        return slice(0)(n);
    };
    var tail = function (_124) {
        if (_124.length >= 1) {
            var _620 = _124.slice(1);
            return new Data_Maybe.Just(_620);
        };
        return Data_Maybe.Nothing.value;
    };
    var span = (function () {
        var go = function (__copy__140) {
            return function (__copy__141) {
                return function (__copy__142) {
                    var _140 = __copy__140;
                    var _141 = __copy__141;
                    var _142 = __copy__142;
                    tco: while (true) {
                        if (_142.length >= 1) {
                            var _625 = _142.slice(1);
                            if (_141(_142[0])) {
                                var __tco__140 = Prelude[":"](_142[0])(_140);
                                var __tco__141 = _141;
                                _140 = __tco__140;
                                _141 = __tco__141;
                                _142 = _625;
                                continue tco;
                            };
                        };
                        return {
                            init: reverse(_140), 
                            rest: _142
                        };
                    };
                };
            };
        };
        return go([  ]);
    })();
    var takeWhile = function (p) {
        return function (xs) {
            return (span(p)(xs)).init;
        };
    };
    var sortBy = function (comp) {
        return function (xs) {
            var comp$prime = function (x) {
                return function (y) {
                    var _626 = comp(x)(y);
                    if (_626 instanceof Prelude.GT) {
                        return 1;
                    };
                    if (_626 instanceof Prelude.EQ) {
                        return 0;
                    };
                    if (_626 instanceof Prelude.LT) {
                        return -1;
                    };
                    throw new Error("Failed pattern match");
                };
            };
            return sortJS(comp$prime)(xs);
        };
    };
    var sort = function (__dict_Ord_77) {
        return function (xs) {
            return sortBy(Prelude.compare(__dict_Ord_77))(xs);
        };
    };
    var singleton = function (a) {
        return [ a ];
    };
    var semigroupArray = new Prelude.Semigroup(append);
    var $$null = function (_126) {
        if (_126.length === 0) {
            return true;
        };
        return false;
    };
    var nubBy = function (_133) {
        return function (_134) {
            if (_134.length === 0) {
                return [  ];
            };
            if (_134.length >= 1) {
                var _631 = _134.slice(1);
                return Prelude[":"](_134[0])(nubBy(_133)(filter(function (y) {
                    return !_133(_134[0])(y);
                })(_631)));
            };
            throw new Error("Failed pattern match");
        };
    };
    var nub = function (__dict_Eq_78) {
        return nubBy(Prelude["=="](__dict_Eq_78));
    };
    var mapMaybe = function (f) {
        return concatMap(Prelude["<<<"](Prelude.semigroupoidArr)(Data_Maybe.maybe([  ])(singleton))(f));
    };
    var last = function (__copy__123) {
        var _123 = __copy__123;
        tco: while (true) {
            if (_123.length >= 1) {
                var _634 = _123.slice(1);
                if (_634.length === 0) {
                    return new Data_Maybe.Just(_123[0]);
                };
            };
            if (_123.length >= 1) {
                var _636 = _123.slice(1);
                _123 = _636;
                continue tco;
            };
            return Data_Maybe.Nothing.value;
        };
    };
    var intersectBy = function (_130) {
        return function (_131) {
            return function (_132) {
                if (_131.length === 0) {
                    return [  ];
                };
                if (_132.length === 0) {
                    return [  ];
                };
                var el = function (x) {
                    return findIndex(_130(x))(_132) >= 0;
                };
                return filter(el)(_131);
            };
        };
    };
    var intersect = function (__dict_Eq_79) {
        return intersectBy(Prelude["=="](__dict_Eq_79));
    };
    var init = function (_125) {
        if (_125.length === 0) {
            return Data_Maybe.Nothing.value;
        };
        return new Data_Maybe.Just(slice(0)(length(_125) - 1)(_125));
    };
    var head = function (_122) {
        if (_122.length >= 1) {
            var _643 = _122.slice(1);
            return new Data_Maybe.Just(_122[0]);
        };
        return Data_Maybe.Nothing.value;
    };
    var groupBy = (function () {
        var go = function (__copy__137) {
            return function (__copy__138) {
                return function (__copy__139) {
                    var _137 = __copy__137;
                    var _138 = __copy__138;
                    var _139 = __copy__139;
                    tco: while (true) {
                        if (_139.length === 0) {
                            return reverse(_137);
                        };
                        if (_139.length >= 1) {
                            var _648 = _139.slice(1);
                            var sp = span(_138(_139[0]))(_648);
                            var __tco__137 = Prelude[":"](Prelude[":"](_139[0])(sp.init))(_137);
                            var __tco__138 = _138;
                            _137 = __tco__137;
                            _138 = __tco__138;
                            _139 = sp.rest;
                            continue tco;
                        };
                        throw new Error("Failed pattern match");
                    };
                };
            };
        };
        return go([  ]);
    })();
    var group = function (__dict_Eq_80) {
        return function (xs) {
            return groupBy(Prelude["=="](__dict_Eq_80))(xs);
        };
    };
    
    /**
     *  | Performs a sorting first.
     */
    var group$prime = function (__dict_Ord_81) {
        return Prelude["<<<"](Prelude.semigroupoidArr)(group(__dict_Ord_81["__superclass_Prelude.Eq_0"]()))(sort(__dict_Ord_81));
    };
    var functorArray = new Prelude.Functor(map);
    var elemLastIndex = function (__dict_Eq_82) {
        return function (x) {
            return findLastIndex(Prelude["=="](__dict_Eq_82)(x));
        };
    };
    var elemIndex = function (__dict_Eq_83) {
        return function (x) {
            return findIndex(Prelude["=="](__dict_Eq_83)(x));
        };
    };
    var dropWhile = function (p) {
        return function (xs) {
            return (span(p)(xs)).rest;
        };
    };
    var deleteBy = function (_127) {
        return function (_128) {
            return function (_129) {
                if (_129.length === 0) {
                    return [  ];
                };
                var _652 = findIndex(_127(_128))(_129);
                if (_652 < 0) {
                    return _129;
                };
                return deleteAt(_652)(1)(_129);
            };
        };
    };
    var $$delete = function (__dict_Eq_84) {
        return deleteBy(Prelude["=="](__dict_Eq_84));
    };
    var $bslash$bslash = function (__dict_Eq_85) {
        return function (xs) {
            return function (ys) {
                var go = function (__copy__135) {
                    return function (__copy__136) {
                        var _135 = __copy__135;
                        var _136 = __copy__136;
                        tco: while (true) {
                            if (_136.length === 0) {
                                return _135;
                            };
                            if (_135.length === 0) {
                                return [  ];
                            };
                            if (_136.length >= 1) {
                                var _656 = _136.slice(1);
                                var __tco__135 = $$delete(__dict_Eq_85)(_136[0])(_135);
                                _135 = __tco__135;
                                _136 = _656;
                                continue tco;
                            };
                            throw new Error("Failed pattern match");
                        };
                    };
                };
                return go(xs)(ys);
            };
        };
    };
    var catMaybes = concatMap(Data_Maybe.maybe([  ])(singleton));
    var monadArray = new Prelude.Monad(function () {
        return applicativeArray;
    }, function () {
        return bindArray;
    });
    var bindArray = new Prelude.Bind(Prelude.flip(concatMap), function () {
        return applyArray;
    });
    var applyArray = new Prelude.Apply(Prelude.ap(monadArray), function () {
        return functorArray;
    });
    var applicativeArray = new Prelude.Applicative(function () {
        return applyArray;
    }, singleton);
    var altArray = new Control_Alt.Alt(append, function () {
        return functorArray;
    });
    var plusArray = new Control_Plus.Plus(function () {
        return altArray;
    }, [  ]);
    var alternativeArray = new Control_Alternative.Alternative(function () {
        return plusArray;
    }, function () {
        return applicativeArray;
    });
    var monadPlusArray = new Control_MonadPlus.MonadPlus(function () {
        return alternativeArray;
    }, function () {
        return monadArray;
    });
    return {
        takeWhile: takeWhile, 
        dropWhile: dropWhile, 
        span: span, 
        groupBy: groupBy, 
        "group'": group$prime, 
        group: group, 
        sortBy: sortBy, 
        sort: sort, 
        nubBy: nubBy, 
        nub: nub, 
        zipWith: zipWith, 
        range: range, 
        filter: filter, 
        concatMap: concatMap, 
        intersect: intersect, 
        intersectBy: intersectBy, 
        "\\\\": $bslash$bslash, 
        "delete": $$delete, 
        deleteBy: deleteBy, 
        updateAt: updateAt, 
        deleteAt: deleteAt, 
        insertAt: insertAt, 
        take: take, 
        drop: drop, 
        reverse: reverse, 
        concat: concat, 
        append: append, 
        elemLastIndex: elemLastIndex, 
        elemIndex: elemIndex, 
        findLastIndex: findLastIndex, 
        findIndex: findIndex, 
        length: length, 
        catMaybes: catMaybes, 
        mapMaybe: mapMaybe, 
        map: map, 
        "null": $$null, 
        init: init, 
        tail: tail, 
        last: last, 
        head: head, 
        singleton: singleton, 
        snoc: snoc, 
        "..": $dot$dot, 
        "!!": $bang$bang, 
        functorArray: functorArray, 
        applyArray: applyArray, 
        applicativeArray: applicativeArray, 
        bindArray: bindArray, 
        monadArray: monadArray, 
        semigroupArray: semigroupArray, 
        altArray: altArray, 
        plusArray: plusArray, 
        alternativeArray: alternativeArray, 
        monadPlusArray: monadPlusArray
    };
})();
var PS = PS || {};
PS.Data_Array_ST = (function () {
    "use strict";
    var Data_Function = PS.Data_Function;
    var Prelude = PS.Prelude;
    var Data_Maybe = PS.Data_Maybe;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Control_Monad_ST = PS.Control_Monad_ST;
    
  function runSTArray(f) {
    return f;
  };
    
  function emptySTArray() {
    return [];
  };
    
  function peekSTArrayImpl(arr, i, s, f) {
    return function() {
      var index = ~~i;
      if (0 <= index && index < arr.length) {
        return s(arr[index]);
      } else {
        return f;
      }
    };
  };
    
  function pokeSTArrayImpl(arr, i, a) {
    return function() {
      var index = ~~i;
      if (0 <= index && index <= arr.length) {
        arr[index] = a;
        return true;
      }
      return false;
    };
  };
    
  function pushAllSTArrayImpl(arr, as) {
    return function(){
      return arr.push.apply(arr, as);
    };
  };
    
  function spliceSTArrayImpl(arr, index, howMany, bs) {
    return function(){
      return arr.splice.apply(arr, [index, howMany].concat(bs));
    };
  };
    
  function copyImpl(arr) {
    return function(){
      var as = [];
      var i = -1;
      var n = arr.length;
      while(++i < n) {
        as[i] = arr[i];
      }
      return as;
    };
  };
    
  function toAssocArray(arr) {
    return function(){
      var as = [];
      var i = -1;
      var n = arr.length;
      while(++i < n) {
        as[i] = {value: arr[i], index: i};
      }
      return as;
    };
  };
    var thaw = copyImpl;
    var spliceSTArray = Data_Function.runFn4(spliceSTArrayImpl);
    var pushAllSTArray = Data_Function.runFn2(pushAllSTArrayImpl);
    var pushSTArray = function (arr) {
        return function (a) {
            return pushAllSTArray(arr)([ a ]);
        };
    };
    var pokeSTArray = function (arr) {
        return function (i) {
            return function (a) {
                return pokeSTArrayImpl(arr, i, a);
            };
        };
    };
    var peekSTArray = function (arr) {
        return function (i) {
            return peekSTArrayImpl(arr, i, Data_Maybe.Just.create, Data_Maybe.Nothing.value);
        };
    };
    var freeze = copyImpl;
    return {
        toAssocArray: toAssocArray, 
        thaw: thaw, 
        freeze: freeze, 
        spliceSTArray: spliceSTArray, 
        pushAllSTArray: pushAllSTArray, 
        pushSTArray: pushSTArray, 
        pokeSTArray: pokeSTArray, 
        peekSTArray: peekSTArray, 
        emptySTArray: emptySTArray, 
        runSTArray: runSTArray
    };
})();
var PS = PS || {};
PS.Data_Maybe_Unsafe = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Maybe = PS.Data_Maybe;
    var fromJust = function (_143) {
        if (_143 instanceof Data_Maybe.Just) {
            return _143.value0;
        };
        throw new Error("Failed pattern match");
    };
    return {
        fromJust: fromJust
    };
})();
var PS = PS || {};
PS.Data_Array_Unsafe = (function () {
    "use strict";
    var Prelude_Unsafe = PS.Prelude_Unsafe;
    var Prelude = PS.Prelude;
    var Data_Array = PS.Data_Array;
    var Data_Maybe_Unsafe = PS.Data_Maybe_Unsafe;
    var tail = function (_145) {
        if (_145.length >= 1) {
            var _661 = _145.slice(1);
            return _661;
        };
        throw new Error("Failed pattern match");
    };
    var last = function (xs) {
        return xs[Data_Array.length(xs) - 1];
    };
    var init = Prelude["<<<"](Prelude.semigroupoidArr)(Data_Maybe_Unsafe.fromJust)(Data_Array.init);
    var head = function (_144) {
        if (_144.length >= 1) {
            var _664 = _144.slice(1);
            return _144[0];
        };
        throw new Error("Failed pattern match");
    };
    return {
        init: init, 
        last: last, 
        tail: tail, 
        head: head
    };
})();
var PS = PS || {};
PS.Data_Monoid = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Array = PS.Data_Array;
    var Data_Maybe = PS.Data_Maybe;
    var Monoid = function (__superclass_Prelude$dotSemigroup_0, mempty) {
        this["__superclass_Prelude.Semigroup_0"] = __superclass_Prelude$dotSemigroup_0;
        this.mempty = mempty;
    };
    var monoidUnit = new Monoid(function () {
        return Prelude.semigroupUnit;
    }, Prelude.unit);
    var monoidString = new Monoid(function () {
        return Prelude.semigroupString;
    }, "");
    var monoidMaybe = function (__dict_Semigroup_86) {
        return new Monoid(function () {
            return Data_Maybe.semigroupMaybe(__dict_Semigroup_86);
        }, Data_Maybe.Nothing.value);
    };
    var monoidArray = new Monoid(function () {
        return Data_Array.semigroupArray;
    }, [  ]);
    var mempty = function (dict) {
        return dict.mempty;
    };
    var monoidArr = function (__dict_Monoid_87) {
        return new Monoid(function () {
            return Prelude.semigroupArr(__dict_Monoid_87["__superclass_Prelude.Semigroup_0"]());
        }, Prelude["const"](mempty(__dict_Monoid_87)));
    };
    return {
        Monoid: Monoid, 
        mempty: mempty, 
        monoidString: monoidString, 
        monoidArray: monoidArray, 
        monoidUnit: monoidUnit, 
        monoidArr: monoidArr, 
        monoidMaybe: monoidMaybe
    };
})();
var PS = PS || {};
PS.Data_Monoid_Additive = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Comonad = PS.Control_Comonad;
    var Control_Extend = PS.Control_Extend;
    var Data_Monoid = PS.Data_Monoid;
    
    /**
     *  | Monoid and semigroup for semirings under addition.
     *  |
     *  | ``` purescript
     *  | Additive x <> Additive y == Additive (x + y)
     *  | mempty :: Additive _ == Additive zero
     *  | ```
     */
    var Additive = function (x) {
        return x;
    };
    var showAdditive = function (__dict_Show_88) {
        return new Prelude.Show(function (_159) {
            return "Additive (" + (Prelude.show(__dict_Show_88)(_159) + ")");
        });
    };
    var semigroupAdditive = function (__dict_Semiring_89) {
        return new Prelude.Semigroup(function (_160) {
            return function (_161) {
                return Prelude["+"](__dict_Semiring_89)(_160)(_161);
            };
        });
    };
    var runAdditive = function (_146) {
        return _146;
    };
    var monoidAdditive = function (__dict_Semiring_91) {
        return new Data_Monoid.Monoid(function () {
            return semigroupAdditive(__dict_Semiring_91);
        }, Prelude.zero(__dict_Semiring_91));
    };
    var functorAdditive = new Prelude.Functor(function (_153) {
        return function (_154) {
            return _153(_154);
        };
    });
    var extendAdditive = new Control_Extend.Extend(function (f) {
        return function (x) {
            return f(x);
        };
    }, function () {
        return functorAdditive;
    });
    var eqAdditive = function (__dict_Eq_92) {
        return new Prelude.Eq(function (_149) {
            return function (_150) {
                return Prelude["/="](__dict_Eq_92)(_149)(_150);
            };
        }, function (_147) {
            return function (_148) {
                return Prelude["=="](__dict_Eq_92)(_147)(_148);
            };
        });
    };
    var ordAdditive = function (__dict_Ord_90) {
        return new Prelude.Ord(function () {
            return eqAdditive(__dict_Ord_90["__superclass_Prelude.Eq_0"]());
        }, function (_151) {
            return function (_152) {
                return Prelude.compare(__dict_Ord_90)(_151)(_152);
            };
        });
    };
    var comonadAdditive = new Control_Comonad.Comonad(function () {
        return extendAdditive;
    }, runAdditive);
    var applyAdditive = new Prelude.Apply(function (_155) {
        return function (_156) {
            return _155(_156);
        };
    }, function () {
        return functorAdditive;
    });
    var bindAdditive = new Prelude.Bind(function (_157) {
        return function (_158) {
            return _158(_157);
        };
    }, function () {
        return applyAdditive;
    });
    var applicativeAdditive = new Prelude.Applicative(function () {
        return applyAdditive;
    }, Additive);
    var monadAdditive = new Prelude.Monad(function () {
        return applicativeAdditive;
    }, function () {
        return bindAdditive;
    });
    return {
        Additive: Additive, 
        runAdditive: runAdditive, 
        eqAdditive: eqAdditive, 
        ordAdditive: ordAdditive, 
        functorAdditive: functorAdditive, 
        applyAdditive: applyAdditive, 
        applicativeAdditive: applicativeAdditive, 
        bindAdditive: bindAdditive, 
        monadAdditive: monadAdditive, 
        extendAdditive: extendAdditive, 
        comonadAdditive: comonadAdditive, 
        showAdditive: showAdditive, 
        semigroupAdditive: semigroupAdditive, 
        monoidAdditive: monoidAdditive
    };
})();
var PS = PS || {};
PS.Data_Monoid_All = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Monoid = PS.Data_Monoid;
    
    /**
     *  | Boolean monoid and semigroup under conjunction.
     *  |
     *  | ``` purescript
     *  | All x <> All y == All (x && y)
     *  | mempty :: All == All true
     *  | ```
     */
    var All = function (x) {
        return x;
    };
    var showAll = new Prelude.Show(function (_169) {
        return "All (" + (Prelude.show(Prelude.showBoolean)(_169) + ")");
    });
    var semigroupAll = new Prelude.Semigroup(function (_170) {
        return function (_171) {
            return _170 && _171;
        };
    });
    var runAll = function (_162) {
        return _162;
    };
    var monoidAll = new Data_Monoid.Monoid(function () {
        return semigroupAll;
    }, true);
    var eqAll = new Prelude.Eq(function (_165) {
        return function (_166) {
            return _165 !== _166;
        };
    }, function (_163) {
        return function (_164) {
            return _163 === _164;
        };
    });
    var ordAll = new Prelude.Ord(function () {
        return eqAll;
    }, function (_167) {
        return function (_168) {
            return Prelude.compare(Prelude.ordBoolean)(_167)(_168);
        };
    });
    return {
        All: All, 
        runAll: runAll, 
        eqAll: eqAll, 
        ordAll: ordAll, 
        showAll: showAll, 
        semigroupAll: semigroupAll, 
        monoidAll: monoidAll
    };
})();
var PS = PS || {};
PS.Data_Monoid_Any = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Monoid = PS.Data_Monoid;
    
    /**
     *  | Boolean monoid and semigroup under disjunction.
     *  |
     *  | ``` purescript
     *  | Any x <> Any y == Any (x || y)
     *  | mempty :: Any == Any false
     *  | ```
     */
    var Any = function (x) {
        return x;
    };
    var showAny = new Prelude.Show(function (_179) {
        return "Any (" + (Prelude.show(Prelude.showBoolean)(_179) + ")");
    });
    var semigroupAny = new Prelude.Semigroup(function (_180) {
        return function (_181) {
            return _180 || _181;
        };
    });
    var runAny = function (_172) {
        return _172;
    };
    var monoidAny = new Data_Monoid.Monoid(function () {
        return semigroupAny;
    }, false);
    var eqAny = new Prelude.Eq(function (_175) {
        return function (_176) {
            return _175 !== _176;
        };
    }, function (_173) {
        return function (_174) {
            return _173 === _174;
        };
    });
    var ordAny = new Prelude.Ord(function () {
        return eqAny;
    }, function (_177) {
        return function (_178) {
            return Prelude.compare(Prelude.ordBoolean)(_177)(_178);
        };
    });
    return {
        Any: Any, 
        runAny: runAny, 
        eqAny: eqAny, 
        ordAny: ordAny, 
        showAny: showAny, 
        semigroupAny: semigroupAny, 
        monoidAny: monoidAny
    };
})();
var PS = PS || {};
PS.Data_Monoid_Dual = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Monoid = PS.Data_Monoid;
    var Control_Comonad = PS.Control_Comonad;
    var Control_Extend = PS.Control_Extend;
    
    /**
     *  | The dual of a monoid.
     *  |
     *  | ``` purescript
     *  | Dual x <> Dual y == Dual (y <> x)
     *  | mempty :: Dual _ == Dual mempty
     *  | ```
     */
    var Dual = function (x) {
        return x;
    };
    var showDual = function (__dict_Show_93) {
        return new Prelude.Show(function (_195) {
            return "Dual (" + (Prelude.show(__dict_Show_93)(_195) + ")");
        });
    };
    var semigroupDual = function (__dict_Semigroup_94) {
        return new Prelude.Semigroup(function (_196) {
            return function (_197) {
                return Prelude["<>"](__dict_Semigroup_94)(_197)(_196);
            };
        });
    };
    var runDual = function (_182) {
        return _182;
    };
    var monoidDual = function (__dict_Monoid_96) {
        return new Data_Monoid.Monoid(function () {
            return semigroupDual(__dict_Monoid_96["__superclass_Prelude.Semigroup_0"]());
        }, Data_Monoid.mempty(__dict_Monoid_96));
    };
    var functorDual = new Prelude.Functor(function (_189) {
        return function (_190) {
            return _189(_190);
        };
    });
    var extendDual = new Control_Extend.Extend(function (f) {
        return function (x) {
            return f(x);
        };
    }, function () {
        return functorDual;
    });
    var eqDual = function (__dict_Eq_97) {
        return new Prelude.Eq(function (_185) {
            return function (_186) {
                return Prelude["/="](__dict_Eq_97)(_185)(_186);
            };
        }, function (_183) {
            return function (_184) {
                return Prelude["=="](__dict_Eq_97)(_183)(_184);
            };
        });
    };
    var ordDual = function (__dict_Ord_95) {
        return new Prelude.Ord(function () {
            return eqDual(__dict_Ord_95["__superclass_Prelude.Eq_0"]());
        }, function (_187) {
            return function (_188) {
                return Prelude.compare(__dict_Ord_95)(_187)(_188);
            };
        });
    };
    var comonadDual = new Control_Comonad.Comonad(function () {
        return extendDual;
    }, runDual);
    var applyDual = new Prelude.Apply(function (_191) {
        return function (_192) {
            return _191(_192);
        };
    }, function () {
        return functorDual;
    });
    var bindDual = new Prelude.Bind(function (_193) {
        return function (_194) {
            return _194(_193);
        };
    }, function () {
        return applyDual;
    });
    var applicativeDual = new Prelude.Applicative(function () {
        return applyDual;
    }, Dual);
    var monadDual = new Prelude.Monad(function () {
        return applicativeDual;
    }, function () {
        return bindDual;
    });
    return {
        Dual: Dual, 
        runDual: runDual, 
        eqDual: eqDual, 
        ordDual: ordDual, 
        functorDual: functorDual, 
        applyDual: applyDual, 
        applicativeDual: applicativeDual, 
        bindDual: bindDual, 
        monadDual: monadDual, 
        extendDual: extendDual, 
        comonadDual: comonadDual, 
        showDual: showDual, 
        semigroupDual: semigroupDual, 
        monoidDual: monoidDual
    };
})();
var PS = PS || {};
PS.Data_Monoid_Endo = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Monoid = PS.Data_Monoid;
    
    /**
     *  | Monoid of endomorphisms under composition.
     *  |
     *  | Composes of functions of type `a -> a`:
     *  | ``` purescript
     *  | Endo f <> Endo g == Endo (f <<< g)
     *  | mempty :: Endo _ == Endo id
     *  | ```
     */
    var Endo = function (x) {
        return x;
    };
    var semigroupEndo = new Prelude.Semigroup(function (_199) {
        return function (_200) {
            return Prelude["<<<"](Prelude.semigroupoidArr)(_199)(_200);
        };
    });
    var runEndo = function (_198) {
        return _198;
    };
    var monoidEndo = new Data_Monoid.Monoid(function () {
        return semigroupEndo;
    }, Prelude.id(Prelude.categoryArr));
    return {
        Endo: Endo, 
        runEndo: runEndo, 
        semigroupEndo: semigroupEndo, 
        monoidEndo: monoidEndo
    };
})();
var PS = PS || {};
PS.Data_Monoid_Multiplicative = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Comonad = PS.Control_Comonad;
    var Control_Extend = PS.Control_Extend;
    var Data_Monoid = PS.Data_Monoid;
    
    /**
     *  | Monoid and semigroup for semirings under multiplication.
     *  |
     *  | ``` purescript
     *  | Multiplicative x <> Multiplicative y == Multiplicative (x * y)
     *  | mempty :: Multiplicative _ == Multiplicative one
     *  | ```
     */
    var Multiplicative = function (x) {
        return x;
    };
    var showMultiplicative = function (__dict_Show_98) {
        return new Prelude.Show(function (_214) {
            return "Multiplicative (" + (Prelude.show(__dict_Show_98)(_214) + ")");
        });
    };
    var semigroupMultiplicative = function (__dict_Semiring_99) {
        return new Prelude.Semigroup(function (_215) {
            return function (_216) {
                return Prelude["*"](__dict_Semiring_99)(_215)(_216);
            };
        });
    };
    var runMultiplicative = function (_201) {
        return _201;
    };
    var monoidMultiplicative = function (__dict_Semiring_101) {
        return new Data_Monoid.Monoid(function () {
            return semigroupMultiplicative(__dict_Semiring_101);
        }, Prelude.one(__dict_Semiring_101));
    };
    var functorMultiplicative = new Prelude.Functor(function (_208) {
        return function (_209) {
            return _208(_209);
        };
    });
    var extendAdditive = new Control_Extend.Extend(function (f) {
        return function (x) {
            return f(x);
        };
    }, function () {
        return functorMultiplicative;
    });
    var eqMultiplicative = function (__dict_Eq_102) {
        return new Prelude.Eq(function (_204) {
            return function (_205) {
                return Prelude["/="](__dict_Eq_102)(_204)(_205);
            };
        }, function (_202) {
            return function (_203) {
                return Prelude["=="](__dict_Eq_102)(_202)(_203);
            };
        });
    };
    var ordMultiplicative = function (__dict_Ord_100) {
        return new Prelude.Ord(function () {
            return eqMultiplicative(__dict_Ord_100["__superclass_Prelude.Eq_0"]());
        }, function (_206) {
            return function (_207) {
                return Prelude.compare(__dict_Ord_100)(_206)(_207);
            };
        });
    };
    var comonadAdditive = new Control_Comonad.Comonad(function () {
        return extendAdditive;
    }, runMultiplicative);
    var applyMultiplicative = new Prelude.Apply(function (_210) {
        return function (_211) {
            return _210(_211);
        };
    }, function () {
        return functorMultiplicative;
    });
    var bindMultiplicative = new Prelude.Bind(function (_212) {
        return function (_213) {
            return _213(_212);
        };
    }, function () {
        return applyMultiplicative;
    });
    var applicativeMultiplicative = new Prelude.Applicative(function () {
        return applyMultiplicative;
    }, Multiplicative);
    var monadMultiplicative = new Prelude.Monad(function () {
        return applicativeMultiplicative;
    }, function () {
        return bindMultiplicative;
    });
    return {
        Multiplicative: Multiplicative, 
        runMultiplicative: runMultiplicative, 
        eqMultiplicative: eqMultiplicative, 
        ordMultiplicative: ordMultiplicative, 
        functorMultiplicative: functorMultiplicative, 
        applyMultiplicative: applyMultiplicative, 
        applicativeMultiplicative: applicativeMultiplicative, 
        bindMultiplicative: bindMultiplicative, 
        monadMultiplicative: monadMultiplicative, 
        extendAdditive: extendAdditive, 
        comonadAdditive: comonadAdditive, 
        showMultiplicative: showMultiplicative, 
        semigroupMultiplicative: semigroupMultiplicative, 
        monoidMultiplicative: monoidMultiplicative
    };
})();
var PS = PS || {};
PS.Data_Tuple = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Monoid = PS.Data_Monoid;
    var Control_Lazy = PS.Control_Lazy;
    var Data_Array = PS.Data_Array;
    var Control_Comonad = PS.Control_Comonad;
    var Control_Extend = PS.Control_Extend;
    var Tuple = (function () {
        function Tuple(value0, value1) {
            this.value0 = value0;
            this.value1 = value1;
        };
        Tuple.create = function (value0) {
            return function (value1) {
                return new Tuple(value0, value1);
            };
        };
        return Tuple;
    })();
    var zip = Data_Array.zipWith(Tuple.create);
    var unzip = function (_227) {
        if (_227.length >= 1) {
            var _743 = _227.slice(1);
            var _737 = unzip(_743);
            return new Tuple(Prelude[":"]((_227[0]).value0)(_737.value0), Prelude[":"]((_227[0]).value1)(_737.value1));
        };
        if (_227.length === 0) {
            return new Tuple([  ], [  ]);
        };
        throw new Error("Failed pattern match");
    };
    var uncurry = function (_225) {
        return function (_226) {
            return _225(_226.value0)(_226.value1);
        };
    };
    var swap = function (_228) {
        return new Tuple(_228.value1, _228.value0);
    };
    var snd = function (_224) {
        return _224.value1;
    };
    var showTuple = function (__dict_Show_103) {
        return function (__dict_Show_104) {
            return new Prelude.Show(function (_229) {
                return "Tuple (" + (Prelude.show(__dict_Show_103)(_229.value0) + (") (" + (Prelude.show(__dict_Show_104)(_229.value1) + ")")));
            });
        };
    };
    var semigroupoidTuple = new Prelude.Semigroupoid(function (_234) {
        return function (_235) {
            return new Tuple(_235.value0, _234.value1);
        };
    });
    var semigroupTuple = function (__dict_Semigroup_105) {
        return function (__dict_Semigroup_106) {
            return new Prelude.Semigroup(function (_236) {
                return function (_237) {
                    return new Tuple(Prelude["<>"](__dict_Semigroup_105)(_236.value0)(_237.value0), Prelude["<>"](__dict_Semigroup_106)(_236.value1)(_237.value1));
                };
            });
        };
    };
    var monoidTuple = function (__dict_Monoid_109) {
        return function (__dict_Monoid_110) {
            return new Data_Monoid.Monoid(function () {
                return semigroupTuple(__dict_Monoid_109["__superclass_Prelude.Semigroup_0"]())(__dict_Monoid_110["__superclass_Prelude.Semigroup_0"]());
            }, new Tuple(Data_Monoid.mempty(__dict_Monoid_109), Data_Monoid.mempty(__dict_Monoid_110)));
        };
    };
    var functorTuple = new Prelude.Functor(function (_238) {
        return function (_239) {
            return new Tuple(_239.value0, _238(_239.value1));
        };
    });
    var fst = function (_223) {
        return _223.value0;
    };
    var lazyLazy1Tuple = function (__dict_Lazy1_112) {
        return function (__dict_Lazy1_113) {
            return new Control_Lazy.Lazy(function (f) {
                return new Tuple(Control_Lazy.defer1(__dict_Lazy1_112)(function (_219) {
                    return fst(f(Prelude.unit));
                }), Control_Lazy.defer1(__dict_Lazy1_113)(function (_220) {
                    return snd(f(Prelude.unit));
                }));
            });
        };
    };
    var lazyLazy2Tuple = function (__dict_Lazy2_114) {
        return function (__dict_Lazy2_115) {
            return new Control_Lazy.Lazy(function (f) {
                return new Tuple(Control_Lazy.defer2(__dict_Lazy2_114)(function (_221) {
                    return fst(f(Prelude.unit));
                }), Control_Lazy.defer2(__dict_Lazy2_115)(function (_222) {
                    return snd(f(Prelude.unit));
                }));
            });
        };
    };
    var lazyTuple = function (__dict_Lazy_116) {
        return function (__dict_Lazy_117) {
            return new Control_Lazy.Lazy(function (f) {
                return new Tuple(Control_Lazy.defer(__dict_Lazy_116)(function (_217) {
                    return fst(f(Prelude.unit));
                }), Control_Lazy.defer(__dict_Lazy_117)(function (_218) {
                    return snd(f(Prelude.unit));
                }));
            });
        };
    };
    var extendTuple = new Control_Extend.Extend(function (_244) {
        return function (_245) {
            return new Tuple(_245.value0, _244(_245));
        };
    }, function () {
        return functorTuple;
    });
    var eqTuple = function (__dict_Eq_118) {
        return function (__dict_Eq_119) {
            return new Prelude.Eq(function (t1) {
                return function (t2) {
                    return !Prelude["=="](eqTuple(__dict_Eq_118)(__dict_Eq_119))(t1)(t2);
                };
            }, function (_230) {
                return function (_231) {
                    return Prelude["=="](__dict_Eq_118)(_230.value0)(_231.value0) && Prelude["=="](__dict_Eq_119)(_230.value1)(_231.value1);
                };
            });
        };
    };
    var ordTuple = function (__dict_Ord_107) {
        return function (__dict_Ord_108) {
            return new Prelude.Ord(function () {
                return eqTuple(__dict_Ord_107["__superclass_Prelude.Eq_0"]())(__dict_Ord_108["__superclass_Prelude.Eq_0"]());
            }, function (_232) {
                return function (_233) {
                    var _794 = Prelude.compare(__dict_Ord_107)(_232.value0)(_233.value0);
                    if (_794 instanceof Prelude.EQ) {
                        return Prelude.compare(__dict_Ord_108)(_232.value1)(_233.value1);
                    };
                    return _794;
                };
            });
        };
    };
    var curry = function (f) {
        return function (a) {
            return function (b) {
                return f(new Tuple(a, b));
            };
        };
    };
    var comonadTuple = new Control_Comonad.Comonad(function () {
        return extendTuple;
    }, snd);
    var applyTuple = function (__dict_Semigroup_121) {
        return new Prelude.Apply(function (_240) {
            return function (_241) {
                return new Tuple(Prelude["<>"](__dict_Semigroup_121)(_240.value0)(_241.value0), _240.value1(_241.value1));
            };
        }, function () {
            return functorTuple;
        });
    };
    var bindTuple = function (__dict_Semigroup_120) {
        return new Prelude.Bind(function (_242) {
            return function (_243) {
                var _807 = _243(_242.value1);
                return new Tuple(Prelude["<>"](__dict_Semigroup_120)(_242.value0)(_807.value0), _807.value1);
            };
        }, function () {
            return applyTuple(__dict_Semigroup_120);
        });
    };
    var applicativeTuple = function (__dict_Monoid_122) {
        return new Prelude.Applicative(function () {
            return applyTuple(__dict_Monoid_122["__superclass_Prelude.Semigroup_0"]());
        }, Tuple.create(Data_Monoid.mempty(__dict_Monoid_122)));
    };
    var monadTuple = function (__dict_Monoid_111) {
        return new Prelude.Monad(function () {
            return applicativeTuple(__dict_Monoid_111);
        }, function () {
            return bindTuple(__dict_Monoid_111["__superclass_Prelude.Semigroup_0"]());
        });
    };
    return {
        Tuple: Tuple, 
        swap: swap, 
        unzip: unzip, 
        zip: zip, 
        uncurry: uncurry, 
        curry: curry, 
        snd: snd, 
        fst: fst, 
        showTuple: showTuple, 
        eqTuple: eqTuple, 
        ordTuple: ordTuple, 
        semigroupoidTuple: semigroupoidTuple, 
        semigroupTuple: semigroupTuple, 
        monoidTuple: monoidTuple, 
        functorTuple: functorTuple, 
        applyTuple: applyTuple, 
        applicativeTuple: applicativeTuple, 
        bindTuple: bindTuple, 
        monadTuple: monadTuple, 
        extendTuple: extendTuple, 
        comonadTuple: comonadTuple, 
        lazyTuple: lazyTuple, 
        lazyLazy1Tuple: lazyLazy1Tuple, 
        lazyLazy2Tuple: lazyLazy2Tuple
    };
})();
var PS = PS || {};
PS.Control_Comonad_Env_Trans = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Extend = PS.Control_Extend;
    var Control_Comonad = PS.Control_Comonad;
    var Control_Comonad_Trans = PS.Control_Comonad_Trans;
    var Data_Tuple = PS.Data_Tuple;
    var EnvT = function (x) {
        return x;
    };
    var withEnvT = function (_247) {
        return function (_248) {
            return EnvT(new Data_Tuple.Tuple(_247(_248.value0), _248.value1));
        };
    };
    var runEnvT = function (_246) {
        return _246;
    };
    var mapEnvT = function (_249) {
        return function (_250) {
            return EnvT(new Data_Tuple.Tuple(_250.value0, _249(_250.value1)));
        };
    };
    var functorEnvT = function (__dict_Functor_123) {
        return new Prelude.Functor(function (_251) {
            return function (_252) {
                return EnvT(new Data_Tuple.Tuple(_252.value0, Prelude["<$>"](__dict_Functor_123)(_251)(_252.value1)));
            };
        });
    };
    var extendEnvT = function (__dict_Extend_124) {
        return new Control_Extend.Extend(function (_253) {
            return function (_254) {
                return EnvT(new Data_Tuple.Tuple(_254.value0, Prelude["<$>"](__dict_Extend_124["__superclass_Prelude.Functor_0"]())(_253)(Control_Extend["<<="](__dict_Extend_124)(Prelude[">>>"](Prelude.semigroupoidArr)(Data_Tuple.Tuple.create(_254.value0))(EnvT))(_254.value1))));
            };
        }, function () {
            return functorEnvT(__dict_Extend_124["__superclass_Prelude.Functor_0"]());
        });
    };
    var comonadTransEnvT = new Control_Comonad_Trans.ComonadTrans(function (__dict_Comonad_125) {
        return function (_256) {
            return _256.value1;
        };
    });
    var comonadEnvT = function (__dict_Comonad_126) {
        return new Control_Comonad.Comonad(function () {
            return extendEnvT(__dict_Comonad_126["__superclass_Control.Extend.Extend_0"]());
        }, function (_255) {
            return Control_Comonad.extract(__dict_Comonad_126)(_255.value1);
        });
    };
    return {
        EnvT: EnvT, 
        mapEnvT: mapEnvT, 
        withEnvT: withEnvT, 
        runEnvT: runEnvT, 
        functorEnvT: functorEnvT, 
        extendEnvT: extendEnvT, 
        comonadEnvT: comonadEnvT, 
        comonadTransEnvT: comonadTransEnvT
    };
})();
var PS = PS || {};
PS.Control_Comonad_Store_Trans = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Extend = PS.Control_Extend;
    var Control_Comonad = PS.Control_Comonad;
    var Control_Comonad_Trans = PS.Control_Comonad_Trans;
    var Data_Tuple = PS.Data_Tuple;
    var StoreT = function (x) {
        return x;
    };
    var runStoreT = function (_257) {
        return _257;
    };
    var functorStoreT = function (__dict_Functor_127) {
        return new Prelude.Functor(function (_258) {
            return function (_259) {
                return StoreT(new Data_Tuple.Tuple(Prelude["<$>"](__dict_Functor_127)(function (h) {
                    return Prelude[">>>"](Prelude.semigroupoidArr)(h)(_258);
                })(_259.value0), _259.value1));
            };
        });
    };
    var extendStoreT = function (__dict_Extend_128) {
        return new Control_Extend.Extend(function (_260) {
            return function (_261) {
                return StoreT(new Data_Tuple.Tuple(Control_Extend["<<="](__dict_Extend_128)(function (w$prime) {
                    return function (s$prime) {
                        return _260(StoreT(new Data_Tuple.Tuple(w$prime, s$prime)));
                    };
                })(_261.value0), _261.value1));
            };
        }, function () {
            return functorStoreT(__dict_Extend_128["__superclass_Prelude.Functor_0"]());
        });
    };
    var comonadTransStoreT = new Control_Comonad_Trans.ComonadTrans(function (__dict_Comonad_129) {
        return function (_263) {
            return Prelude["<$>"]((__dict_Comonad_129["__superclass_Control.Extend.Extend_0"]())["__superclass_Prelude.Functor_0"]())(function (f) {
                return f(_263.value1);
            })(_263.value0);
        };
    });
    var comonadStoreT = function (__dict_Comonad_130) {
        return new Control_Comonad.Comonad(function () {
            return extendStoreT(__dict_Comonad_130["__superclass_Control.Extend.Extend_0"]());
        }, function (_262) {
            return Control_Comonad.extract(__dict_Comonad_130)(_262.value0)(_262.value1);
        });
    };
    return {
        StoreT: StoreT, 
        runStoreT: runStoreT, 
        functorStoreT: functorStoreT, 
        extendStoreT: extendStoreT, 
        comonadStoreT: comonadStoreT, 
        comonadTransStoreT: comonadTransStoreT
    };
})();
var PS = PS || {};
PS.Control_Comonad_Store_Class = (function () {
    "use strict";
    var Control_Comonad = PS.Control_Comonad;
    var Prelude = PS.Prelude;
    var Control_Extend = PS.Control_Extend;
    var Control_Comonad_Store_Trans = PS.Control_Comonad_Store_Trans;
    var Data_Tuple = PS.Data_Tuple;
    var ComonadStore = function (__superclass_Control$dotComonad$dotComonad_0, peek, pos) {
        this["__superclass_Control.Comonad.Comonad_0"] = __superclass_Control$dotComonad$dotComonad_0;
        this.peek = peek;
        this.pos = pos;
    };
    var pos = function (dict) {
        return dict.pos;
    };
    var peek = function (dict) {
        return dict.peek;
    };
    var peeks = function (__dict_ComonadStore_131) {
        return function (f) {
            return function (x) {
                return peek(__dict_ComonadStore_131)(f(pos(__dict_ComonadStore_131)(x)))(x);
            };
        };
    };
    var seeks = function (__dict_ComonadStore_132) {
        return function (__dict_Extend_133) {
            return function (f) {
                return function (x) {
                    return peeks(__dict_ComonadStore_132)(f)(Control_Extend.duplicate(__dict_Extend_133)(x));
                };
            };
        };
    };
    var seek = function (__dict_ComonadStore_134) {
        return function (__dict_Extend_135) {
            return function (s) {
                return function (x) {
                    return peek(__dict_ComonadStore_134)(s)(Control_Extend.duplicate(__dict_Extend_135)(x));
                };
            };
        };
    };
    var experiment = function (__dict_ComonadStore_136) {
        return function (__dict_Functor_137) {
            return function (f) {
                return function (x) {
                    return Prelude["<$>"](__dict_Functor_137)(Prelude.flip(peek(__dict_ComonadStore_136))(x))(f(pos(__dict_ComonadStore_136)(x)));
                };
            };
        };
    };
    var comonadStoreStoreT = function (__dict_Comonad_138) {
        return new ComonadStore(function () {
            return Control_Comonad_Store_Trans.comonadStoreT(__dict_Comonad_138);
        }, function (_265) {
            return function (_266) {
                return Control_Comonad.extract(__dict_Comonad_138)(_266.value0)(_265);
            };
        }, function (_264) {
            return _264.value1;
        });
    };
    return {
        ComonadStore: ComonadStore, 
        seeks: seeks, 
        seek: seek, 
        peeks: peeks, 
        experiment: experiment, 
        peek: peek, 
        pos: pos, 
        comonadStoreStoreT: comonadStoreStoreT
    };
})();
var PS = PS || {};
PS.Control_Comonad_Traced_Trans = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Extend = PS.Control_Extend;
    var Control_Comonad = PS.Control_Comonad;
    var Data_Monoid = PS.Data_Monoid;
    var Control_Comonad_Trans = PS.Control_Comonad_Trans;
    var Data_Tuple = PS.Data_Tuple;
    var TracedT = function (x) {
        return x;
    };
    var runTracedT = function (_267) {
        return _267;
    };
    var functorTracedT = function (__dict_Functor_139) {
        return new Prelude.Functor(function (_268) {
            return function (_269) {
                return Prelude["<$>"](__dict_Functor_139)(function (g) {
                    return function (t) {
                        return _268(g(t));
                    };
                })(_269);
            };
        });
    };
    var extendTracedT = function (__dict_Extend_140) {
        return function (__dict_Semigroup_141) {
            return new Control_Extend.Extend(function (_270) {
                return function (_271) {
                    return Control_Extend["<<="](__dict_Extend_140)(function (w_1) {
                        return function (t) {
                            return _270(Prelude["<$>"](__dict_Extend_140["__superclass_Prelude.Functor_0"]())(function (h) {
                                return function (t$prime) {
                                    return h(Prelude["<>"](__dict_Semigroup_141)(t)(t$prime));
                                };
                            })(w_1));
                        };
                    })(_271);
                };
            }, function () {
                return functorTracedT(__dict_Extend_140["__superclass_Prelude.Functor_0"]());
            });
        };
    };
    var comonadTransTracedT = function (__dict_Monoid_142) {
        return new Control_Comonad_Trans.ComonadTrans(function (__dict_Comonad_143) {
            return function (_273) {
                return Prelude["<$>"]((__dict_Comonad_143["__superclass_Control.Extend.Extend_0"]())["__superclass_Prelude.Functor_0"]())(function (f) {
                    return f(Data_Monoid.mempty(__dict_Monoid_142));
                })(_273);
            };
        });
    };
    var comonadTracedT = function (__dict_Comonad_144) {
        return function (__dict_Monoid_145) {
            return new Control_Comonad.Comonad(function () {
                return extendTracedT(__dict_Comonad_144["__superclass_Control.Extend.Extend_0"]())(__dict_Monoid_145["__superclass_Prelude.Semigroup_0"]());
            }, function (_272) {
                return Control_Comonad.extract(__dict_Comonad_144)(_272)(Data_Monoid.mempty(__dict_Monoid_145));
            });
        };
    };
    return {
        TracedT: TracedT, 
        runTracedT: runTracedT, 
        functorTracedT: functorTracedT, 
        extendTracedT: extendTracedT, 
        comonadTracedT: comonadTracedT, 
        comonadTransTracedT: comonadTransTracedT
    };
})();
var PS = PS || {};
PS.Control_Comonad_Traced_Class = (function () {
    "use strict";
    var Control_Comonad = PS.Control_Comonad;
    var Control_Comonad_Traced_Trans = PS.Control_Comonad_Traced_Trans;
    var Prelude = PS.Prelude;
    var Data_Monoid = PS.Data_Monoid;
    var Data_Tuple = PS.Data_Tuple;
    var ComonadTraced = function (__superclass_Control$dotComonad$dotComonad_0, track) {
        this["__superclass_Control.Comonad.Comonad_0"] = __superclass_Control$dotComonad$dotComonad_0;
        this.track = track;
    };
    var track = function (dict) {
        return dict.track;
    };
    var tracks = function (__dict_Comonad_146) {
        return function (__dict_ComonadTraced_147) {
            return function (f) {
                return function (w) {
                    return track(__dict_ComonadTraced_147)(f(Control_Comonad.extract(__dict_Comonad_146)(w)))(w);
                };
            };
        };
    };
    var listens = function (__dict_Functor_148) {
        return function (f) {
            return function (tr) {
                return Prelude["<$>"](__dict_Functor_148)(function (g) {
                    return function (t) {
                        return new Data_Tuple.Tuple(g(t), f(t));
                    };
                })(Control_Comonad_Traced_Trans.runTracedT(tr));
            };
        };
    };
    var listen = function (__dict_Functor_149) {
        return function (tr) {
            return Prelude["<$>"](__dict_Functor_149)(function (f) {
                return function (t) {
                    return new Data_Tuple.Tuple(f(t), t);
                };
            })(Control_Comonad_Traced_Trans.runTracedT(tr));
        };
    };
    var comonadTracedTracedT = function (__dict_Comonad_150) {
        return function (__dict_Monoid_151) {
            return new ComonadTraced(function () {
                return Control_Comonad_Traced_Trans.comonadTracedT(__dict_Comonad_150)(__dict_Monoid_151);
            }, function (t) {
                return function (tr) {
                    return Control_Comonad.extract(__dict_Comonad_150)(Control_Comonad_Traced_Trans.runTracedT(tr))(t);
                };
            });
        };
    };
    var censor = function (__dict_Functor_152) {
        return function (f) {
            return function (tr) {
                return Prelude["<$>"](__dict_Functor_152)(Prelude[">>>"](Prelude.semigroupoidArr)(f))(Control_Comonad_Traced_Trans.runTracedT(tr));
            };
        };
    };
    return {
        ComonadTraced: ComonadTraced, 
        censor: censor, 
        listens: listens, 
        listen: listen, 
        tracks: tracks, 
        track: track, 
        comonadTracedTracedT: comonadTracedTracedT
    };
})();
var PS = PS || {};
PS.Control_Monad_Error_Trans = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Apply = PS.Control_Apply;
    var Control_Monad_Error = PS.Control_Monad_Error;
    var Control_Alt = PS.Control_Alt;
    var Control_Alternative = PS.Control_Alternative;
    var Control_Plus = PS.Control_Plus;
    var Control_Monad_Trans = PS.Control_Monad_Trans;
    var Control_MonadPlus = PS.Control_MonadPlus;
    var Data_Either = PS.Data_Either;
    var Data_Monoid = PS.Data_Monoid;
    var Data_Tuple = PS.Data_Tuple;
    var ErrorT = function (x) {
        return x;
    };
    var runErrorT = function (_274) {
        return _274;
    };
    var monadTransErrorT = new Control_Monad_Trans.MonadTrans(function (__dict_Monad_155) {
        return function (m) {
            return ErrorT(Prelude[">>="](__dict_Monad_155["__superclass_Prelude.Bind_1"]())(m)(function (_7) {
                return Prelude["return"](__dict_Monad_155)(new Data_Either.Right(_7));
            }));
        };
    });
    var mapErrorT = function (f) {
        return function (m) {
            return ErrorT(f(runErrorT(m)));
        };
    };
    var liftPassError = function (__dict_Monad_159) {
        return function (pass) {
            return mapErrorT(function (m) {
                return pass(Prelude[">>="](__dict_Monad_159["__superclass_Prelude.Bind_1"]())(m)(function (_9) {
                    return Prelude["return"](__dict_Monad_159)((function () {
                        if (_9 instanceof Data_Either.Left) {
                            return new Data_Tuple.Tuple(new Data_Either.Left(_9.value0), Prelude.id(Prelude.categoryArr));
                        };
                        if (_9 instanceof Data_Either.Right) {
                            return new Data_Tuple.Tuple(new Data_Either.Right(_9.value0.value0), _9.value0.value1);
                        };
                        throw new Error("Failed pattern match");
                    })());
                }));
            });
        };
    };
    var liftListenError = function (__dict_Monad_160) {
        return function (listen) {
            return mapErrorT(function (m) {
                return Prelude[">>="](__dict_Monad_160["__superclass_Prelude.Bind_1"]())(listen(m))(function (_8) {
                    return Prelude["return"](__dict_Monad_160)(Prelude["<$>"](Data_Either.functorEither)(function (r) {
                        return new Data_Tuple.Tuple(r, _8.value1);
                    })(_8.value0));
                });
            });
        };
    };
    var liftCallCCError = function (callCC) {
        return function (f) {
            return ErrorT(callCC(function (c) {
                return runErrorT(f(function (a) {
                    return ErrorT(c(new Data_Either.Right(a)));
                }));
            }));
        };
    };
    var functorErrorT = function (__dict_Functor_161) {
        return new Prelude.Functor(function (f) {
            return Prelude["<<<"](Prelude.semigroupoidArr)(ErrorT)(Prelude["<<<"](Prelude.semigroupoidArr)(Prelude["<$>"](__dict_Functor_161)(Prelude["<$>"](Data_Either.functorEither)(f)))(runErrorT));
        });
    };
    var applyErrorT = function (__dict_Apply_163) {
        return new Prelude.Apply(function (_275) {
            return function (_276) {
                return ErrorT(Prelude["<*>"](__dict_Apply_163)(Prelude["<$>"](__dict_Apply_163["__superclass_Prelude.Functor_0"]())(Control_Apply.lift2(Data_Either.applyEither)(Prelude["$"]))(_275))(_276));
            };
        }, function () {
            return functorErrorT(__dict_Apply_163["__superclass_Prelude.Functor_0"]());
        });
    };
    var bindErrorT = function (__dict_Monad_162) {
        return new Prelude.Bind(function (m) {
            return function (f) {
                return ErrorT(Prelude[">>="](__dict_Monad_162["__superclass_Prelude.Bind_1"]())(runErrorT(m))(function (_6) {
                    if (_6 instanceof Data_Either.Left) {
                        return Prelude["return"](__dict_Monad_162)(new Data_Either.Left(_6.value0));
                    };
                    if (_6 instanceof Data_Either.Right) {
                        return runErrorT(f(_6.value0));
                    };
                    throw new Error("Failed pattern match");
                }));
            };
        }, function () {
            return applyErrorT((__dict_Monad_162["__superclass_Prelude.Applicative_0"]())["__superclass_Prelude.Apply_0"]());
        });
    };
    var applicativeErrorT = function (__dict_Applicative_164) {
        return new Prelude.Applicative(function () {
            return applyErrorT(__dict_Applicative_164["__superclass_Prelude.Apply_0"]());
        }, function (a) {
            return ErrorT(Prelude.pure(__dict_Applicative_164)(new Data_Either.Right(a)));
        });
    };
    var monadErrorT = function (__dict_Monad_158) {
        return new Prelude.Monad(function () {
            return applicativeErrorT(__dict_Monad_158["__superclass_Prelude.Applicative_0"]());
        }, function () {
            return bindErrorT(__dict_Monad_158);
        });
    };
    var altErrorT = function (__dict_Monad_167) {
        return new Control_Alt.Alt(function (x) {
            return function (y) {
                return ErrorT(Prelude[">>="](__dict_Monad_167["__superclass_Prelude.Bind_1"]())(runErrorT(x))(function (e) {
                    if (e instanceof Data_Either.Left) {
                        return runErrorT(y);
                    };
                    return Prelude["return"](__dict_Monad_167)(e);
                }));
            };
        }, function () {
            return functorErrorT(((__dict_Monad_167["__superclass_Prelude.Applicative_0"]())["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]());
        });
    };
    var plusErrorT = function (__dict_Monad_153) {
        return function (__dict_Error_154) {
            return new Control_Plus.Plus(function () {
                return altErrorT(__dict_Monad_153);
            }, Prelude["return"](__dict_Monad_153)(Data_Either.Left.create(Control_Monad_Error.strMsg(__dict_Error_154)("No alternative"))));
        };
    };
    var alternativeErrorT = function (__dict_Monad_165) {
        return function (__dict_Error_166) {
            return new Control_Alternative.Alternative(function () {
                return plusErrorT(__dict_Monad_165)(__dict_Error_166);
            }, function () {
                return applicativeErrorT(__dict_Monad_165["__superclass_Prelude.Applicative_0"]());
            });
        };
    };
    var monadPlusErrorT = function (__dict_Monad_156) {
        return function (__dict_Error_157) {
            return new Control_MonadPlus.MonadPlus(function () {
                return alternativeErrorT(__dict_Monad_156)(__dict_Error_157);
            }, function () {
                return monadErrorT(__dict_Monad_156);
            });
        };
    };
    return {
        ErrorT: ErrorT, 
        liftCallCCError: liftCallCCError, 
        liftPassError: liftPassError, 
        liftListenError: liftListenError, 
        mapErrorT: mapErrorT, 
        runErrorT: runErrorT, 
        functorErrorT: functorErrorT, 
        applyErrorT: applyErrorT, 
        applicativeErrorT: applicativeErrorT, 
        altErrorT: altErrorT, 
        plusErrorT: plusErrorT, 
        alternativeErrorT: alternativeErrorT, 
        bindErrorT: bindErrorT, 
        monadErrorT: monadErrorT, 
        monadPlusErrorT: monadPlusErrorT, 
        monadTransErrorT: monadTransErrorT
    };
})();
var PS = PS || {};
PS.Control_Monad_Maybe_Trans = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad = PS.Control_Monad;
    var Control_Monad_Trans = PS.Control_Monad_Trans;
    var Data_Either = PS.Data_Either;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Tuple = PS.Data_Tuple;
    var MaybeT = function (x) {
        return x;
    };
    var runMaybeT = function (_277) {
        return _277;
    };
    var monadTransMaybeT = new Control_Monad_Trans.MonadTrans(function (__dict_Monad_168) {
        return Prelude["<<<"](Prelude.semigroupoidArr)(MaybeT)(Prelude.liftM1(__dict_Monad_168)(Data_Maybe.Just.create));
    });
    var mapMaybeT = function (f) {
        return Prelude["<<<"](Prelude.semigroupoidArr)(MaybeT)(Prelude["<<<"](Prelude.semigroupoidArr)(f)(runMaybeT));
    };
    var liftPassMaybe = function (__dict_Monad_170) {
        return function (pass) {
            return mapMaybeT(function (m) {
                return pass(Prelude[">>="](__dict_Monad_170["__superclass_Prelude.Bind_1"]())(m)(function (_12) {
                    return Prelude["return"](__dict_Monad_170)((function () {
                        if (_12 instanceof Data_Maybe.Nothing) {
                            return new Data_Tuple.Tuple(Data_Maybe.Nothing.value, Prelude.id(Prelude.categoryArr));
                        };
                        if (_12 instanceof Data_Maybe.Just) {
                            return new Data_Tuple.Tuple(new Data_Maybe.Just(_12.value0.value0), _12.value0.value1);
                        };
                        throw new Error("Failed pattern match");
                    })());
                }));
            });
        };
    };
    var liftListenMaybe = function (__dict_Monad_171) {
        return function (listen) {
            return mapMaybeT(function (m) {
                return Prelude[">>="](__dict_Monad_171["__superclass_Prelude.Bind_1"]())(listen(m))(function (_11) {
                    return Prelude["return"](__dict_Monad_171)(Prelude["<$>"](Data_Maybe.functorMaybe)(function (r) {
                        return new Data_Tuple.Tuple(r, _11.value1);
                    })(_11.value0));
                });
            });
        };
    };
    var liftCatchMaybe = function ($$catch) {
        return function (m) {
            return function (h) {
                return MaybeT($$catch(runMaybeT(m))(Prelude["<<<"](Prelude.semigroupoidArr)(runMaybeT)(h)));
            };
        };
    };
    var liftCallCCMaybe = function (callCC) {
        return function (f) {
            return MaybeT(callCC(function (c) {
                return runMaybeT(f(function (a) {
                    return MaybeT(c(new Data_Maybe.Just(a)));
                }));
            }));
        };
    };
    var monadMaybeT = function (__dict_Monad_169) {
        return new Prelude.Monad(function () {
            return applicativeMaybeT(__dict_Monad_169);
        }, function () {
            return bindMaybeT(__dict_Monad_169);
        });
    };
    var functorMaybeT = function (__dict_Monad_172) {
        return new Prelude.Functor(Prelude.liftA1(applicativeMaybeT(__dict_Monad_172)));
    };
    var bindMaybeT = function (__dict_Monad_173) {
        return new Prelude.Bind(function (x) {
            return function (f) {
                return MaybeT(Prelude[">>="](__dict_Monad_173["__superclass_Prelude.Bind_1"]())(runMaybeT(x))(function (_10) {
                    if (_10 instanceof Data_Maybe.Nothing) {
                        return Prelude["return"](__dict_Monad_173)(Data_Maybe.Nothing.value);
                    };
                    if (_10 instanceof Data_Maybe.Just) {
                        return runMaybeT(f(_10.value0));
                    };
                    throw new Error("Failed pattern match");
                }));
            };
        }, function () {
            return applyMaybeT(__dict_Monad_173);
        });
    };
    var applyMaybeT = function (__dict_Monad_174) {
        return new Prelude.Apply(Prelude.ap(monadMaybeT(__dict_Monad_174)), function () {
            return functorMaybeT(__dict_Monad_174);
        });
    };
    var applicativeMaybeT = function (__dict_Monad_175) {
        return new Prelude.Applicative(function () {
            return applyMaybeT(__dict_Monad_175);
        }, Prelude["<<<"](Prelude.semigroupoidArr)(MaybeT)(Prelude["<<<"](Prelude.semigroupoidArr)(Prelude.pure(__dict_Monad_175["__superclass_Prelude.Applicative_0"]()))(Data_Maybe.Just.create)));
    };
    return {
        MaybeT: MaybeT, 
        liftCallCCMaybe: liftCallCCMaybe, 
        liftPassMaybe: liftPassMaybe, 
        liftListenMaybe: liftListenMaybe, 
        liftCatchMaybe: liftCatchMaybe, 
        mapMaybeT: mapMaybeT, 
        runMaybeT: runMaybeT, 
        functorMaybeT: functorMaybeT, 
        applyMaybeT: applyMaybeT, 
        applicativeMaybeT: applicativeMaybeT, 
        bindMaybeT: bindMaybeT, 
        monadMaybeT: monadMaybeT, 
        monadTransMaybeT: monadTransMaybeT
    };
})();
var PS = PS || {};
PS.Control_Monad_RWS_Trans = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Tuple = PS.Data_Tuple;
    var Data_Monoid = PS.Data_Monoid;
    var Control_Monad_Trans = PS.Control_Monad_Trans;
    var RWST = function (x) {
        return x;
    };
    var runRWST = function (_283) {
        return _283;
    };
    var withRWST = function (f) {
        return function (m) {
            return function (r) {
                return function (s) {
                    return Data_Tuple.uncurry(runRWST(m))(f(r)(s));
                };
            };
        };
    };
    var mkSee = function (__dict_Monoid_178) {
        return function (s) {
            return function (a) {
                return function (w) {
                    return {
                        state: s, 
                        result: a, 
                        log: w
                    };
                };
            };
        };
    };
    var monadTransRWST = function (__dict_Monoid_179) {
        return new Control_Monad_Trans.MonadTrans(function (__dict_Monad_180) {
            return function (m) {
                return function (_282) {
                    return function (s) {
                        return Prelude[">>="](__dict_Monad_180["__superclass_Prelude.Bind_1"]())(m)(function (a) {
                            return Prelude["return"](__dict_Monad_180)(mkSee(__dict_Monoid_179)(s)(a)(Data_Monoid.mempty(__dict_Monoid_179)));
                        });
                    };
                };
            };
        });
    };
    var mapRWST = function (f) {
        return function (m) {
            return function (r) {
                return function (s) {
                    return f(runRWST(m)(r)(s));
                };
            };
        };
    };
    var functorRWST = function (__dict_Functor_181) {
        return new Prelude.Functor(function (f) {
            return function (m) {
                return function (r) {
                    return function (s) {
                        return Prelude["<$>"](__dict_Functor_181)(function (see) {
                            var _897 = {};
                            for (var _898 in see) {
                                if (see.hasOwnProperty(_898)) {
                                    _897[_898] = see[_898];
                                };
                            };
                            _897.result = f(see.result);
                            return _897;
                        })(runRWST(m)(r)(s));
                    };
                };
            };
        });
    };
    var execRWST = function (__dict_Monad_182) {
        return function (m) {
            return function (r) {
                return function (s) {
                    return Prelude[">>="](__dict_Monad_182["__superclass_Prelude.Bind_1"]())(runRWST(m)(r)(s))(function (see) {
                        return Prelude["return"](__dict_Monad_182)(new Data_Tuple.Tuple(see.state, see.log));
                    });
                };
            };
        };
    };
    var evalRWST = function (__dict_Monad_183) {
        return function (m) {
            return function (r) {
                return function (s) {
                    return Prelude[">>="](__dict_Monad_183["__superclass_Prelude.Bind_1"]())(runRWST(m)(r)(s))(function (see) {
                        return Prelude["return"](__dict_Monad_183)(new Data_Tuple.Tuple(see.result, see.log));
                    });
                };
            };
        };
    };
    var applyRWST = function (__dict_Bind_186) {
        return function (__dict_Monoid_187) {
            return new Prelude.Apply(function (f) {
                return function (m) {
                    return function (r) {
                        return function (s) {
                            return Prelude[">>="](__dict_Bind_186)(runRWST(f)(r)(s))(function (_279) {
                                return Prelude["<#>"]((__dict_Bind_186["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(runRWST(m)(r)(_279.state))(function (_278) {
                                    return mkSee(__dict_Monoid_187)(_278.state)(_279.result(_278.result))(Prelude["++"](__dict_Monoid_187["__superclass_Prelude.Semigroup_0"]())(_279.log)(_278.log));
                                });
                            });
                        };
                    };
                };
            }, function () {
                return functorRWST((__dict_Bind_186["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]());
            });
        };
    };
    var bindRWST = function (__dict_Bind_184) {
        return function (__dict_Monoid_185) {
            return new Prelude.Bind(function (m) {
                return function (f) {
                    return function (r) {
                        return function (s) {
                            return Prelude[">>="](__dict_Bind_184)(runRWST(m)(r)(s))(function (_280) {
                                return Prelude["<#>"]((__dict_Bind_184["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(runRWST(f(_280.result))(r)(_280.state))(function (see$prime) {
                                    var _908 = {};
                                    for (var _909 in see$prime) {
                                        if (see$prime.hasOwnProperty(_909)) {
                                            _908[_909] = see$prime[_909];
                                        };
                                    };
                                    _908.log = Prelude["++"](__dict_Monoid_185["__superclass_Prelude.Semigroup_0"]())(_280.log)(see$prime.log);
                                    return _908;
                                });
                            });
                        };
                    };
                };
            }, function () {
                return applyRWST(__dict_Bind_184)(__dict_Monoid_185);
            });
        };
    };
    var applicativeRWST = function (__dict_Monad_188) {
        return function (__dict_Monoid_189) {
            return new Prelude.Applicative(function () {
                return applyRWST(__dict_Monad_188["__superclass_Prelude.Bind_1"]())(__dict_Monoid_189);
            }, function (a) {
                return function (_281) {
                    return function (s) {
                        return Prelude.pure(__dict_Monad_188["__superclass_Prelude.Applicative_0"]())(mkSee(__dict_Monoid_189)(s)(a)(Data_Monoid.mempty(__dict_Monoid_189)));
                    };
                };
            });
        };
    };
    var monadRWST = function (__dict_Monad_176) {
        return function (__dict_Monoid_177) {
            return new Prelude.Monad(function () {
                return applicativeRWST(__dict_Monad_176)(__dict_Monoid_177);
            }, function () {
                return bindRWST(__dict_Monad_176["__superclass_Prelude.Bind_1"]())(__dict_Monoid_177);
            });
        };
    };
    return {
        RWST: RWST, 
        withRWST: withRWST, 
        mapRWST: mapRWST, 
        execRWST: execRWST, 
        evalRWST: evalRWST, 
        runRWST: runRWST, 
        mkSee: mkSee, 
        functorRWST: functorRWST, 
        applyRWST: applyRWST, 
        bindRWST: bindRWST, 
        applicativeRWST: applicativeRWST, 
        monadRWST: monadRWST, 
        monadTransRWST: monadTransRWST
    };
})();
var PS = PS || {};
PS.Control_Monad_State_Trans = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Tuple = PS.Data_Tuple;
    var Control_Alt = PS.Control_Alt;
    var Control_Plus = PS.Control_Plus;
    var Control_Alternative = PS.Control_Alternative;
    var Control_Monad_Trans = PS.Control_Monad_Trans;
    var Control_MonadPlus = PS.Control_MonadPlus;
    var Control_Lazy = PS.Control_Lazy;
    var StateT = function (x) {
        return x;
    };
    var runStateT = function (_286) {
        return _286;
    };
    var withStateT = function (f) {
        return function (s) {
            return StateT(Prelude["<<<"](Prelude.semigroupoidArr)(runStateT(s))(f));
        };
    };
    var monadTransStateT = new Control_Monad_Trans.MonadTrans(function (__dict_Monad_192) {
        return function (m) {
            return function (s) {
                return Prelude[">>="](__dict_Monad_192["__superclass_Prelude.Bind_1"]())(m)(function (_14) {
                    return Prelude["return"](__dict_Monad_192)(new Data_Tuple.Tuple(_14, s));
                });
            };
        };
    });
    var mapStateT = function (f) {
        return function (m) {
            return StateT(Prelude["<<<"](Prelude.semigroupoidArr)(f)(runStateT(m)));
        };
    };
    var liftPassState = function (__dict_Monad_195) {
        return function (pass) {
            return function (m) {
                return StateT(function (s) {
                    return pass(Prelude[">>="](__dict_Monad_195["__superclass_Prelude.Bind_1"]())(runStateT(m)(s))(function (_16) {
                        return Prelude["return"](__dict_Monad_195)(new Data_Tuple.Tuple(new Data_Tuple.Tuple(_16.value0.value0, _16.value1), _16.value0.value1));
                    }));
                });
            };
        };
    };
    var liftListenState = function (__dict_Monad_196) {
        return function (listen) {
            return function (m) {
                return StateT(function (s) {
                    return Prelude[">>="](__dict_Monad_196["__superclass_Prelude.Bind_1"]())(listen(runStateT(m)(s)))(function (_15) {
                        return Prelude["return"](__dict_Monad_196)(new Data_Tuple.Tuple(new Data_Tuple.Tuple(_15.value0.value0, _15.value1), _15.value0.value1));
                    });
                });
            };
        };
    };
    var liftCatchState = function ($$catch) {
        return function (m) {
            return function (h) {
                return StateT(function (s) {
                    return $$catch(runStateT(m)(s))(function (e) {
                        return runStateT(h(e))(s);
                    });
                });
            };
        };
    };
    var liftCallCCState$prime = function (callCC) {
        return function (f) {
            return StateT(function (s) {
                return callCC(function (c) {
                    return runStateT(f(function (a) {
                        return StateT(function (s$prime) {
                            return c(new Data_Tuple.Tuple(a, s$prime));
                        });
                    }))(s);
                });
            });
        };
    };
    var liftCallCCState = function (callCC) {
        return function (f) {
            return StateT(function (s) {
                return callCC(function (c) {
                    return runStateT(f(function (a) {
                        return StateT(function (_285) {
                            return c(new Data_Tuple.Tuple(a, s));
                        });
                    }))(s);
                });
            });
        };
    };
    var lazy1StateT = new Control_Lazy.Lazy1(function (f) {
        return StateT(function (s) {
            return runStateT(f(Prelude.unit))(s);
        });
    });
    var execStateT = function (__dict_Apply_198) {
        return function (m) {
            return function (s) {
                return Prelude["<$>"](__dict_Apply_198["__superclass_Prelude.Functor_0"]())(Data_Tuple.snd)(runStateT(m)(s));
            };
        };
    };
    var evalStateT = function (__dict_Apply_199) {
        return function (m) {
            return function (s) {
                return Prelude["<$>"](__dict_Apply_199["__superclass_Prelude.Functor_0"]())(Data_Tuple.fst)(runStateT(m)(s));
            };
        };
    };
    var monadStateT = function (__dict_Monad_193) {
        return new Prelude.Monad(function () {
            return applicativeStateT(__dict_Monad_193);
        }, function () {
            return bindStateT(__dict_Monad_193);
        });
    };
    var functorStateT = function (__dict_Monad_197) {
        return new Prelude.Functor(Prelude.liftM1(monadStateT(__dict_Monad_197)));
    };
    var bindStateT = function (__dict_Monad_200) {
        return new Prelude.Bind(function (_287) {
            return function (_288) {
                return function (s) {
                    return Prelude[">>="](__dict_Monad_200["__superclass_Prelude.Bind_1"]())(_287(s))(function (_13) {
                        return runStateT(_288(_13.value0))(_13.value1);
                    });
                };
            };
        }, function () {
            return applyStateT(__dict_Monad_200);
        });
    };
    var applyStateT = function (__dict_Monad_201) {
        return new Prelude.Apply(Prelude.ap(monadStateT(__dict_Monad_201)), function () {
            return functorStateT(__dict_Monad_201);
        });
    };
    var applicativeStateT = function (__dict_Monad_202) {
        return new Prelude.Applicative(function () {
            return applyStateT(__dict_Monad_202);
        }, function (a) {
            return StateT(function (s) {
                return Prelude["return"](__dict_Monad_202)(new Data_Tuple.Tuple(a, s));
            });
        });
    };
    var altStateT = function (__dict_Monad_205) {
        return function (__dict_Alt_206) {
            return new Control_Alt.Alt(function (x) {
                return function (y) {
                    return StateT(function (s) {
                        return Control_Alt["<|>"](__dict_Alt_206)(runStateT(x)(s))(runStateT(y)(s));
                    });
                };
            }, function () {
                return functorStateT(__dict_Monad_205);
            });
        };
    };
    var plusStateT = function (__dict_Monad_190) {
        return function (__dict_Plus_191) {
            return new Control_Plus.Plus(function () {
                return altStateT(__dict_Monad_190)(__dict_Plus_191["__superclass_Control.Alt.Alt_0"]());
            }, StateT(function (_284) {
                return Control_Plus.empty(__dict_Plus_191);
            }));
        };
    };
    var alternativeStateT = function (__dict_Monad_203) {
        return function (__dict_Alternative_204) {
            return new Control_Alternative.Alternative(function () {
                return plusStateT(__dict_Monad_203)(__dict_Alternative_204["__superclass_Control.Plus.Plus_1"]());
            }, function () {
                return applicativeStateT(__dict_Monad_203);
            });
        };
    };
    var monadPlusStateT = function (__dict_MonadPlus_194) {
        return new Control_MonadPlus.MonadPlus(function () {
            return alternativeStateT(__dict_MonadPlus_194["__superclass_Prelude.Monad_0"]())(__dict_MonadPlus_194["__superclass_Control.Alternative.Alternative_1"]());
        }, function () {
            return monadStateT(__dict_MonadPlus_194["__superclass_Prelude.Monad_0"]());
        });
    };
    return {
        StateT: StateT, 
        "liftCallCCState'": liftCallCCState$prime, 
        liftCallCCState: liftCallCCState, 
        liftPassState: liftPassState, 
        liftListenState: liftListenState, 
        liftCatchState: liftCatchState, 
        withStateT: withStateT, 
        mapStateT: mapStateT, 
        execStateT: execStateT, 
        evalStateT: evalStateT, 
        runStateT: runStateT, 
        functorStateT: functorStateT, 
        applyStateT: applyStateT, 
        applicativeStateT: applicativeStateT, 
        altStateT: altStateT, 
        plusStateT: plusStateT, 
        alternativeStateT: alternativeStateT, 
        bindStateT: bindStateT, 
        monadStateT: monadStateT, 
        monadPlusStateT: monadPlusStateT, 
        monadTransStateT: monadTransStateT, 
        lazy1StateT: lazy1StateT
    };
})();
var PS = PS || {};
PS.Control_Monad_Writer_Trans = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Tuple = PS.Data_Tuple;
    var Data_Monoid = PS.Data_Monoid;
    var Control_Alt = PS.Control_Alt;
    var Control_Plus = PS.Control_Plus;
    var Control_Alternative = PS.Control_Alternative;
    var Control_Monad_Trans = PS.Control_Monad_Trans;
    var Control_MonadPlus = PS.Control_MonadPlus;
    var WriterT = function (x) {
        return x;
    };
    var runWriterT = function (_290) {
        return _290;
    };
    var monadTransWriterT = function (__dict_Monoid_211) {
        return new Control_Monad_Trans.MonadTrans(function (__dict_Monad_212) {
            return function (m) {
                return WriterT(Prelude[">>="](__dict_Monad_212["__superclass_Prelude.Bind_1"]())(m)(function (_19) {
                    return Prelude["return"](__dict_Monad_212)(new Data_Tuple.Tuple(_19, Data_Monoid.mempty(__dict_Monoid_211)));
                }));
            };
        });
    };
    var mapWriterT = function (f) {
        return function (m) {
            return WriterT(f(runWriterT(m)));
        };
    };
    var liftCatchWriter = function ($$catch) {
        return function (m) {
            return function (h) {
                return WriterT($$catch(runWriterT(m))(function (e) {
                    return runWriterT(h(e));
                }));
            };
        };
    };
    var liftCallCCWriter = function (__dict_Monoid_215) {
        return function (callCC) {
            return function (f) {
                return WriterT(callCC(function (c) {
                    return runWriterT(f(function (a) {
                        return WriterT(c(new Data_Tuple.Tuple(a, Data_Monoid.mempty(__dict_Monoid_215))));
                    }));
                }));
            };
        };
    };
    var functorWriterT = function (__dict_Functor_216) {
        return new Prelude.Functor(function (f) {
            return mapWriterT(Prelude["<$>"](__dict_Functor_216)(function (_289) {
                return new Data_Tuple.Tuple(f(_289.value0), _289.value1);
            }));
        });
    };
    var execWriterT = function (__dict_Apply_217) {
        return function (m) {
            return Prelude["<$>"](__dict_Apply_217["__superclass_Prelude.Functor_0"]())(Data_Tuple.snd)(runWriterT(m));
        };
    };
    var applyWriterT = function (__dict_Monoid_220) {
        return function (__dict_Apply_221) {
            return new Prelude.Apply(function (f) {
                return function (v) {
                    return WriterT((function () {
                        var k = function (_291) {
                            return function (_292) {
                                return new Data_Tuple.Tuple(_291.value0(_292.value0), Prelude["<>"](__dict_Monoid_220["__superclass_Prelude.Semigroup_0"]())(_291.value1)(_292.value1));
                            };
                        };
                        return Prelude["<*>"](__dict_Apply_221)(Prelude["<$>"](__dict_Apply_221["__superclass_Prelude.Functor_0"]())(k)(runWriterT(f)))(runWriterT(v));
                    })());
                };
            }, function () {
                return functorWriterT(__dict_Apply_221["__superclass_Prelude.Functor_0"]());
            });
        };
    };
    var bindWriterT = function (__dict_Monoid_218) {
        return function (__dict_Monad_219) {
            return new Prelude.Bind(function (m) {
                return function (k) {
                    return WriterT(Prelude[">>="](__dict_Monad_219["__superclass_Prelude.Bind_1"]())(runWriterT(m))(function (_18) {
                        return Prelude[">>="](__dict_Monad_219["__superclass_Prelude.Bind_1"]())(runWriterT(k(_18.value0)))(function (_17) {
                            return Prelude["return"](__dict_Monad_219)(new Data_Tuple.Tuple(_17.value0, Prelude["<>"](__dict_Monoid_218["__superclass_Prelude.Semigroup_0"]())(_18.value1)(_17.value1)));
                        });
                    }));
                };
            }, function () {
                return applyWriterT(__dict_Monoid_218)((__dict_Monad_219["__superclass_Prelude.Applicative_0"]())["__superclass_Prelude.Apply_0"]());
            });
        };
    };
    var applicativeWriterT = function (__dict_Monoid_222) {
        return function (__dict_Applicative_223) {
            return new Prelude.Applicative(function () {
                return applyWriterT(__dict_Monoid_222)(__dict_Applicative_223["__superclass_Prelude.Apply_0"]());
            }, function (a) {
                return WriterT(Prelude.pure(__dict_Applicative_223)(new Data_Tuple.Tuple(a, Data_Monoid.mempty(__dict_Monoid_222))));
            });
        };
    };
    var monadWriterT = function (__dict_Monoid_209) {
        return function (__dict_Monad_210) {
            return new Prelude.Monad(function () {
                return applicativeWriterT(__dict_Monoid_209)(__dict_Monad_210["__superclass_Prelude.Applicative_0"]());
            }, function () {
                return bindWriterT(__dict_Monoid_209)(__dict_Monad_210);
            });
        };
    };
    var altWriterT = function (__dict_Monoid_226) {
        return function (__dict_Alt_227) {
            return new Control_Alt.Alt(function (m) {
                return function (n) {
                    return WriterT(Control_Alt["<|>"](__dict_Alt_227)(runWriterT(m))(runWriterT(n)));
                };
            }, function () {
                return functorWriterT(__dict_Alt_227["__superclass_Prelude.Functor_0"]());
            });
        };
    };
    var plusWriterT = function (__dict_Monoid_207) {
        return function (__dict_Plus_208) {
            return new Control_Plus.Plus(function () {
                return altWriterT(__dict_Monoid_207)(__dict_Plus_208["__superclass_Control.Alt.Alt_0"]());
            }, Control_Plus.empty(__dict_Plus_208));
        };
    };
    var alternativeWriterT = function (__dict_Monoid_224) {
        return function (__dict_Alternative_225) {
            return new Control_Alternative.Alternative(function () {
                return plusWriterT(__dict_Monoid_224)(__dict_Alternative_225["__superclass_Control.Plus.Plus_1"]());
            }, function () {
                return applicativeWriterT(__dict_Monoid_224)(__dict_Alternative_225["__superclass_Prelude.Applicative_0"]());
            });
        };
    };
    var monadPlusWriterT = function (__dict_Monoid_213) {
        return function (__dict_MonadPlus_214) {
            return new Control_MonadPlus.MonadPlus(function () {
                return alternativeWriterT(__dict_Monoid_213)(__dict_MonadPlus_214["__superclass_Control.Alternative.Alternative_1"]());
            }, function () {
                return monadWriterT(__dict_Monoid_213)(__dict_MonadPlus_214["__superclass_Prelude.Monad_0"]());
            });
        };
    };
    return {
        WriterT: WriterT, 
        liftCallCCWriter: liftCallCCWriter, 
        liftCatchWriter: liftCatchWriter, 
        mapWriterT: mapWriterT, 
        execWriterT: execWriterT, 
        runWriterT: runWriterT, 
        functorWriterT: functorWriterT, 
        applyWriterT: applyWriterT, 
        applicativeWriterT: applicativeWriterT, 
        altWriterT: altWriterT, 
        plusWriterT: plusWriterT, 
        alternativeWriterT: alternativeWriterT, 
        bindWriterT: bindWriterT, 
        monadWriterT: monadWriterT, 
        monadPlusWriterT: monadPlusWriterT, 
        monadTransWriterT: monadTransWriterT
    };
})();
var PS = PS || {};
PS.Control_Monad_Cont_Class = (function () {
    "use strict";
    var Control_Monad_Cont_Trans = PS.Control_Monad_Cont_Trans;
    var Control_Monad_Error_Trans = PS.Control_Monad_Error_Trans;
    var Control_Monad_Maybe_Trans = PS.Control_Monad_Maybe_Trans;
    var Control_Monad_Reader_Trans = PS.Control_Monad_Reader_Trans;
    var Control_Monad_State_Trans = PS.Control_Monad_State_Trans;
    var Control_Monad_Writer_Trans = PS.Control_Monad_Writer_Trans;
    var Prelude = PS.Prelude;
    var Control_Monad_Error = PS.Control_Monad_Error;
    var Data_Monoid = PS.Data_Monoid;
    var MonadCont = function (callCC) {
        this.callCC = callCC;
    };
    var monadContContT = function (__dict_Monad_228) {
        return new MonadCont(Control_Monad_Cont_Trans.callCC);
    };
    var callCC = function (dict) {
        return dict.callCC;
    };
    var monadContErrorT = function (__dict_MonadCont_229) {
        return new MonadCont(Control_Monad_Error_Trans.liftCallCCError(callCC(__dict_MonadCont_229)));
    };
    var monadContMaybeT = function (__dict_MonadCont_230) {
        return new MonadCont(Control_Monad_Maybe_Trans.liftCallCCMaybe(callCC(__dict_MonadCont_230)));
    };
    var monadContReaderT = function (__dict_MonadCont_231) {
        return new MonadCont(Control_Monad_Reader_Trans.liftCallCCReader(callCC(__dict_MonadCont_231)));
    };
    var monadContStateT = function (__dict_MonadCont_232) {
        return new MonadCont(Control_Monad_State_Trans["liftCallCCState'"](callCC(__dict_MonadCont_232)));
    };
    var monadWriterT = function (__dict_Monoid_233) {
        return function (__dict_MonadCont_234) {
            return new MonadCont(Control_Monad_Writer_Trans.liftCallCCWriter(__dict_Monoid_233)(callCC(__dict_MonadCont_234)));
        };
    };
    return {
        MonadCont: MonadCont, 
        callCC: callCC, 
        monadContContT: monadContContT, 
        monadContErrorT: monadContErrorT, 
        monadContMaybeT: monadContMaybeT, 
        monadContReaderT: monadContReaderT, 
        monadContStateT: monadContStateT, 
        monadWriterT: monadWriterT
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff_Class = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Trans = PS.Control_Monad_Trans;
    var Data_Monoid = PS.Data_Monoid;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Control_Monad_Maybe_Trans = PS.Control_Monad_Maybe_Trans;
    var Control_Monad_Error_Trans = PS.Control_Monad_Error_Trans;
    var Control_Monad_State_Trans = PS.Control_Monad_State_Trans;
    var Control_Monad_Writer_Trans = PS.Control_Monad_Writer_Trans;
    var Control_Monad_Reader_Trans = PS.Control_Monad_Reader_Trans;
    var Control_Monad_RWS_Trans = PS.Control_Monad_RWS_Trans;
    
    /**
     *  | The `MonadEff` class captures those monads which support native effects.
     *  |
     *  | Instances are provided for `Eff` itself, and the standard monad transformers.
     *  |
     *  | `liftEff` can be used in any appropriate monad transformer stack to lift an action
     *  | of type `Eff eff a` into the monad.
     *  |
     *  | Note that `MonadEff` is parameterized by the row of effects, so type inference can be
     *  | tricky. It is generally recommended to either work with a polymorphic row of effects,
     *  | or a concrete, closed row of effects such as `(trace :: Trace)`.
     */
    var MonadEff = function (__superclass_Prelude$dotMonad_0, liftEff) {
        this["__superclass_Prelude.Monad_0"] = __superclass_Prelude$dotMonad_0;
        this.liftEff = liftEff;
    };
    var monadEffEff = new MonadEff(function () {
        return Control_Monad_Eff.monadEff;
    }, Prelude.id(Prelude.categoryArr));
    
    /**
     *  | The `MonadEff` class captures those monads which support native effects.
     *  |
     *  | Instances are provided for `Eff` itself, and the standard monad transformers.
     *  |
     *  | `liftEff` can be used in any appropriate monad transformer stack to lift an action
     *  | of type `Eff eff a` into the monad.
     *  |
     *  | Note that `MonadEff` is parameterized by the row of effects, so type inference can be
     *  | tricky. It is generally recommended to either work with a polymorphic row of effects,
     *  | or a concrete, closed row of effects such as `(trace :: Trace)`.
     */
    var liftEff = function (dict) {
        return dict.liftEff;
    };
    var monadEffError = function (__dict_Monad_235) {
        return function (__dict_MonadEff_236) {
            return new MonadEff(function () {
                return Control_Monad_Error_Trans.monadErrorT(__dict_Monad_235);
            }, Prelude["<<<"](Prelude.semigroupoidArr)(Control_Monad_Trans.lift(Control_Monad_Error_Trans.monadTransErrorT)(__dict_Monad_235))(liftEff(__dict_MonadEff_236)));
        };
    };
    var monadEffMaybe = function (__dict_Monad_237) {
        return function (__dict_MonadEff_238) {
            return new MonadEff(function () {
                return Control_Monad_Maybe_Trans.monadMaybeT(__dict_Monad_237);
            }, Prelude["<<<"](Prelude.semigroupoidArr)(Control_Monad_Trans.lift(Control_Monad_Maybe_Trans.monadTransMaybeT)(__dict_Monad_237))(liftEff(__dict_MonadEff_238)));
        };
    };
    var monadEffRWS = function (__dict_Monad_239) {
        return function (__dict_Monoid_240) {
            return function (__dict_MonadEff_241) {
                return new MonadEff(function () {
                    return Control_Monad_RWS_Trans.monadRWST(__dict_Monad_239)(__dict_Monoid_240);
                }, Prelude["<<<"](Prelude.semigroupoidArr)(Control_Monad_Trans.lift(Control_Monad_RWS_Trans.monadTransRWST(__dict_Monoid_240))(__dict_Monad_239))(liftEff(__dict_MonadEff_241)));
            };
        };
    };
    var monadEffReader = function (__dict_Monad_242) {
        return function (__dict_MonadEff_243) {
            return new MonadEff(function () {
                return Control_Monad_Reader_Trans.monadReaderT(__dict_Monad_242);
            }, Prelude["<<<"](Prelude.semigroupoidArr)(Control_Monad_Trans.lift(Control_Monad_Reader_Trans.monadTransReaderT)(__dict_Monad_242))(liftEff(__dict_MonadEff_243)));
        };
    };
    var monadEffState = function (__dict_Monad_244) {
        return function (__dict_MonadEff_245) {
            return new MonadEff(function () {
                return Control_Monad_State_Trans.monadStateT(__dict_Monad_244);
            }, Prelude["<<<"](Prelude.semigroupoidArr)(Control_Monad_Trans.lift(Control_Monad_State_Trans.monadTransStateT)(__dict_Monad_244))(liftEff(__dict_MonadEff_245)));
        };
    };
    var monadEffWriter = function (__dict_Monad_246) {
        return function (__dict_Monoid_247) {
            return function (__dict_MonadEff_248) {
                return new MonadEff(function () {
                    return Control_Monad_Writer_Trans.monadWriterT(__dict_Monoid_247)(__dict_Monad_246);
                }, Prelude["<<<"](Prelude.semigroupoidArr)(Control_Monad_Trans.lift(Control_Monad_Writer_Trans.monadTransWriterT(__dict_Monoid_247))(__dict_Monad_246))(liftEff(__dict_MonadEff_248)));
            };
        };
    };
    return {
        MonadEff: MonadEff, 
        liftEff: liftEff, 
        monadEffEff: monadEffEff, 
        monadEffMaybe: monadEffMaybe, 
        monadEffError: monadEffError, 
        monadEffState: monadEffState, 
        monadEffWriter: monadEffWriter, 
        monadEffReader: monadEffReader, 
        monadEffRWS: monadEffRWS
    };
})();
var PS = PS || {};
PS.Control_Monad_Error_Class = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Error_Trans = PS.Control_Monad_Error_Trans;
    var Control_Monad_Trans = PS.Control_Monad_Trans;
    var Control_Monad_Maybe_Trans = PS.Control_Monad_Maybe_Trans;
    var Control_Monad_Reader_Trans = PS.Control_Monad_Reader_Trans;
    var Control_Monad_Writer_Trans = PS.Control_Monad_Writer_Trans;
    var Control_Monad_State_Trans = PS.Control_Monad_State_Trans;
    var Control_Monad_Error = PS.Control_Monad_Error;
    var Data_Either = PS.Data_Either;
    var Data_Monoid = PS.Data_Monoid;
    var MonadError = function (catchError, throwError) {
        this.catchError = catchError;
        this.throwError = throwError;
    };
    var throwError = function (dict) {
        return dict.throwError;
    };
    var monadErrorErrorT = function (__dict_Monad_249) {
        return new MonadError(function (m) {
            return function (h) {
                return Control_Monad_Error_Trans.ErrorT(Prelude[">>="](__dict_Monad_249["__superclass_Prelude.Bind_1"]())(Control_Monad_Error_Trans.runErrorT(m))(function (_20) {
                    if (_20 instanceof Data_Either.Left) {
                        return Control_Monad_Error_Trans.runErrorT(h(_20.value0));
                    };
                    if (_20 instanceof Data_Either.Right) {
                        return Prelude["return"](__dict_Monad_249)(new Data_Either.Right(_20.value0));
                    };
                    throw new Error("Failed pattern match");
                }));
            };
        }, function (e) {
            return Control_Monad_Error_Trans.ErrorT(Prelude["return"](__dict_Monad_249)(new Data_Either.Left(e)));
        });
    };
    var monadErrorError = new MonadError(function (_293) {
        return function (_294) {
            if (_293 instanceof Data_Either.Left) {
                return _294(_293.value0);
            };
            if (_293 instanceof Data_Either.Right) {
                return new Data_Either.Right(_293.value0);
            };
            throw new Error("Failed pattern match");
        };
    }, Data_Either.Left.create);
    var catchError = function (dict) {
        return dict.catchError;
    };
    var monadErrorMaybeT = function (__dict_Monad_250) {
        return function (__dict_MonadError_251) {
            return new MonadError(Control_Monad_Maybe_Trans.liftCatchMaybe(catchError(__dict_MonadError_251)), function (e) {
                return Control_Monad_Trans.lift(Control_Monad_Maybe_Trans.monadTransMaybeT)(__dict_Monad_250)(throwError(__dict_MonadError_251)(e));
            });
        };
    };
    var monadErrorReaderT = function (__dict_Monad_252) {
        return function (__dict_MonadError_253) {
            return new MonadError(Control_Monad_Reader_Trans.liftCatchReader(catchError(__dict_MonadError_253)), function (e) {
                return Control_Monad_Trans.lift(Control_Monad_Reader_Trans.monadTransReaderT)(__dict_Monad_252)(throwError(__dict_MonadError_253)(e));
            });
        };
    };
    var monadErrorStateT = function (__dict_Monad_254) {
        return function (__dict_MonadError_255) {
            return new MonadError(Control_Monad_State_Trans.liftCatchState(catchError(__dict_MonadError_255)), function (e) {
                return Control_Monad_Trans.lift(Control_Monad_State_Trans.monadTransStateT)(__dict_Monad_254)(throwError(__dict_MonadError_255)(e));
            });
        };
    };
    var monadErrorWriterT = function (__dict_Monad_256) {
        return function (__dict_Monoid_257) {
            return function (__dict_MonadError_258) {
                return new MonadError(Control_Monad_Writer_Trans.liftCatchWriter(catchError(__dict_MonadError_258)), function (e) {
                    return Control_Monad_Trans.lift(Control_Monad_Writer_Trans.monadTransWriterT(__dict_Monoid_257))(__dict_Monad_256)(throwError(__dict_MonadError_258)(e));
                });
            };
        };
    };
    return {
        MonadError: MonadError, 
        catchError: catchError, 
        throwError: throwError, 
        monadErrorError: monadErrorError, 
        monadErrorErrorT: monadErrorErrorT, 
        monadErrorMaybeT: monadErrorMaybeT, 
        monadErrorReaderT: monadErrorReaderT, 
        monadErrorWriterT: monadErrorWriterT, 
        monadErrorStateT: monadErrorStateT
    };
})();
var PS = PS || {};
PS.Data_Tuple_Nested = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Tuple = PS.Data_Tuple;
    var $div$bslash = function (a) {
        return function (b) {
            return new Data_Tuple.Tuple(a, b);
        };
    };
    var con9 = function (f) {
        return function (_302) {
            return f(_302.value0)(_302.value1.value0)(_302.value1.value1.value0)(_302.value1.value1.value1.value0)(_302.value1.value1.value1.value1.value0)(_302.value1.value1.value1.value1.value1.value0)(_302.value1.value1.value1.value1.value1.value1.value0)(_302.value1.value1.value1.value1.value1.value1.value1.value0)(_302.value1.value1.value1.value1.value1.value1.value1.value1);
        };
    };
    var con8 = function (f) {
        return function (_301) {
            return f(_301.value0)(_301.value1.value0)(_301.value1.value1.value0)(_301.value1.value1.value1.value0)(_301.value1.value1.value1.value1.value0)(_301.value1.value1.value1.value1.value1.value0)(_301.value1.value1.value1.value1.value1.value1.value0)(_301.value1.value1.value1.value1.value1.value1.value1);
        };
    };
    var con7 = function (f) {
        return function (_300) {
            return f(_300.value0)(_300.value1.value0)(_300.value1.value1.value0)(_300.value1.value1.value1.value0)(_300.value1.value1.value1.value1.value0)(_300.value1.value1.value1.value1.value1.value0)(_300.value1.value1.value1.value1.value1.value1);
        };
    };
    var con6 = function (f) {
        return function (_299) {
            return f(_299.value0)(_299.value1.value0)(_299.value1.value1.value0)(_299.value1.value1.value1.value0)(_299.value1.value1.value1.value1.value0)(_299.value1.value1.value1.value1.value1);
        };
    };
    var con5 = function (f) {
        return function (_298) {
            return f(_298.value0)(_298.value1.value0)(_298.value1.value1.value0)(_298.value1.value1.value1.value0)(_298.value1.value1.value1.value1);
        };
    };
    var con4 = function (f) {
        return function (_297) {
            return f(_297.value0)(_297.value1.value0)(_297.value1.value1.value0)(_297.value1.value1.value1);
        };
    };
    var con3 = function (f) {
        return function (_296) {
            return f(_296.value0)(_296.value1.value0)(_296.value1.value1);
        };
    };
    var con2 = function (f) {
        return function (_295) {
            return f(_295.value0)(_295.value1);
        };
    };
    var con10 = function (f) {
        return function (_303) {
            return f(_303.value0)(_303.value1.value0)(_303.value1.value1.value0)(_303.value1.value1.value1.value0)(_303.value1.value1.value1.value1.value0)(_303.value1.value1.value1.value1.value1.value0)(_303.value1.value1.value1.value1.value1.value1.value0)(_303.value1.value1.value1.value1.value1.value1.value1.value0)(_303.value1.value1.value1.value1.value1.value1.value1.value1.value0)(_303.value1.value1.value1.value1.value1.value1.value1.value1.value1);
        };
    };
    return {
        "/\\": $div$bslash, 
        con10: con10, 
        con9: con9, 
        con8: con8, 
        con7: con7, 
        con6: con6, 
        con5: con5, 
        con4: con4, 
        con3: con3, 
        con2: con2
    };
})();
var PS = PS || {};
PS.Data_Monoid_First = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Extend = PS.Control_Extend;
    var Control_Comonad = PS.Control_Comonad;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Monoid = PS.Data_Monoid;
    
    /**
     *  | Monoid returning the first (left-most) non-Nothing value.
     *  |
     *  | ``` purescript
     *  | First (Just x) <> First (Just y) == First (Just x)
     *  | First Nothing <> First (Just y) == First (Just x)
     *  | First Nothing <> Nothing == First Nothing
     *  | mempty :: First _ == First Nothing
     *  | ```
     */
    var First = function (x) {
        return x;
    };
    var showFirst = function (__dict_Show_259) {
        return new Prelude.Show(function (_317) {
            return "First (" + (Prelude.show(Data_Maybe.showMaybe(__dict_Show_259))(_317) + ")");
        });
    };
    var semigroupFirst = new Prelude.Semigroup(function (_318) {
        return function (_319) {
            if (_318 instanceof Data_Maybe.Just) {
                return _318;
            };
            return _319;
        };
    });
    var runFirst = function (_304) {
        return _304;
    };
    var monoidFirst = new Data_Monoid.Monoid(function () {
        return semigroupFirst;
    }, Data_Maybe.Nothing.value);
    var functorFirst = new Prelude.Functor(function (_311) {
        return function (_312) {
            return Prelude["<$>"](Data_Maybe.functorMaybe)(_311)(_312);
        };
    });
    var extendFirst = new Control_Extend.Extend(function (f) {
        return function (x) {
            return Control_Extend["<<="](extendFirst)(f)(x);
        };
    }, function () {
        return functorFirst;
    });
    var eqFirst = function (__dict_Eq_261) {
        return new Prelude.Eq(function (_307) {
            return function (_308) {
                return Prelude["/="](Data_Maybe.eqMaybe(__dict_Eq_261))(_307)(_308);
            };
        }, function (_305) {
            return function (_306) {
                return Prelude["=="](Data_Maybe.eqMaybe(__dict_Eq_261))(_305)(_306);
            };
        });
    };
    var ordFirst = function (__dict_Ord_260) {
        return new Prelude.Ord(function () {
            return eqFirst(__dict_Ord_260["__superclass_Prelude.Eq_0"]());
        }, function (_309) {
            return function (_310) {
                return Prelude.compare(Data_Maybe.ordMaybe(__dict_Ord_260))(_309)(_310);
            };
        });
    };
    var applyFirst = new Prelude.Apply(function (_313) {
        return function (_314) {
            return Prelude["<*>"](Data_Maybe.applyMaybe)(_313)(_314);
        };
    }, function () {
        return functorFirst;
    });
    var bindFirst = new Prelude.Bind(function (_315) {
        return function (_316) {
            return Prelude[">>="](Data_Maybe.bindMaybe)(_315)(Prelude["<<<"](Prelude.semigroupoidArr)(runFirst)(_316));
        };
    }, function () {
        return applyFirst;
    });
    var applicativeFirst = new Prelude.Applicative(function () {
        return applyFirst;
    }, Prelude["<<<"](Prelude.semigroupoidArr)(First)(Prelude.pure(Data_Maybe.applicativeMaybe)));
    var monadFirst = new Prelude.Monad(function () {
        return applicativeFirst;
    }, function () {
        return bindFirst;
    });
    return {
        First: First, 
        runFirst: runFirst, 
        eqFirst: eqFirst, 
        ordFirst: ordFirst, 
        functorFirst: functorFirst, 
        applyFirst: applyFirst, 
        applicativeFirst: applicativeFirst, 
        bindFirst: bindFirst, 
        monadFirst: monadFirst, 
        extendFirst: extendFirst, 
        showFirst: showFirst, 
        semigroupFirst: semigroupFirst, 
        monoidFirst: monoidFirst
    };
})();
var PS = PS || {};
PS.Data_Monoid_Last = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Extend = PS.Control_Extend;
    var Control_Comonad = PS.Control_Comonad;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Monoid = PS.Data_Monoid;
    
    /**
     *  | Monoid returning the last (right-most) non-Nothing value.
     *  |
     *  | ``` purescript
     *  | Last (Just x) <> Last (Just y) == Last (Just y)
     *  | Last (Just x) <> Nothing == Last (Just x)
     *  | Last Nothing <> Nothing == Last Nothing
     *  | mempty :: Last _ == Last Nothing
     *  | ```
     */
    var Last = function (x) {
        return x;
    };
    var showLast = function (__dict_Show_262) {
        return new Prelude.Show(function (_333) {
            return "Last (" + (Prelude.show(Data_Maybe.showMaybe(__dict_Show_262))(_333) + ")");
        });
    };
    var semigroupLast = new Prelude.Semigroup(function (_334) {
        return function (_335) {
            if (_335 instanceof Data_Maybe.Just) {
                return _335;
            };
            if (_335 instanceof Data_Maybe.Nothing) {
                return _334;
            };
            throw new Error("Failed pattern match");
        };
    });
    var runLast = function (_320) {
        return _320;
    };
    var monoidLast = new Data_Monoid.Monoid(function () {
        return semigroupLast;
    }, Data_Maybe.Nothing.value);
    var functorLast = new Prelude.Functor(function (_327) {
        return function (_328) {
            return Prelude["<$>"](Data_Maybe.functorMaybe)(_327)(_328);
        };
    });
    var extendLast = new Control_Extend.Extend(function (f) {
        return function (x) {
            return Control_Extend["<<="](extendLast)(f)(x);
        };
    }, function () {
        return functorLast;
    });
    var eqLast = function (__dict_Eq_264) {
        return new Prelude.Eq(function (_323) {
            return function (_324) {
                return Prelude["/="](Data_Maybe.eqMaybe(__dict_Eq_264))(_323)(_324);
            };
        }, function (_321) {
            return function (_322) {
                return Prelude["=="](Data_Maybe.eqMaybe(__dict_Eq_264))(_321)(_322);
            };
        });
    };
    var ordLast = function (__dict_Ord_263) {
        return new Prelude.Ord(function () {
            return eqLast(__dict_Ord_263["__superclass_Prelude.Eq_0"]());
        }, function (_325) {
            return function (_326) {
                return Prelude.compare(Data_Maybe.ordMaybe(__dict_Ord_263))(_325)(_326);
            };
        });
    };
    var applyLast = new Prelude.Apply(function (_329) {
        return function (_330) {
            return Prelude["<*>"](Data_Maybe.applyMaybe)(_329)(_330);
        };
    }, function () {
        return functorLast;
    });
    var bindLast = new Prelude.Bind(function (_331) {
        return function (_332) {
            return Prelude[">>="](Data_Maybe.bindMaybe)(_331)(Prelude["<<<"](Prelude.semigroupoidArr)(runLast)(_332));
        };
    }, function () {
        return applyLast;
    });
    var applicativeLast = new Prelude.Applicative(function () {
        return applyLast;
    }, Prelude["<<<"](Prelude.semigroupoidArr)(Last)(Prelude.pure(Data_Maybe.applicativeMaybe)));
    var monadLast = new Prelude.Monad(function () {
        return applicativeLast;
    }, function () {
        return bindLast;
    });
    return {
        Last: Last, 
        runLast: runLast, 
        eqLast: eqLast, 
        ordLast: ordLast, 
        functorLast: functorLast, 
        applyLast: applyLast, 
        applicativeLast: applicativeLast, 
        bindLast: bindLast, 
        monadLast: monadLast, 
        extendLast: extendLast, 
        showLast: showLast, 
        semigroupLast: semigroupLast, 
        monoidLast: monoidLast
    };
})();
var PS = PS || {};
PS.Data_Foldable = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Monoid = PS.Data_Monoid;
    var Control_Apply = PS.Control_Apply;
    var Data_Monoid_First = PS.Data_Monoid_First;
    var Data_Either = PS.Data_Either;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Monoid_Additive = PS.Data_Monoid_Additive;
    var Data_Monoid_Dual = PS.Data_Monoid_Dual;
    var Data_Monoid_Last = PS.Data_Monoid_Last;
    var Data_Monoid_Multiplicative = PS.Data_Monoid_Multiplicative;
    var Data_Tuple = PS.Data_Tuple;
    
  function foldrArray(f) {
    return function(z) {
      return function(xs) {
        var acc = z;
        for (var i = xs.length - 1; i >= 0; --i) {
          acc = f(xs[i])(acc);
        }
        return acc;
      };
    };
  }
  ;
    
  function foldlArray(f) {
    return function(z) {
      return function(xs) {
        var acc = z;
        for (var i = 0, len = xs.length; i < len; ++i) {
          acc = f(acc)(xs[i]);
        }
        return acc;
      };
    };
  }
  ;
    var Foldable = function (foldMap, foldl, foldr) {
        this.foldMap = foldMap;
        this.foldl = foldl;
        this.foldr = foldr;
    };
    var foldr = function (dict) {
        return dict.foldr;
    };
    var traverse_ = function (__dict_Applicative_265) {
        return function (__dict_Foldable_266) {
            return function (f) {
                return foldr(__dict_Foldable_266)(Prelude["<<<"](Prelude.semigroupoidArr)(Control_Apply["*>"](__dict_Applicative_265["__superclass_Prelude.Apply_0"]()))(f))(Prelude.pure(__dict_Applicative_265)(Prelude.unit));
            };
        };
    };
    var for_ = function (__dict_Applicative_267) {
        return function (__dict_Foldable_268) {
            return Prelude.flip(traverse_(__dict_Applicative_267)(__dict_Foldable_268));
        };
    };
    var sequence_ = function (__dict_Applicative_269) {
        return function (__dict_Foldable_270) {
            return traverse_(__dict_Applicative_269)(__dict_Foldable_270)(Prelude.id(Prelude.categoryArr));
        };
    };
    var foldl = function (dict) {
        return dict.foldl;
    };
    var intercalate = function (__dict_Foldable_271) {
        return function (__dict_Monoid_272) {
            return function (sep) {
                return function (xs) {
                    var go = function (_401) {
                        return function (_402) {
                            if (_401.init) {
                                return {
                                    init: false, 
                                    acc: _402
                                };
                            };
                            return {
                                init: false, 
                                acc: Prelude["<>"](__dict_Monoid_272["__superclass_Prelude.Semigroup_0"]())(_401.acc)(Prelude["<>"](__dict_Monoid_272["__superclass_Prelude.Semigroup_0"]())(sep)(_402))
                            };
                        };
                    };
                    return (foldl(__dict_Foldable_271)(go)({
                        init: true, 
                        acc: Data_Monoid.mempty(__dict_Monoid_272)
                    })(xs)).acc;
                };
            };
        };
    };
    var mconcat = function (__dict_Foldable_273) {
        return function (__dict_Monoid_274) {
            return foldl(__dict_Foldable_273)(Prelude["<>"](__dict_Monoid_274["__superclass_Prelude.Semigroup_0"]()))(Data_Monoid.mempty(__dict_Monoid_274));
        };
    };
    var or = function (__dict_Foldable_275) {
        return foldl(__dict_Foldable_275)(Prelude["||"](Prelude.boolLikeBoolean))(false);
    };
    var product = function (__dict_Foldable_276) {
        return foldl(__dict_Foldable_276)(Prelude["*"](Prelude.semiringNumber))(1);
    };
    var sum = function (__dict_Foldable_277) {
        return foldl(__dict_Foldable_277)(Prelude["+"](Prelude.semiringNumber))(0);
    };
    var foldableTuple = new Foldable(function (__dict_Monoid_278) {
        return function (_359) {
            return function (_360) {
                return _359(_360.value1);
            };
        };
    }, function (_356) {
        return function (_357) {
            return function (_358) {
                return _356(_357)(_358.value1);
            };
        };
    }, function (_353) {
        return function (_354) {
            return function (_355) {
                return _353(_355.value1)(_354);
            };
        };
    });
    var foldableMultiplicative = new Foldable(function (__dict_Monoid_279) {
        return function (_399) {
            return function (_400) {
                return _399(_400);
            };
        };
    }, function (_396) {
        return function (_397) {
            return function (_398) {
                return _396(_397)(_398);
            };
        };
    }, function (_393) {
        return function (_394) {
            return function (_395) {
                return _393(_395)(_394);
            };
        };
    });
    var foldableMaybe = new Foldable(function (__dict_Monoid_280) {
        return function (_351) {
            return function (_352) {
                if (_352 instanceof Data_Maybe.Nothing) {
                    return Data_Monoid.mempty(__dict_Monoid_280);
                };
                if (_352 instanceof Data_Maybe.Just) {
                    return _351(_352.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    }, function (_348) {
        return function (_349) {
            return function (_350) {
                if (_350 instanceof Data_Maybe.Nothing) {
                    return _349;
                };
                if (_350 instanceof Data_Maybe.Just) {
                    return _348(_349)(_350.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    }, function (_345) {
        return function (_346) {
            return function (_347) {
                if (_347 instanceof Data_Maybe.Nothing) {
                    return _346;
                };
                if (_347 instanceof Data_Maybe.Just) {
                    return _345(_347.value0)(_346);
                };
                throw new Error("Failed pattern match");
            };
        };
    });
    var foldableEither = new Foldable(function (__dict_Monoid_281) {
        return function (_343) {
            return function (_344) {
                if (_344 instanceof Data_Either.Left) {
                    return Data_Monoid.mempty(__dict_Monoid_281);
                };
                if (_344 instanceof Data_Either.Right) {
                    return _343(_344.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    }, function (_340) {
        return function (_341) {
            return function (_342) {
                if (_342 instanceof Data_Either.Left) {
                    return _341;
                };
                if (_342 instanceof Data_Either.Right) {
                    return _340(_341)(_342.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    }, function (_337) {
        return function (_338) {
            return function (_339) {
                if (_339 instanceof Data_Either.Left) {
                    return _338;
                };
                if (_339 instanceof Data_Either.Right) {
                    return _337(_339.value0)(_338);
                };
                throw new Error("Failed pattern match");
            };
        };
    });
    var foldableDual = new Foldable(function (__dict_Monoid_282) {
        return function (_375) {
            return function (_376) {
                return _375(_376);
            };
        };
    }, function (_372) {
        return function (_373) {
            return function (_374) {
                return _372(_373)(_374);
            };
        };
    }, function (_369) {
        return function (_370) {
            return function (_371) {
                return _369(_371)(_370);
            };
        };
    });
    var foldableArray = new Foldable(function (__dict_Monoid_283) {
        return function (f) {
            return function (xs) {
                return foldr(foldableArray)(function (x) {
                    return function (acc) {
                        return Prelude["<>"](__dict_Monoid_283["__superclass_Prelude.Semigroup_0"]())(f(x))(acc);
                    };
                })(Data_Monoid.mempty(__dict_Monoid_283))(xs);
            };
        };
    }, function (f) {
        return function (z) {
            return function (xs) {
                return foldlArray(f)(z)(xs);
            };
        };
    }, function (f) {
        return function (z) {
            return function (xs) {
                return foldrArray(f)(z)(xs);
            };
        };
    });
    var foldableAdditive = new Foldable(function (__dict_Monoid_284) {
        return function (_367) {
            return function (_368) {
                return _367(_368);
            };
        };
    }, function (_364) {
        return function (_365) {
            return function (_366) {
                return _364(_365)(_366);
            };
        };
    }, function (_361) {
        return function (_362) {
            return function (_363) {
                return _361(_363)(_362);
            };
        };
    });
    var foldMap = function (dict) {
        return dict.foldMap;
    };
    var foldableFirst = new Foldable(function (__dict_Monoid_285) {
        return function (_383) {
            return function (_384) {
                return foldMap(foldableMaybe)(__dict_Monoid_285)(_383)(_384);
            };
        };
    }, function (_380) {
        return function (_381) {
            return function (_382) {
                return foldl(foldableMaybe)(_380)(_381)(_382);
            };
        };
    }, function (_377) {
        return function (_378) {
            return function (_379) {
                return foldr(foldableMaybe)(_377)(_378)(_379);
            };
        };
    });
    var foldableLast = new Foldable(function (__dict_Monoid_286) {
        return function (_391) {
            return function (_392) {
                return foldMap(foldableMaybe)(__dict_Monoid_286)(_391)(_392);
            };
        };
    }, function (_388) {
        return function (_389) {
            return function (_390) {
                return foldl(foldableMaybe)(_388)(_389)(_390);
            };
        };
    }, function (_385) {
        return function (_386) {
            return function (_387) {
                return foldr(foldableMaybe)(_385)(_386)(_387);
            };
        };
    });
    var lookup = function (__dict_Eq_287) {
        return function (__dict_Foldable_288) {
            return function (a) {
                return function (f) {
                    return Data_Monoid_First.runFirst(foldMap(__dict_Foldable_288)(Data_Monoid_First.monoidFirst)(function (_336) {
                        var _1175 = Prelude["=="](__dict_Eq_287)(a)(_336.value0);
                        if (_1175) {
                            return new Data_Maybe.Just(_336.value1);
                        };
                        if (!_1175) {
                            return Data_Maybe.Nothing.value;
                        };
                        throw new Error("Failed pattern match");
                    })(f));
                };
            };
        };
    };
    var fold = function (__dict_Foldable_289) {
        return function (__dict_Monoid_290) {
            return foldMap(__dict_Foldable_289)(__dict_Monoid_290)(Prelude.id(Prelude.categoryArr));
        };
    };
    var find = function (__dict_Foldable_291) {
        return function (p) {
            return function (f) {
                var _1179 = foldMap(__dict_Foldable_291)(Data_Monoid.monoidArray)(function (x) {
                    var _1178 = p(x);
                    if (_1178) {
                        return [ x ];
                    };
                    if (!_1178) {
                        return [  ];
                    };
                    throw new Error("Failed pattern match");
                })(f);
                if (_1179.length >= 1) {
                    var _1181 = _1179.slice(1);
                    return new Data_Maybe.Just(_1179[0]);
                };
                if (_1179.length === 0) {
                    return Data_Maybe.Nothing.value;
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    var any = function (__dict_Foldable_292) {
        return function (p) {
            return Prelude["<<<"](Prelude.semigroupoidArr)(or(foldableArray))(foldMap(__dict_Foldable_292)(Data_Monoid.monoidArray)(function (x) {
                return [ p(x) ];
            }));
        };
    };
    var elem = function (__dict_Eq_293) {
        return function (__dict_Foldable_294) {
            return Prelude["<<<"](Prelude.semigroupoidArr)(any(__dict_Foldable_294))(Prelude["=="](__dict_Eq_293));
        };
    };
    var notElem = function (__dict_Eq_295) {
        return function (__dict_Foldable_296) {
            return function (x) {
                return Prelude["<<<"](Prelude.semigroupoidArr)(Prelude.not(Prelude.boolLikeBoolean))(elem(__dict_Eq_295)(__dict_Foldable_296)(x));
            };
        };
    };
    var and = function (__dict_Foldable_297) {
        return foldl(__dict_Foldable_297)(Prelude["&&"](Prelude.boolLikeBoolean))(true);
    };
    var all = function (__dict_Foldable_298) {
        return function (p) {
            return Prelude["<<<"](Prelude.semigroupoidArr)(and(foldableArray))(foldMap(__dict_Foldable_298)(Data_Monoid.monoidArray)(function (x) {
                return [ p(x) ];
            }));
        };
    };
    return {
        Foldable: Foldable, 
        foldlArray: foldlArray, 
        foldrArray: foldrArray, 
        lookup: lookup, 
        find: find, 
        notElem: notElem, 
        elem: elem, 
        product: product, 
        sum: sum, 
        all: all, 
        any: any, 
        or: or, 
        and: and, 
        intercalate: intercalate, 
        mconcat: mconcat, 
        sequence_: sequence_, 
        for_: for_, 
        traverse_: traverse_, 
        fold: fold, 
        foldMap: foldMap, 
        foldl: foldl, 
        foldr: foldr, 
        foldableArray: foldableArray, 
        foldableEither: foldableEither, 
        foldableMaybe: foldableMaybe, 
        foldableTuple: foldableTuple, 
        foldableAdditive: foldableAdditive, 
        foldableDual: foldableDual, 
        foldableFirst: foldableFirst, 
        foldableLast: foldableLast, 
        foldableMultiplicative: foldableMultiplicative
    };
})();
var PS = PS || {};
PS.Data_String = (function () {
    "use strict";
    var Data_Function = PS.Data_Function;
    var Data_Char = PS.Data_Char;
    var Prelude = PS.Prelude;
    var Data_String_Unsafe = PS.Data_String_Unsafe;
    var Data_Maybe = PS.Data_Maybe;
    
    function _charAt(i, s, Just, Nothing) {
      return i >= 0 && i < s.length ? Just(s.charAt(i)) : Nothing;
    }
    ;
    
    function _charCodeAt(i, s, Just, Nothing) {
      return i >= 0 && i < s.length ? Just(s.charCodeAt(i)) : Nothing;
    }
    ;
    
    function fromCharArray(a) {
      return a.join('');
    }
    ;
    
    function indexOf(x) {
      return function(s) {
        return s.indexOf(x);
      };
    }
    ;
    
    function indexOf$prime(x) {
      return function(startAt) {
        return function(s) {
          return s.indexOf(x, startAt);
        };
      };
    }
    ;
    
    function lastIndexOf(x) {
      return function(s) {
        return s.lastIndexOf(x);
      };
    }
    ;
    
    function lastIndexOf$prime(x) {
      return function(startAt) {
        return function(s) {
          return s.lastIndexOf(x, startAt);
        };
      };
    }
    ;
    
    function length(s) {
      return s.length;
    }
    ;
    
    function localeCompare(s1) {
      return function(s2) {
        return s1.localeCompare(s2);
      };
    }
    ;
    
    function replace(s1) {
      return function(s2) {
        return function(s3) {
          return s3.replace(s1, s2);
        };
      };
    }
    ;
    
    function take(n) {
      return function(s) {
        return s.substr(0, n);
      };
    }
    ;
    
    function drop(n) {
      return function(s) {
        return s.substr(n);
      };
    }
    ;
    
    function count(p){      
      return function(s){
        var i;
        for(i = 0; i < s.length && p(s.charAt(i)); i++){};
        return i;
      };      
    }
    ;
    
    function split(sep) {
      return function(s) {
        return s.split(sep);
      };
    }
    ;
    
    function toCharArray(s) {
      return s.split('');
    }
    ;
    
    function toLower(s) {
      return s.toLowerCase();
    }
    ;
    
    function toUpper(s) {
      return s.toUpperCase();
    }
    ;
    
    function trim(s) {
      return s.trim();
    }
    ;
    
    function joinWith(s) {
      return function(xs) {
        return xs.join(s);
      };
    }
    ;
    var takeWhile = function (p) {
        return function (s) {
            return take(count(p)(s))(s);
        };
    };
    var $$null = function (s) {
        return length(s) === 0;
    };
    var uncons = function (_403) {
        if ($$null(_403)) {
            return Data_Maybe.Nothing.value;
        };
        return new Data_Maybe.Just({
            head: Data_String_Unsafe.charAt(0)(_403), 
            tail: drop(1)(_403)
        });
    };
    var fromChar = Data_Char.charString;
    var singleton = fromChar;
    var dropWhile = function (p) {
        return function (s) {
            return drop(count(p)(s))(s);
        };
    };
    var charCodeAt = function (n) {
        return function (s) {
            return _charCodeAt(n, s, Data_Maybe.Just.create, Data_Maybe.Nothing.value);
        };
    };
    var charAt = function (n) {
        return function (s) {
            return _charAt(n, s, Data_Maybe.Just.create, Data_Maybe.Nothing.value);
        };
    };
    return {
        joinWith: joinWith, 
        trim: trim, 
        toUpper: toUpper, 
        toLower: toLower, 
        toCharArray: toCharArray, 
        split: split, 
        dropWhile: dropWhile, 
        drop: drop, 
        takeWhile: takeWhile, 
        take: take, 
        count: count, 
        replace: replace, 
        localeCompare: localeCompare, 
        singleton: singleton, 
        length: length, 
        uncons: uncons, 
        "null": $$null, 
        "lastIndexOf'": lastIndexOf$prime, 
        lastIndexOf: lastIndexOf, 
        "indexOf'": indexOf$prime, 
        indexOf: indexOf, 
        fromChar: fromChar, 
        fromCharArray: fromCharArray, 
        charCodeAt: charCodeAt, 
        charAt: charAt
    };
})();
var PS = PS || {};
PS.Data_String_Regex = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_String = PS.Data_String;
    var Data_Function = PS.Data_Function;
    var Data_Maybe = PS.Data_Maybe;
    
  function showRegex$prime(r) {
    return '' + r;
  }
  ;
    
  function regex$prime(s1) {
    return function(s2) {
      return new RegExp(s1, s2);
    };
  }
  ;
    
  function source(r) {
    return r.source;
  }
  ;
    
  function flags(r) {
    return {
      multiline: r.multiline,
      ignoreCase: r.ignoreCase,
      global: r.global,
      sticky: !!r.sticky,
      unicode: !!r.unicode
    };
  }
  ;
    
  function test(r) {
    return function(s) {
      return r.test(s);
    };
  }
  ;
    
  function _match(r, s, Just, Nothing) {
    var m = s.match(r);
    return m == null ? Nothing : Just(m);
  }
  ;
    
  function replace(r) {
    return function(s1) {
      return function(s2) {
        return s2.replace(r, s1);
      };
    };
  }
  ;
    
  function replace$prime(r) {
    return function(f) {
      return function(s2) {
        return s2.replace(r, function(match) {
          return f(match)(Array.prototype.splice.call(arguments, 1, arguments.length - 3));
        });
      };
    };
  }
  ;
    
  function search(r) {
    return function(s) {
      return s.search(r);
    };
  }
  ;
    
  function split(r) {
    return function(s) {
      return s.split(r);
    };
  }
  ;
    var showRegex = new Prelude.Show(showRegex$prime);
    var renderFlags = function (flags) {
        return (function () {
            if (flags.global) {
                return "g";
            };
            if (!flags.global) {
                return "";
            };
            throw new Error("Failed pattern match");
        })() + ((function () {
            if (flags.ignoreCase) {
                return "i";
            };
            if (!flags.ignoreCase) {
                return "";
            };
            throw new Error("Failed pattern match");
        })() + ((function () {
            if (flags.multiline) {
                return "m";
            };
            if (!flags.multiline) {
                return "";
            };
            throw new Error("Failed pattern match");
        })() + ((function () {
            if (flags.sticky) {
                return "y";
            };
            if (!flags.sticky) {
                return "";
            };
            throw new Error("Failed pattern match");
        })() + (function () {
            if (flags.unicode) {
                return "u";
            };
            if (!flags.unicode) {
                return "";
            };
            throw new Error("Failed pattern match");
        })())));
    };
    var regex = function (source) {
        return function (flags) {
            return regex$prime(source)(renderFlags(flags));
        };
    };
    var parseFlags = function (s) {
        return {
            global: Data_String.indexOf("g")(s) >= 0, 
            ignoreCase: Data_String.indexOf("i")(s) >= 0, 
            multiline: Data_String.indexOf("m")(s) >= 0, 
            sticky: Data_String.indexOf("y")(s) >= 0, 
            unicode: Data_String.indexOf("u")(s) >= 0
        };
    };
    var noFlags = {
        global: false, 
        ignoreCase: false, 
        multiline: false, 
        sticky: false, 
        unicode: false
    };
    var match = function (r) {
        return function (s) {
            return _match(r, s, Data_Maybe.Just.create, Data_Maybe.Nothing.value);
        };
    };
    return {
        noFlags: noFlags, 
        split: split, 
        search: search, 
        "replace'": replace$prime, 
        replace: replace, 
        match: match, 
        test: test, 
        parseFlags: parseFlags, 
        renderFlags: renderFlags, 
        flags: flags, 
        source: source, 
        regex: regex, 
        showRegex: showRegex
    };
})();
var PS = PS || {};
PS.Data_Traversable = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Array = PS.Data_Array;
    var Data_Tuple = PS.Data_Tuple;
    var Data_Either = PS.Data_Either;
    var Data_Foldable = PS.Data_Foldable;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Monoid_Additive = PS.Data_Monoid_Additive;
    var Data_Monoid_Dual = PS.Data_Monoid_Dual;
    var Data_Monoid_First = PS.Data_Monoid_First;
    var Data_Monoid_Last = PS.Data_Monoid_Last;
    var Data_Monoid_Multiplicative = PS.Data_Monoid_Multiplicative;
    var StateR = function (x) {
        return x;
    };
    var StateL = function (x) {
        return x;
    };
    var Traversable = function (__superclass_Data$dotFoldable$dotFoldable_1, __superclass_Prelude$dotFunctor_0, sequence, traverse) {
        this["__superclass_Data.Foldable.Foldable_1"] = __superclass_Data$dotFoldable$dotFoldable_1;
        this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
        this.sequence = sequence;
        this.traverse = traverse;
    };
    var traverse = function (dict) {
        return dict.traverse;
    };
    var traversableTuple = new Traversable(function () {
        return Data_Foldable.foldableTuple;
    }, function () {
        return Data_Tuple.functorTuple;
    }, function (__dict_Applicative_300) {
        return function (_417) {
            return Prelude["<$>"]((__dict_Applicative_300["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Tuple.Tuple.create(_417.value0))(_417.value1);
        };
    }, function (__dict_Applicative_299) {
        return function (_415) {
            return function (_416) {
                return Prelude["<$>"]((__dict_Applicative_299["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Tuple.Tuple.create(_416.value0))(_415(_416.value1));
            };
        };
    });
    var traversableMultiplicative = new Traversable(function () {
        return Data_Foldable.foldableMultiplicative;
    }, function () {
        return Data_Monoid_Multiplicative.functorMultiplicative;
    }, function (__dict_Applicative_302) {
        return function (_432) {
            return Prelude["<$>"]((__dict_Applicative_302["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Monoid_Multiplicative.Multiplicative)(_432);
        };
    }, function (__dict_Applicative_301) {
        return function (_430) {
            return function (_431) {
                return Prelude["<$>"]((__dict_Applicative_301["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Monoid_Multiplicative.Multiplicative)(_430(_431));
            };
        };
    });
    var traversableMaybe = new Traversable(function () {
        return Data_Foldable.foldableMaybe;
    }, function () {
        return Data_Maybe.functorMaybe;
    }, function (__dict_Applicative_304) {
        return function (_414) {
            if (_414 instanceof Data_Maybe.Nothing) {
                return Prelude.pure(__dict_Applicative_304)(Data_Maybe.Nothing.value);
            };
            if (_414 instanceof Data_Maybe.Just) {
                return Prelude["<$>"]((__dict_Applicative_304["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Maybe.Just.create)(_414.value0);
            };
            throw new Error("Failed pattern match");
        };
    }, function (__dict_Applicative_303) {
        return function (_412) {
            return function (_413) {
                if (_413 instanceof Data_Maybe.Nothing) {
                    return Prelude.pure(__dict_Applicative_303)(Data_Maybe.Nothing.value);
                };
                if (_413 instanceof Data_Maybe.Just) {
                    return Prelude["<$>"]((__dict_Applicative_303["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Maybe.Just.create)(_412(_413.value0));
                };
                throw new Error("Failed pattern match");
            };
        };
    });
    var traversableEither = new Traversable(function () {
        return Data_Foldable.foldableEither;
    }, function () {
        return Data_Either.functorEither;
    }, function (__dict_Applicative_306) {
        return function (_411) {
            if (_411 instanceof Data_Either.Left) {
                return Prelude.pure(__dict_Applicative_306)(new Data_Either.Left(_411.value0));
            };
            if (_411 instanceof Data_Either.Right) {
                return Prelude["<$>"]((__dict_Applicative_306["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Either.Right.create)(_411.value0);
            };
            throw new Error("Failed pattern match");
        };
    }, function (__dict_Applicative_305) {
        return function (_409) {
            return function (_410) {
                if (_410 instanceof Data_Either.Left) {
                    return Prelude.pure(__dict_Applicative_305)(new Data_Either.Left(_410.value0));
                };
                if (_410 instanceof Data_Either.Right) {
                    return Prelude["<$>"]((__dict_Applicative_305["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Either.Right.create)(_409(_410.value0));
                };
                throw new Error("Failed pattern match");
            };
        };
    });
    var traversableDual = new Traversable(function () {
        return Data_Foldable.foldableDual;
    }, function () {
        return Data_Monoid_Dual.functorDual;
    }, function (__dict_Applicative_308) {
        return function (_423) {
            return Prelude["<$>"]((__dict_Applicative_308["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Monoid_Dual.Dual)(_423);
        };
    }, function (__dict_Applicative_307) {
        return function (_421) {
            return function (_422) {
                return Prelude["<$>"]((__dict_Applicative_307["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Monoid_Dual.Dual)(_421(_422));
            };
        };
    });
    var traversableAdditive = new Traversable(function () {
        return Data_Foldable.foldableAdditive;
    }, function () {
        return Data_Monoid_Additive.functorAdditive;
    }, function (__dict_Applicative_310) {
        return function (_420) {
            return Prelude["<$>"]((__dict_Applicative_310["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Monoid_Additive.Additive)(_420);
        };
    }, function (__dict_Applicative_309) {
        return function (_418) {
            return function (_419) {
                return Prelude["<$>"]((__dict_Applicative_309["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Monoid_Additive.Additive)(_418(_419));
            };
        };
    });
    var stateR = function (_405) {
        return _405;
    };
    var stateL = function (_404) {
        return _404;
    };
    var sequence = function (dict) {
        return dict.sequence;
    };
    var traversableArray = new Traversable(function () {
        return Data_Foldable.foldableArray;
    }, function () {
        return Data_Array.functorArray;
    }, function (__dict_Applicative_312) {
        return function (_408) {
            if (_408.length === 0) {
                return Prelude.pure(__dict_Applicative_312)([  ]);
            };
            if (_408.length >= 1) {
                var _1220 = _408.slice(1);
                return Prelude["<*>"](__dict_Applicative_312["__superclass_Prelude.Apply_0"]())(Prelude["<$>"]((__dict_Applicative_312["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Prelude[":"])(_408[0]))(sequence(traversableArray)(__dict_Applicative_312)(_1220));
            };
            throw new Error("Failed pattern match");
        };
    }, function (__dict_Applicative_311) {
        return function (_406) {
            return function (_407) {
                if (_407.length === 0) {
                    return Prelude.pure(__dict_Applicative_311)([  ]);
                };
                if (_407.length >= 1) {
                    var _1224 = _407.slice(1);
                    return Prelude["<*>"](__dict_Applicative_311["__superclass_Prelude.Apply_0"]())(Prelude["<$>"]((__dict_Applicative_311["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Prelude[":"])(_406(_407[0])))(traverse(traversableArray)(__dict_Applicative_311)(_406)(_1224));
                };
                throw new Error("Failed pattern match");
            };
        };
    });
    var traversableFirst = new Traversable(function () {
        return Data_Foldable.foldableFirst;
    }, function () {
        return Data_Monoid_First.functorFirst;
    }, function (__dict_Applicative_314) {
        return function (_426) {
            return Prelude["<$>"]((__dict_Applicative_314["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Monoid_First.First)(sequence(traversableMaybe)(__dict_Applicative_314)(_426));
        };
    }, function (__dict_Applicative_313) {
        return function (_424) {
            return function (_425) {
                return Prelude["<$>"]((__dict_Applicative_313["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Monoid_First.First)(traverse(traversableMaybe)(__dict_Applicative_313)(_424)(_425));
            };
        };
    });
    var traversableLast = new Traversable(function () {
        return Data_Foldable.foldableLast;
    }, function () {
        return Data_Monoid_Last.functorLast;
    }, function (__dict_Applicative_316) {
        return function (_429) {
            return Prelude["<$>"]((__dict_Applicative_316["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Monoid_Last.Last)(sequence(traversableMaybe)(__dict_Applicative_316)(_429));
        };
    }, function (__dict_Applicative_315) {
        return function (_427) {
            return function (_428) {
                return Prelude["<$>"]((__dict_Applicative_315["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Monoid_Last.Last)(traverse(traversableMaybe)(__dict_Applicative_315)(_427)(_428));
            };
        };
    });
    var zipWithA = function (__dict_Applicative_317) {
        return function (f) {
            return function (xs) {
                return function (ys) {
                    return sequence(traversableArray)(__dict_Applicative_317)(Data_Array.zipWith(f)(xs)(ys));
                };
            };
        };
    };
    var functorStateR = new Prelude.Functor(function (f) {
        return function (k) {
            return StateR(function (s) {
                var _1231 = stateR(k)(s);
                return new Data_Tuple.Tuple(_1231.value0, f(_1231.value1));
            });
        };
    });
    var functorStateL = new Prelude.Functor(function (f) {
        return function (k) {
            return StateL(function (s) {
                var _1234 = stateL(k)(s);
                return new Data_Tuple.Tuple(_1234.value0, f(_1234.value1));
            });
        };
    });
    var $$for = function (__dict_Applicative_322) {
        return function (__dict_Traversable_323) {
            return function (x) {
                return function (f) {
                    return traverse(__dict_Traversable_323)(__dict_Applicative_322)(f)(x);
                };
            };
        };
    };
    var applyStateR = new Prelude.Apply(function (f) {
        return function (x) {
            return StateR(function (s) {
                var _1237 = stateR(x)(s);
                var _1238 = stateR(f)(_1237.value0);
                return new Data_Tuple.Tuple(_1238.value0, _1238.value1(_1237.value1));
            });
        };
    }, function () {
        return functorStateR;
    });
    var applyStateL = new Prelude.Apply(function (f) {
        return function (x) {
            return StateL(function (s) {
                var _1243 = stateL(f)(s);
                var _1244 = stateL(x)(_1243.value0);
                return new Data_Tuple.Tuple(_1244.value0, _1243.value1(_1244.value1));
            });
        };
    }, function () {
        return functorStateL;
    });
    var applicativeStateR = new Prelude.Applicative(function () {
        return applyStateR;
    }, function (a) {
        return StateR(function (s) {
            return new Data_Tuple.Tuple(s, a);
        });
    });
    var mapAccumR = function (__dict_Traversable_318) {
        return function (f) {
            return function (s0) {
                return function (xs) {
                    return stateR(traverse(__dict_Traversable_318)(applicativeStateR)(function (a) {
                        return StateR(function (s) {
                            return f(s)(a);
                        });
                    })(xs))(s0);
                };
            };
        };
    };
    var scanr = function (__dict_Traversable_319) {
        return function (f) {
            return function (b0) {
                return function (xs) {
                    return Data_Tuple.snd(mapAccumR(__dict_Traversable_319)(function (b) {
                        return function (a) {
                            var b$prime = f(a)(b);
                            return new Data_Tuple.Tuple(b$prime, b$prime);
                        };
                    })(b0)(xs));
                };
            };
        };
    };
    var applicativeStateL = new Prelude.Applicative(function () {
        return applyStateL;
    }, function (a) {
        return StateL(function (s) {
            return new Data_Tuple.Tuple(s, a);
        });
    });
    var mapAccumL = function (__dict_Traversable_320) {
        return function (f) {
            return function (s0) {
                return function (xs) {
                    return stateL(traverse(__dict_Traversable_320)(applicativeStateL)(function (a) {
                        return StateL(function (s) {
                            return f(s)(a);
                        });
                    })(xs))(s0);
                };
            };
        };
    };
    var scanl = function (__dict_Traversable_321) {
        return function (f) {
            return function (b0) {
                return function (xs) {
                    return Data_Tuple.snd(mapAccumL(__dict_Traversable_321)(function (b) {
                        return function (a) {
                            var b$prime = f(b)(a);
                            return new Data_Tuple.Tuple(b$prime, b$prime);
                        };
                    })(b0)(xs));
                };
            };
        };
    };
    return {
        Traversable: Traversable, 
        mapAccumR: mapAccumR, 
        mapAccumL: mapAccumL, 
        scanr: scanr, 
        scanl: scanl, 
        zipWithA: zipWithA, 
        "for": $$for, 
        sequence: sequence, 
        traverse: traverse, 
        traversableArray: traversableArray, 
        traversableEither: traversableEither, 
        traversableMaybe: traversableMaybe, 
        traversableTuple: traversableTuple, 
        traversableAdditive: traversableAdditive, 
        traversableDual: traversableDual, 
        traversableFirst: traversableFirst, 
        traversableLast: traversableLast, 
        traversableMultiplicative: traversableMultiplicative
    };
})();
var PS = PS || {};
PS.Data_Identity = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Comonad = PS.Control_Comonad;
    var Control_Extend = PS.Control_Extend;
    var Data_Foldable = PS.Data_Foldable;
    var Data_Traversable = PS.Data_Traversable;
    var Identity = function (x) {
        return x;
    };
    var showConst = function (__dict_Show_326) {
        return new Prelude.Show(function (_438) {
            return "Identity (" + (Prelude.show(__dict_Show_326)(_438) + ")");
        });
    };
    var runIdentity = function (_433) {
        return _433;
    };
    var functorIdentity = new Prelude.Functor(function (_439) {
        return function (_440) {
            return _439(_440);
        };
    });
    var foldableIdentity = new Data_Foldable.Foldable(function (__dict_Monoid_328) {
        return function (_450) {
            return function (_451) {
                return _450(_451);
            };
        };
    }, function (_447) {
        return function (_448) {
            return function (_449) {
                return _447(_448)(_449);
            };
        };
    }, function (_444) {
        return function (_445) {
            return function (_446) {
                return _444(_446)(_445);
            };
        };
    });
    var traversableIdentity = new Data_Traversable.Traversable(function () {
        return foldableIdentity;
    }, function () {
        return functorIdentity;
    }, function (__dict_Applicative_325) {
        return function (_454) {
            return Prelude["<$>"]((__dict_Applicative_325["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Identity)(_454);
        };
    }, function (__dict_Applicative_324) {
        return function (_452) {
            return function (_453) {
                return Prelude["<$>"]((__dict_Applicative_324["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Identity)(_452(_453));
            };
        };
    });
    var extendIdentity = new Control_Extend.Extend(function (f) {
        return function (m) {
            return f(m);
        };
    }, function () {
        return functorIdentity;
    });
    var eqIdentity = function (__dict_Eq_329) {
        return new Prelude.Eq(function (x) {
            return function (y) {
                return !Prelude["=="](eqIdentity(__dict_Eq_329))(x)(y);
            };
        }, function (_434) {
            return function (_435) {
                return Prelude["=="](__dict_Eq_329)(_434)(_435);
            };
        });
    };
    var ordIdentity = function (__dict_Ord_327) {
        return new Prelude.Ord(function () {
            return eqIdentity(__dict_Ord_327["__superclass_Prelude.Eq_0"]());
        }, function (_436) {
            return function (_437) {
                return Prelude.compare(__dict_Ord_327)(_436)(_437);
            };
        });
    };
    var comonadIdentity = new Control_Comonad.Comonad(function () {
        return extendIdentity;
    }, function (_443) {
        return _443;
    });
    var applyIdentity = new Prelude.Apply(function (_441) {
        return function (_442) {
            return _441(_442);
        };
    }, function () {
        return functorIdentity;
    });
    var bindIdentity = new Prelude.Bind(function (m) {
        return function (f) {
            return f(runIdentity(m));
        };
    }, function () {
        return applyIdentity;
    });
    var applicativeIdentity = new Prelude.Applicative(function () {
        return applyIdentity;
    }, Identity);
    var monadIdentity = new Prelude.Monad(function () {
        return applicativeIdentity;
    }, function () {
        return bindIdentity;
    });
    return {
        Identity: Identity, 
        runIdentity: runIdentity, 
        eqIdentity: eqIdentity, 
        ordIdentity: ordIdentity, 
        showConst: showConst, 
        functorIdentity: functorIdentity, 
        applyIdentity: applyIdentity, 
        applicativeIdentity: applicativeIdentity, 
        bindIdentity: bindIdentity, 
        monadIdentity: monadIdentity, 
        extendIdentity: extendIdentity, 
        comonadIdentity: comonadIdentity, 
        foldableIdentity: foldableIdentity, 
        traversableIdentity: traversableIdentity
    };
})();
var PS = PS || {};
PS.Control_Comonad_Env = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Identity = PS.Data_Identity;
    var Control_Comonad_Env_Trans = PS.Control_Comonad_Env_Trans;
    var Data_Tuple = PS.Data_Tuple;
    var withEnv = Control_Comonad_Env_Trans.withEnvT;
    var runEnv = function (x) {
        return Prelude["<$>"](Data_Tuple.functorTuple)(Data_Identity.runIdentity)(Control_Comonad_Env_Trans.runEnvT(x));
    };
    var mapEnv = Prelude["<$>"](Control_Comonad_Env_Trans.functorEnvT(Data_Identity.functorIdentity));
    var env = function (e) {
        return function (a) {
            return Control_Comonad_Env_Trans.EnvT(Data_Tuple.Tuple.create(e)(a));
        };
    };
    return {
        env: env, 
        mapEnv: mapEnv, 
        withEnv: withEnv, 
        runEnv: runEnv
    };
})();
var PS = PS || {};
PS.Control_Comonad_Env_Class = (function () {
    "use strict";
    var Data_Tuple = PS.Data_Tuple;
    var Prelude = PS.Prelude;
    var Control_Comonad_Env_Trans = PS.Control_Comonad_Env_Trans;
    var Control_Comonad = PS.Control_Comonad;
    var Control_Comonad_Env = PS.Control_Comonad_Env;
    var ComonadEnv = function (__superclass_Control$dotComonad$dotComonad_0, ask, local) {
        this["__superclass_Control.Comonad.Comonad_0"] = __superclass_Control$dotComonad$dotComonad_0;
        this.ask = ask;
        this.local = local;
    };
    var local = function (dict) {
        return dict.local;
    };
    var comonadEnvTuple = new ComonadEnv(function () {
        return Data_Tuple.comonadTuple;
    }, Data_Tuple.fst, function (_455) {
        return function (_456) {
            return new Data_Tuple.Tuple(_455(_456.value0), _456.value1);
        };
    });
    var comonadEnvEnvT = function (__dict_Comonad_330) {
        return new ComonadEnv(function () {
            return Control_Comonad_Env_Trans.comonadEnvT(__dict_Comonad_330);
        }, function (x) {
            return Data_Tuple.fst(Control_Comonad_Env_Trans.runEnvT(x));
        }, function (f) {
            return function (x) {
                return Control_Comonad_Env_Trans.EnvT((function () {
                    var _1275 = Control_Comonad_Env_Trans.runEnvT(x);
                    return new Data_Tuple.Tuple(f(_1275.value0), _1275.value1);
                })());
            };
        });
    };
    var ask = function (dict) {
        return dict.ask;
    };
    var asks = function (__dict_ComonadEnv_331) {
        return function (f) {
            return function (x) {
                return f(ask(__dict_ComonadEnv_331)(x));
            };
        };
    };
    return {
        ComonadEnv: ComonadEnv, 
        asks: asks, 
        local: local, 
        ask: ask, 
        comonadEnvTuple: comonadEnvTuple, 
        comonadEnvEnvT: comonadEnvEnvT
    };
})();
var PS = PS || {};
PS.Control_Comonad_Store = (function () {
    "use strict";
    var Data_Tuple = PS.Data_Tuple;
    var Prelude = PS.Prelude;
    var Data_Identity = PS.Data_Identity;
    var Control_Comonad_Store_Trans = PS.Control_Comonad_Store_Trans;
    var store = function (f) {
        return function (x) {
            return Control_Comonad_Store_Trans.StoreT(new Data_Tuple.Tuple(f, x));
        };
    };
    var runStore = function (s) {
        return Data_Tuple.swap(Prelude["<$>"](Data_Tuple.functorTuple)(Data_Identity.runIdentity)(Data_Tuple.swap(Control_Comonad_Store_Trans.runStoreT(s))));
    };
    return {
        store: store, 
        runStore: runStore
    };
})();
var PS = PS || {};
PS.Control_Comonad_Traced = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Comonad_Traced_Trans = PS.Control_Comonad_Traced_Trans;
    var Data_Identity = PS.Data_Identity;
    var traced = Prelude[">>>"](Prelude.semigroupoidArr)(Data_Identity.Identity)(Control_Comonad_Traced_Trans.TracedT);
    var runTraced = Prelude[">>>"](Prelude.semigroupoidArr)(Control_Comonad_Traced_Trans.runTracedT)(Data_Identity.runIdentity);
    return {
        traced: traced, 
        runTraced: runTraced
    };
})();
var PS = PS || {};
PS.Control_Monad_RWS = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Identity = PS.Data_Identity;
    var Control_Monad_RWS_Trans = PS.Control_Monad_RWS_Trans;
    var Data_Monoid = PS.Data_Monoid;
    var Data_Tuple = PS.Data_Tuple;
    
    /**
     *  | Writer operations
     */
    var writer = function (__dict_Applicative_332) {
        return function (_463) {
            return function (_457) {
                return function (s) {
                    return Prelude.pure(__dict_Applicative_332)({
                        state: s, 
                        result: _463.value0, 
                        log: _463.value1
                    });
                };
            };
        };
    };
    var withRWS = Control_Monad_RWS_Trans.withRWST;
    var tell = function (__dict_Applicative_333) {
        return function (w) {
            return writer(__dict_Applicative_333)(new Data_Tuple.Tuple(Prelude.unit, w));
        };
    };
    
    /**
     *  | State operations
     */
    var state = function (__dict_Applicative_334) {
        return function (__dict_Monoid_335) {
            return function (f) {
                return function (_461) {
                    return function (s) {
                        var _1283 = f(s);
                        return Prelude.pure(__dict_Applicative_334)(Control_Monad_RWS_Trans.mkSee(__dict_Monoid_335)(_1283.value1)(_1283.value0)(Data_Monoid.mempty(__dict_Monoid_335)));
                    };
                };
            };
        };
    };
    var rws = function (f) {
        return function (r) {
            return function (s) {
                return Prelude["return"](Data_Identity.monadIdentity)(f(r)(s));
            };
        };
    };
    var runRWS = function (m) {
        return function (r) {
            return function (s) {
                return Data_Identity.runIdentity(Control_Monad_RWS_Trans.runRWST(m)(r)(s));
            };
        };
    };
    var reader = function (__dict_Applicative_336) {
        return function (__dict_Monoid_337) {
            return function (f) {
                return function (r) {
                    return function (s) {
                        return Prelude.pure(__dict_Applicative_336)(Control_Monad_RWS_Trans.mkSee(__dict_Monoid_337)(s)(f(r))(Data_Monoid.mempty(__dict_Monoid_337)));
                    };
                };
            };
        };
    };
    var put = function (__dict_Applicative_338) {
        return function (__dict_Monoid_339) {
            return function (s) {
                return state(__dict_Applicative_338)(__dict_Monoid_339)(function (_462) {
                    return new Data_Tuple.Tuple(Prelude.unit, s);
                });
            };
        };
    };
    var pass = function (__dict_Monad_340) {
        return function (m) {
            return function (r) {
                return function (s) {
                    return Prelude[">>="](__dict_Monad_340["__superclass_Prelude.Bind_1"]())(Control_Monad_RWS_Trans.runRWST(m)(r)(s))(function (_459) {
                        return Prelude.pure(__dict_Monad_340["__superclass_Prelude.Applicative_0"]())({
                            state: _459.state, 
                            result: _459.result.value0, 
                            log: _459.result.value1(_459.log)
                        });
                    });
                };
            };
        };
    };
    var modify = function (__dict_Applicative_341) {
        return function (__dict_Monoid_342) {
            return function (f) {
                return state(__dict_Applicative_341)(__dict_Monoid_342)(function (s) {
                    return new Data_Tuple.Tuple(Prelude.unit, f(s));
                });
            };
        };
    };
    var mapRWS = function (f) {
        return Control_Monad_RWS_Trans.mapRWST(Prelude[">>>"](Prelude.semigroupoidArr)(Data_Identity.runIdentity)(Prelude[">>>"](Prelude.semigroupoidArr)(f)(Data_Identity.Identity)));
    };
    var local = function (f) {
        return function (m) {
            return function (r) {
                return function (s) {
                    return Control_Monad_RWS_Trans.runRWST(m)(f(r))(s);
                };
            };
        };
    };
    var listens = function (__dict_Monad_343) {
        return function (f) {
            return function (m) {
                return function (r) {
                    return function (s) {
                        return Prelude[">>="](__dict_Monad_343["__superclass_Prelude.Bind_1"]())(Control_Monad_RWS_Trans.runRWST(m)(r)(s))(function (_460) {
                            return Prelude.pure(__dict_Monad_343["__superclass_Prelude.Applicative_0"]())({
                                state: _460.state, 
                                result: new Data_Tuple.Tuple(_460.result, f(_460.log)), 
                                log: _460.log
                            });
                        });
                    };
                };
            };
        };
    };
    var listen = function (__dict_Monad_344) {
        return function (m) {
            return function (r) {
                return function (s) {
                    return Prelude[">>="](__dict_Monad_344["__superclass_Prelude.Bind_1"]())(Control_Monad_RWS_Trans.runRWST(m)(r)(s))(function (_458) {
                        return Prelude.pure(__dict_Monad_344["__superclass_Prelude.Applicative_0"]())({
                            state: _458.state, 
                            result: new Data_Tuple.Tuple(_458.result, _458.log), 
                            log: _458.log
                        });
                    });
                };
            };
        };
    };
    var gets = function (__dict_Applicative_345) {
        return function (__dict_Monoid_346) {
            return function (f) {
                return state(__dict_Applicative_345)(__dict_Monoid_346)(function (s) {
                    return new Data_Tuple.Tuple(f(s), s);
                });
            };
        };
    };
    var get = function (__dict_Applicative_347) {
        return function (__dict_Monoid_348) {
            return state(__dict_Applicative_347)(__dict_Monoid_348)(function (s) {
                return new Data_Tuple.Tuple(s, s);
            });
        };
    };
    var execRWS = function (m) {
        return function (r) {
            return function (s) {
                return Data_Identity.runIdentity(Control_Monad_RWS_Trans.execRWST(Data_Identity.monadIdentity)(m)(r)(s));
            };
        };
    };
    var evalRWS = function (m) {
        return function (r) {
            return function (s) {
                return Data_Identity.runIdentity(Control_Monad_RWS_Trans.evalRWST(Data_Identity.monadIdentity)(m)(r)(s));
            };
        };
    };
    var censor = function (__dict_Monad_349) {
        return function (f) {
            return function (m) {
                return function (r) {
                    return function (s) {
                        return Prelude[">>="](__dict_Monad_349["__superclass_Prelude.Bind_1"]())(Control_Monad_RWS_Trans.runRWST(m)(r)(s))(function (see) {
                            return Prelude.pure(__dict_Monad_349["__superclass_Prelude.Applicative_0"]())((function () {
                                var _1301 = {};
                                for (var _1302 in see) {
                                    if (see.hasOwnProperty(_1302)) {
                                        _1301[_1302] = see[_1302];
                                    };
                                };
                                _1301.log = f(see.log);
                                return _1301;
                            })());
                        });
                    };
                };
            };
        };
    };
    
    /**
     *  | Reader operations
     */
    var ask = function (__dict_Applicative_350) {
        return function (__dict_Monoid_351) {
            return function (r) {
                return function (s) {
                    return Prelude.pure(__dict_Applicative_350)(Control_Monad_RWS_Trans.mkSee(__dict_Monoid_351)(s)(r)(Data_Monoid.mempty(__dict_Monoid_351)));
                };
            };
        };
    };
    return {
        modify: modify, 
        put: put, 
        gets: gets, 
        get: get, 
        state: state, 
        censor: censor, 
        listens: listens, 
        tell: tell, 
        pass: pass, 
        listen: listen, 
        writer: writer, 
        reader: reader, 
        local: local, 
        ask: ask, 
        withRWS: withRWS, 
        mapRWS: mapRWS, 
        execRWS: execRWS, 
        evalRWS: evalRWS, 
        runRWS: runRWS, 
        rws: rws
    };
})();
var PS = PS || {};
PS.Control_Monad_Reader_Class = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Reader_Trans = PS.Control_Monad_Reader_Trans;
    var Control_Monad_Trans = PS.Control_Monad_Trans;
    var Control_Monad_Error_Trans = PS.Control_Monad_Error_Trans;
    var Control_Monad_Maybe_Trans = PS.Control_Monad_Maybe_Trans;
    var Control_Monad_Writer_Trans = PS.Control_Monad_Writer_Trans;
    var Control_Monad_State_Trans = PS.Control_Monad_State_Trans;
    var Control_Monad_RWS = PS.Control_Monad_RWS;
    var Control_Monad_Error = PS.Control_Monad_Error;
    var Control_Monad_RWS_Trans = PS.Control_Monad_RWS_Trans;
    var Data_Monoid = PS.Data_Monoid;
    var MonadReader = function (ask, local) {
        this.ask = ask;
        this.local = local;
    };
    var monadReaderReaderT = function (__dict_Monad_352) {
        return new MonadReader(Prelude["return"](__dict_Monad_352), Control_Monad_Reader_Trans.withReaderT);
    };
    var monadReaderRWST = function (__dict_Monad_353) {
        return function (__dict_Monoid_354) {
            return new MonadReader(Control_Monad_RWS.ask(__dict_Monad_353["__superclass_Prelude.Applicative_0"]())(__dict_Monoid_354), Control_Monad_RWS.local);
        };
    };
    var monadReaderFun = new MonadReader(Prelude.id(Prelude.categoryArr), Prelude[">>>"](Prelude.semigroupoidArr));
    var local = function (dict) {
        return dict.local;
    };
    var ask = function (dict) {
        return dict.ask;
    };
    var monadReaderErrorT = function (__dict_Monad_355) {
        return function (__dict_MonadReader_356) {
            return new MonadReader(Control_Monad_Trans.lift(Control_Monad_Error_Trans.monadTransErrorT)(__dict_Monad_355)(ask(__dict_MonadReader_356)), function (f) {
                return Control_Monad_Error_Trans.mapErrorT(local(__dict_MonadReader_356)(f));
            });
        };
    };
    var monadReaderMaybeT = function (__dict_Monad_357) {
        return function (__dict_MonadReader_358) {
            return new MonadReader(Control_Monad_Trans.lift(Control_Monad_Maybe_Trans.monadTransMaybeT)(__dict_Monad_357)(ask(__dict_MonadReader_358)), function (f) {
                return Control_Monad_Maybe_Trans.mapMaybeT(local(__dict_MonadReader_358)(f));
            });
        };
    };
    var monadReaderStateT = function (__dict_Monad_359) {
        return function (__dict_MonadReader_360) {
            return new MonadReader(Control_Monad_Trans.lift(Control_Monad_State_Trans.monadTransStateT)(__dict_Monad_359)(ask(__dict_MonadReader_360)), function (f) {
                return Control_Monad_State_Trans.mapStateT(local(__dict_MonadReader_360)(f));
            });
        };
    };
    var monadReaderWriterT = function (__dict_Monad_361) {
        return function (__dict_Monoid_362) {
            return function (__dict_MonadReader_363) {
                return new MonadReader(Control_Monad_Trans.lift(Control_Monad_Writer_Trans.monadTransWriterT(__dict_Monoid_362))(__dict_Monad_361)(ask(__dict_MonadReader_363)), function (f) {
                    return Control_Monad_Writer_Trans.mapWriterT(local(__dict_MonadReader_363)(f));
                });
            };
        };
    };
    var reader = function (__dict_Monad_364) {
        return function (__dict_MonadReader_365) {
            return function (f) {
                return Prelude[">>="](__dict_Monad_364["__superclass_Prelude.Bind_1"]())(ask(__dict_MonadReader_365))(Prelude["<<<"](Prelude.semigroupoidArr)(Prelude["return"](__dict_Monad_364))(f));
            };
        };
    };
    return {
        MonadReader: MonadReader, 
        reader: reader, 
        local: local, 
        ask: ask, 
        monadReaderFun: monadReaderFun, 
        monadReaderReaderT: monadReaderReaderT, 
        monadReaderErrorT: monadReaderErrorT, 
        monadReaderMaybeT: monadReaderMaybeT, 
        monadReaderWriterT: monadReaderWriterT, 
        monadReaderStateT: monadReaderStateT, 
        monadReaderRWST: monadReaderRWST
    };
})();
var PS = PS || {};
PS.Control_Monad_State_Class = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Trans = PS.Control_Monad_Trans;
    var Control_Monad_RWS = PS.Control_Monad_RWS;
    var Control_Monad_State_Trans = PS.Control_Monad_State_Trans;
    var Control_Monad_Error = PS.Control_Monad_Error;
    var Control_Monad_Error_Trans = PS.Control_Monad_Error_Trans;
    var Control_Monad_Maybe_Trans = PS.Control_Monad_Maybe_Trans;
    var Control_Monad_Reader_Trans = PS.Control_Monad_Reader_Trans;
    var Control_Monad_RWS_Trans = PS.Control_Monad_RWS_Trans;
    var Control_Monad_Writer_Trans = PS.Control_Monad_Writer_Trans;
    var Data_Monoid = PS.Data_Monoid;
    var Data_Tuple = PS.Data_Tuple;
    var MonadState = function (state) {
        this.state = state;
    };
    var state = function (dict) {
        return dict.state;
    };
    var put = function (__dict_Monad_366) {
        return function (__dict_MonadState_367) {
            return function (s) {
                return state(__dict_MonadState_367)(function (_464) {
                    return new Data_Tuple.Tuple(Prelude.unit, s);
                });
            };
        };
    };
    var monadStateWriterT = function (__dict_Monad_368) {
        return function (__dict_Monoid_369) {
            return function (__dict_MonadState_370) {
                return new MonadState(function (f) {
                    return Control_Monad_Trans.lift(Control_Monad_Writer_Trans.monadTransWriterT(__dict_Monoid_369))(__dict_Monad_368)(state(__dict_MonadState_370)(f));
                });
            };
        };
    };
    var monadStateStateT1 = function (__dict_Monad_371) {
        return function (__dict_MonadState_372) {
            return new MonadState(function (f) {
                return Control_Monad_Trans.lift(Control_Monad_State_Trans.monadTransStateT)(__dict_Monad_371)(state(__dict_MonadState_372)(f));
            });
        };
    };
    var monadStateStateT = function (__dict_Monad_373) {
        return new MonadState(function (f) {
            return Control_Monad_State_Trans.StateT(Prelude["<<<"](Prelude.semigroupoidArr)(Prelude["return"](__dict_Monad_373))(f));
        });
    };
    var monadStateReaderT = function (__dict_Monad_374) {
        return function (__dict_MonadState_375) {
            return new MonadState(function (f) {
                return Control_Monad_Trans.lift(Control_Monad_Reader_Trans.monadTransReaderT)(__dict_Monad_374)(state(__dict_MonadState_375)(f));
            });
        };
    };
    var monadStateRWST = function (__dict_Monad_376) {
        return function (__dict_Monoid_377) {
            return new MonadState(Control_Monad_RWS.state(__dict_Monad_376["__superclass_Prelude.Applicative_0"]())(__dict_Monoid_377));
        };
    };
    var monadStateMaybeT = function (__dict_Monad_378) {
        return function (__dict_MonadState_379) {
            return new MonadState(function (f) {
                return Control_Monad_Trans.lift(Control_Monad_Maybe_Trans.monadTransMaybeT)(__dict_Monad_378)(state(__dict_MonadState_379)(f));
            });
        };
    };
    var monadStateErrorT = function (__dict_Monad_380) {
        return function (__dict_MonadState_381) {
            return new MonadState(function (f) {
                return Control_Monad_Trans.lift(Control_Monad_Error_Trans.monadTransErrorT)(__dict_Monad_380)(state(__dict_MonadState_381)(f));
            });
        };
    };
    var modify = function (__dict_Monad_382) {
        return function (__dict_MonadState_383) {
            return function (f) {
                return state(__dict_MonadState_383)(function (s) {
                    return new Data_Tuple.Tuple(Prelude.unit, f(s));
                });
            };
        };
    };
    var gets = function (__dict_Monad_384) {
        return function (__dict_MonadState_385) {
            return function (f) {
                return state(__dict_MonadState_385)(function (s) {
                    return new Data_Tuple.Tuple(f(s), s);
                });
            };
        };
    };
    var get = function (__dict_Monad_386) {
        return function (__dict_MonadState_387) {
            return state(__dict_MonadState_387)(function (s) {
                return new Data_Tuple.Tuple(s, s);
            });
        };
    };
    return {
        MonadState: MonadState, 
        modify: modify, 
        put: put, 
        gets: gets, 
        get: get, 
        state: state, 
        monadStateStateT: monadStateStateT, 
        monadStateStateT1: monadStateStateT1, 
        monadStateErrorT: monadStateErrorT, 
        monadStateMaybeT: monadStateMaybeT, 
        monadStateReaderT: monadStateReaderT, 
        monadStateWriterT: monadStateWriterT, 
        monadStateRWST: monadStateRWST
    };
})();
var PS = PS || {};
PS.Control_Monad_Writer_Class = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Writer_Trans = PS.Control_Monad_Writer_Trans;
    var Control_Monad_Trans = PS.Control_Monad_Trans;
    var Control_Monad_Error_Trans = PS.Control_Monad_Error_Trans;
    var Control_Monad_Maybe_Trans = PS.Control_Monad_Maybe_Trans;
    var Control_Monad_State_Trans = PS.Control_Monad_State_Trans;
    var Control_Monad_Reader_Trans = PS.Control_Monad_Reader_Trans;
    var Control_Monad_RWS = PS.Control_Monad_RWS;
    var Control_Monad_Error = PS.Control_Monad_Error;
    var Control_Monad_RWS_Trans = PS.Control_Monad_RWS_Trans;
    var Data_Monoid = PS.Data_Monoid;
    var Data_Tuple = PS.Data_Tuple;
    var MonadWriter = function (listen, pass, writer) {
        this.listen = listen;
        this.pass = pass;
        this.writer = writer;
    };
    var writer = function (dict) {
        return dict.writer;
    };
    var tell = function (__dict_Monoid_388) {
        return function (__dict_Monad_389) {
            return function (__dict_MonadWriter_390) {
                return function (w) {
                    return writer(__dict_MonadWriter_390)(new Data_Tuple.Tuple(Prelude.unit, w));
                };
            };
        };
    };
    var pass = function (dict) {
        return dict.pass;
    };
    var monadWriterWriterT = function (__dict_Monoid_391) {
        return function (__dict_Monad_392) {
            return new MonadWriter(function (m) {
                return Control_Monad_Writer_Trans.WriterT(Prelude[">>="](__dict_Monad_392["__superclass_Prelude.Bind_1"]())(Control_Monad_Writer_Trans.runWriterT(m))(function (_23) {
                    return Prelude["return"](__dict_Monad_392)(new Data_Tuple.Tuple(new Data_Tuple.Tuple(_23.value0, _23.value1), _23.value1));
                }));
            }, function (m) {
                return Control_Monad_Writer_Trans.WriterT(Prelude[">>="](__dict_Monad_392["__superclass_Prelude.Bind_1"]())(Control_Monad_Writer_Trans.runWriterT(m))(function (_24) {
                    return Prelude["return"](__dict_Monad_392)(new Data_Tuple.Tuple(_24.value0.value0, _24.value0.value1(_24.value1)));
                }));
            }, Prelude["<<<"](Prelude.semigroupoidArr)(Control_Monad_Writer_Trans.WriterT)(Prelude["return"](__dict_Monad_392)));
        };
    };
    var monadWriterRWST = function (__dict_Monad_393) {
        return function (__dict_Monoid_394) {
            return new MonadWriter(Control_Monad_RWS.listen(__dict_Monad_393), Control_Monad_RWS.pass(__dict_Monad_393), Control_Monad_RWS.writer(__dict_Monad_393["__superclass_Prelude.Applicative_0"]()));
        };
    };
    var listen = function (dict) {
        return dict.listen;
    };
    var listens = function (__dict_Monoid_395) {
        return function (__dict_Monad_396) {
            return function (__dict_MonadWriter_397) {
                return function (f) {
                    return function (m) {
                        return Prelude[">>="](__dict_Monad_396["__superclass_Prelude.Bind_1"]())(listen(__dict_MonadWriter_397)(m))(function (_21) {
                            return Prelude["return"](__dict_Monad_396)(new Data_Tuple.Tuple(_21.value0, f(_21.value1)));
                        });
                    };
                };
            };
        };
    };
    var monadWriterErrorT = function (__dict_Monad_398) {
        return function (__dict_MonadWriter_399) {
            return new MonadWriter(Control_Monad_Error_Trans.liftListenError(__dict_Monad_398)(listen(__dict_MonadWriter_399)), Control_Monad_Error_Trans.liftPassError(__dict_Monad_398)(pass(__dict_MonadWriter_399)), function (wd) {
                return Control_Monad_Trans.lift(Control_Monad_Error_Trans.monadTransErrorT)(__dict_Monad_398)(writer(__dict_MonadWriter_399)(wd));
            });
        };
    };
    var monadWriterMaybeT = function (__dict_Monad_400) {
        return function (__dict_MonadWriter_401) {
            return new MonadWriter(Control_Monad_Maybe_Trans.liftListenMaybe(__dict_Monad_400)(listen(__dict_MonadWriter_401)), Control_Monad_Maybe_Trans.liftPassMaybe(__dict_Monad_400)(pass(__dict_MonadWriter_401)), function (wd) {
                return Control_Monad_Trans.lift(Control_Monad_Maybe_Trans.monadTransMaybeT)(__dict_Monad_400)(writer(__dict_MonadWriter_401)(wd));
            });
        };
    };
    var monadWriterReaderT = function (__dict_Monad_402) {
        return function (__dict_MonadWriter_403) {
            return new MonadWriter(Control_Monad_Reader_Trans.mapReaderT(listen(__dict_MonadWriter_403)), Control_Monad_Reader_Trans.mapReaderT(pass(__dict_MonadWriter_403)), function (wd) {
                return Control_Monad_Trans.lift(Control_Monad_Reader_Trans.monadTransReaderT)(__dict_Monad_402)(writer(__dict_MonadWriter_403)(wd));
            });
        };
    };
    var monadWriterStateT = function (__dict_Monad_404) {
        return function (__dict_MonadWriter_405) {
            return new MonadWriter(Control_Monad_State_Trans.liftListenState(__dict_Monad_404)(listen(__dict_MonadWriter_405)), Control_Monad_State_Trans.liftPassState(__dict_Monad_404)(pass(__dict_MonadWriter_405)), function (wd) {
                return Control_Monad_Trans.lift(Control_Monad_State_Trans.monadTransStateT)(__dict_Monad_404)(writer(__dict_MonadWriter_405)(wd));
            });
        };
    };
    var censor = function (__dict_Monoid_406) {
        return function (__dict_Monad_407) {
            return function (__dict_MonadWriter_408) {
                return function (f) {
                    return function (m) {
                        return pass(__dict_MonadWriter_408)(Prelude[">>="](__dict_Monad_407["__superclass_Prelude.Bind_1"]())(m)(function (_22) {
                            return Prelude["return"](__dict_Monad_407)(new Data_Tuple.Tuple(_22, f));
                        }));
                    };
                };
            };
        };
    };
    return {
        MonadWriter: MonadWriter, 
        censor: censor, 
        listens: listens, 
        tell: tell, 
        pass: pass, 
        listen: listen, 
        writer: writer, 
        monadWriterWriterT: monadWriterWriterT, 
        monadWriterErrorT: monadWriterErrorT, 
        monadWriterMaybeT: monadWriterMaybeT, 
        monadWriterStateT: monadWriterStateT, 
        monadWriterReaderT: monadWriterReaderT, 
        monadWriterRWST: monadWriterRWST
    };
})();
var PS = PS || {};
PS.Control_Monad_RWS_Class = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_RWS_Trans = PS.Control_Monad_RWS_Trans;
    var Control_Monad_Error_Trans = PS.Control_Monad_Error_Trans;
    var Control_Monad_Error = PS.Control_Monad_Error;
    var Control_Monad_Maybe_Trans = PS.Control_Monad_Maybe_Trans;
    var Control_Monad_Reader_Class = PS.Control_Monad_Reader_Class;
    var Control_Monad_State_Class = PS.Control_Monad_State_Class;
    var Control_Monad_Writer_Class = PS.Control_Monad_Writer_Class;
    var Data_Monoid = PS.Data_Monoid;
    var MonadRWS = function (__superclass_Control$dotMonad$dotReader$dotClass$dotMonadReader_2, __superclass_Control$dotMonad$dotState$dotClass$dotMonadState_4, __superclass_Control$dotMonad$dotWriter$dotClass$dotMonadWriter_3, __superclass_Data$dotMonoid$dotMonoid_1, __superclass_Prelude$dotMonad_0) {
        this["__superclass_Control.Monad.Reader.Class.MonadReader_2"] = __superclass_Control$dotMonad$dotReader$dotClass$dotMonadReader_2;
        this["__superclass_Control.Monad.State.Class.MonadState_4"] = __superclass_Control$dotMonad$dotState$dotClass$dotMonadState_4;
        this["__superclass_Control.Monad.Writer.Class.MonadWriter_3"] = __superclass_Control$dotMonad$dotWriter$dotClass$dotMonadWriter_3;
        this["__superclass_Data.Monoid.Monoid_1"] = __superclass_Data$dotMonoid$dotMonoid_1;
        this["__superclass_Prelude.Monad_0"] = __superclass_Prelude$dotMonad_0;
    };
    var monadRWSRWST = function (__dict_Monad_409) {
        return function (__dict_Monoid_410) {
            return new MonadRWS(function () {
                return Control_Monad_Reader_Class.monadReaderRWST(__dict_Monad_409)(__dict_Monoid_410);
            }, function () {
                return Control_Monad_State_Class.monadStateRWST(__dict_Monad_409)(__dict_Monoid_410);
            }, function () {
                return Control_Monad_Writer_Class.monadWriterRWST(__dict_Monad_409)(__dict_Monoid_410);
            }, function () {
                return __dict_Monoid_410;
            }, function () {
                return Control_Monad_RWS_Trans.monadRWST(__dict_Monad_409)(__dict_Monoid_410);
            });
        };
    };
    var monadRWSMaybeT = function (__dict_Monad_411) {
        return function (__dict_Monoid_412) {
            return function (__dict_MonadRWS_413) {
                return function (__dict_MonadReader_414) {
                    return function (__dict_MonadWriter_415) {
                        return function (__dict_MonadState_416) {
                            return new MonadRWS(function () {
                                return Control_Monad_Reader_Class.monadReaderMaybeT(__dict_Monad_411)(__dict_MonadReader_414);
                            }, function () {
                                return Control_Monad_State_Class.monadStateMaybeT(__dict_Monad_411)(__dict_MonadState_416);
                            }, function () {
                                return Control_Monad_Writer_Class.monadWriterMaybeT(__dict_Monad_411)(__dict_MonadWriter_415);
                            }, function () {
                                return __dict_Monoid_412;
                            }, function () {
                                return Control_Monad_Maybe_Trans.monadMaybeT(__dict_Monad_411);
                            });
                        };
                    };
                };
            };
        };
    };
    var monadRWSErrorT = function (__dict_Monad_417) {
        return function (__dict_Monoid_418) {
            return function (__dict_MonadRWS_419) {
                return function (__dict_MonadReader_420) {
                    return function (__dict_MonadWriter_421) {
                        return function (__dict_MonadState_422) {
                            return new MonadRWS(function () {
                                return Control_Monad_Reader_Class.monadReaderErrorT(__dict_Monad_417)(__dict_MonadReader_420);
                            }, function () {
                                return Control_Monad_State_Class.monadStateErrorT(__dict_Monad_417)(__dict_MonadState_422);
                            }, function () {
                                return Control_Monad_Writer_Class.monadWriterErrorT(__dict_Monad_417)(__dict_MonadWriter_421);
                            }, function () {
                                return __dict_Monoid_418;
                            }, function () {
                                return Control_Monad_Error_Trans.monadErrorT(__dict_Monad_417);
                            });
                        };
                    };
                };
            };
        };
    };
    return {
        MonadRWS: MonadRWS, 
        monadRWSRWST: monadRWSRWST, 
        monadRWSErrorT: monadRWSErrorT, 
        monadRWSMaybeT: monadRWSMaybeT
    };
})();
var PS = PS || {};
PS.Control_Monad_Reader = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Identity = PS.Data_Identity;
    var Control_Monad_Reader_Trans = PS.Control_Monad_Reader_Trans;
    var withReader = Control_Monad_Reader_Trans.withReaderT;
    var runReader = function (m) {
        return Prelude["<<<"](Prelude.semigroupoidArr)(Data_Identity.runIdentity)(Control_Monad_Reader_Trans.runReaderT(m));
    };
    var mapReader = function (f) {
        return Control_Monad_Reader_Trans.mapReaderT(Prelude["<<<"](Prelude.semigroupoidArr)(Data_Identity.Identity)(Prelude["<<<"](Prelude.semigroupoidArr)(f)(Data_Identity.runIdentity)));
    };
    return {
        mapReader: mapReader, 
        withReader: withReader, 
        runReader: runReader
    };
})();
var PS = PS || {};
PS.Control_Monad_State = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Identity = PS.Data_Identity;
    var Control_Monad_State_Trans = PS.Control_Monad_State_Trans;
    var Data_Tuple = PS.Data_Tuple;
    var withState = Control_Monad_State_Trans.withStateT;
    var runState = function (s) {
        return Prelude["<<<"](Prelude.semigroupoidArr)(Data_Identity.runIdentity)(Control_Monad_State_Trans.runStateT(s));
    };
    var mapState = function (f) {
        return Control_Monad_State_Trans.mapStateT(Prelude["<<<"](Prelude.semigroupoidArr)(Data_Identity.Identity)(Prelude["<<<"](Prelude.semigroupoidArr)(f)(Data_Identity.runIdentity)));
    };
    var execState = function (m) {
        return function (s) {
            return Data_Tuple.snd(runState(m)(s));
        };
    };
    var evalState = function (m) {
        return function (s) {
            return Data_Tuple.fst(runState(m)(s));
        };
    };
    return {
        withState: withState, 
        mapState: mapState, 
        execState: execState, 
        evalState: evalState, 
        runState: runState
    };
})();
var PS = PS || {};
PS.Control_Monad_Writer = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Identity = PS.Data_Identity;
    var Control_Monad_Writer_Trans = PS.Control_Monad_Writer_Trans;
    var Data_Tuple = PS.Data_Tuple;
    var Data_Monoid = PS.Data_Monoid;
    var runWriter = Prelude["<<<"](Prelude.semigroupoidArr)(Data_Identity.runIdentity)(Control_Monad_Writer_Trans.runWriterT);
    var mapWriter = function (f) {
        return Control_Monad_Writer_Trans.mapWriterT(Prelude["<<<"](Prelude.semigroupoidArr)(Data_Identity.Identity)(Prelude["<<<"](Prelude.semigroupoidArr)(f)(Data_Identity.runIdentity)));
    };
    var execWriter = function (m) {
        return Data_Tuple.snd(runWriter(m));
    };
    return {
        mapWriter: mapWriter, 
        execWriter: execWriter, 
        runWriter: runWriter
    };
})();
var PS = PS || {};
PS.Network_Routing_Client = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Network_Routing_Client_Foreign = PS.Network_Routing_Client_Foreign;
    var Data_Function = PS.Data_Function;
    var Data_String = PS.Data_String;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Control_Monad_Eff_Class = PS.Control_Monad_Eff_Class;
    var Control_Monad_Eff_Unsafe = PS.Control_Monad_Eff_Unsafe;
    var Data_Array = PS.Data_Array;
    var Data_Maybe = PS.Data_Maybe;
    
function newRouter(director){
  return function NewRouterEff(){
    return director();
  }
};
    
function initRouter(d){
  return function InitRouterEff(){
    d.init('/');
    return {};
  }
};
    
function configureImpl(r, opts){
  return function ConfigureEff(){
    r.configure({'html5history': opts.historyAPI, 'notfound': opts.notFound});
    return {};
  }
};
    
function globalize(m){
  return m();
};
    
function setRouteImpl(d, p){
  return function SetRouteEff(){
    d.setRoute(p);
    return {};
  }
};
    
function unsafeCoerce(a){
  return a;
};
    
function paramImpl(d,n,m){
  return function ParamEff(){
    d.param(n,m);
    return {};
  }
};
    
function routeImpl(d,p,f){
  return function RouteEff(){
    d.on(p,f);
    return {};
  }
};
    
function wrap0(f){
  return function Wrap0(){return f();}
};
    
function wrap1(f){
  return function Wrap1(a){
    var _this = this;
    var setRoute = function(route){
      return function(){
        _this.setRoute(route);
      }
    };
    return f(setRoute)(a)();
  }
};
    
function wrap2(f){
  return function Wrap2(a,b){
    var _this = this;
    var setRoute = function(route){
      return function(){
        _this.setRoute(route);
      }
    };
    return f(setRoute)(a)(b)();
  }
};
    
function wrap3(f){
  return function Wrap3(a,b,c){
   var _this = this;
    var setRoute = function(route){
      return function(){
        _this.setRoute(route);
      }
    };
    return f(setRoute)(a)(b)(c)();
  }
};
    var Exact = (function () {
        function Exact(value0) {
            this.value0 = value0;
        };
        Exact.create = function (value0) {
            return new Exact(value0);
        };
        return Exact;
    })();
    var Regex = (function () {
        function Regex(value0) {
            this.value0 = value0;
        };
        Regex.create = function (value0) {
            return new Regex(value0);
        };
        return Regex;
    })();
    var Param = (function () {
        function Param(value0) {
            this.value0 = value0;
        };
        Param.create = function (value0) {
            return new Param(value0);
        };
        return Param;
    })();
    var Any = (function () {
        function Any() {

        };
        Any.value = new Any();
        return Any;
    })();
    var Pathes = function (x) {
        return x;
    };
    
    /**
     *  Callback Monad
     */
    var Callback = function (x) {
        return x;
    };
    var RoutingM = function (x) {
        return x;
    };
    var $minus$div = function (_471) {
        return function (_472) {
            return Prelude[":"](unsafeCoerce(_471))(_472);
        };
    };
    var $plus$div = function (_473) {
        return function (_474) {
            return Prelude[":"](unsafeCoerce(_473))(unsafeCoerce(_474));
        };
    };
    var setRoute = function (route_1) {
        return Callback(function (set) {
            return set(route_1);
        });
    };
    var runCallback = function (_468) {
        return _468;
    };
    var runRouter = function (_467) {
        return function __do() {
            var _30 = newRouter(Network_Routing_Client_Foreign.director)();
            var _29 = _467({
                variableIndex: 0, 
                routerInstance: _30, 
                historyAPI: false, 
                notFound: Data_Maybe.Nothing.value
            })();
            (function () {
                if (_29.s.notFound instanceof Data_Maybe.Nothing) {
                    return configureImpl(_30, {
                        historyAPI: _29.s.historyAPI
                    });
                };
                if (_29.s.notFound instanceof Data_Maybe.Just) {
                    return configureImpl(_30, {
                        historyAPI: _29.s.historyAPI, 
                        notFound: runCallback(_29.s.notFound.value0)(function (s_1) {
                            return setRouteImpl(_30, s_1);
                        })
                    });
                };
                throw new Error("Failed pattern match");
            })()();
            initRouter(_30)();
            return function (s_1) {
                return setRouteImpl(_30, s_1);
            };
        };
    };
    var unsafeGlobalRoute = function (m) {
        return globalize(runRouter(m));
    };
    var regex = Regex.create;
    var pathToString = function (_469) {
        if (_469 instanceof Exact) {
            return _469.value0;
        };
        if (_469 instanceof Regex) {
            return "(" + (_469.value0 + ")");
        };
        if (_469 instanceof Param) {
            return _469.value0;
        };
        if (_469 instanceof Any) {
            return ":_";
        };
        throw new Error("Failed pattern match");
    };
    var pathesToString = function (_470) {
        return "/" + Data_String.joinWith("/")(Prelude["<$>"](Data_Array.functorArray)(pathToString)(_470));
    };
    var showPathes = new Prelude.Show(pathesToString);
    var showPath = new Prelude.Show(pathToString);
    var modifyState = function (f) {
        return RoutingM(function (s) {
            return Prelude["return"](Control_Monad_Eff.monadEff)({
                a: Prelude.unit, 
                s: f(s)
            });
        });
    };
    var notFound = function (m) {
        return modifyState(function (s) {
            var _1331 = {};
            for (var _1332 in s) {
                if (s.hasOwnProperty(_1332)) {
                    _1331[_1332] = s[_1332];
                };
            };
            _1331.notFound = new Data_Maybe.Just(m);
            return _1331;
        });
    };
    var succIndex = modifyState(function (s) {
        var _1333 = {};
        for (var _1334 in s) {
            if (s.hasOwnProperty(_1334)) {
                _1333[_1334] = s[_1334];
            };
        };
        _1333.variableIndex = s.variableIndex + 1;
        return _1333;
    });
    var useHistoryAPI = modifyState(function (s) {
        var _1335 = {};
        for (var _1336 in s) {
            if (s.hasOwnProperty(_1336)) {
                _1335[_1336] = s[_1336];
            };
        };
        _1335.historyAPI = true;
        return _1335;
    });
    var liftRoutingM = function (m) {
        return RoutingM(function (s) {
            return function __do() {
                var a = m();
                return {
                    a: a, 
                    s: s
                };
            };
        });
    };
    
    /**
     *  routing Monad methods
     */
    var getState = RoutingM(function (s) {
        return Prelude["return"](Control_Monad_Eff.monadEff)({
            a: s, 
            s: s
        });
    });
    var functorRoutingM = new Prelude.Functor(function (_475) {
        return function (_476) {
            return RoutingM(function (s) {
                return function __do() {
                    var n = _476(s)();
                    return {
                        a: _475(n.a), 
                        s: n.s
                    };
                };
            });
        };
    });
    var functorCallback = new Prelude.Functor(function (_481) {
        return function (_482) {
            return Callback(function (s) {
                return function __do() {
                    var n = _482(s)();
                    return _481(n);
                };
            });
        };
    });
    var exact = Exact.create;
    var empty = [  ];
    var applyRoutingM = new Prelude.Apply(function (_477) {
        return function (_478) {
            return RoutingM(function (s) {
                return function __do() {
                    var _26 = _477(s)();
                    var _25 = _478(_26.s)();
                    return {
                        a: _26.a(_25.a), 
                        s: _25.s
                    };
                };
            });
        };
    }, function () {
        return functorRoutingM;
    });
    var bindRoutingM = new Prelude.Bind(function (_479) {
        return function (_480) {
            return RoutingM(function (s) {
                return function __do() {
                    var _28 = _479(s)();
                    var _27 = _480(_28.a);
                    return _27(_28.s)();
                };
            });
        };
    }, function () {
        return applyRoutingM;
    });
    var route = function (p) {
        return function (f) {
            return Prelude[">>="](bindRoutingM)(getState)(function (_36) {
                return liftRoutingM(routeImpl(_36.routerInstance, pathesToString(p), f));
            });
        };
    };
    var routes0 = function (p) {
        return function (f) {
            return route(p)(Prelude["<$>"](Data_Array.functorArray)(wrap0)(f));
        };
    };
    var route0 = function (p) {
        return function (f) {
            return routes0(p)([ f ]);
        };
    };
    var routes1 = function (p) {
        return function (f) {
            return route(p)(Prelude["<$>"](Data_Array.functorArray)(function (r) {
                return wrap1(function (set) {
                    return function (p1) {
                        return runCallback(r(p1))(set);
                    };
                });
            })(f));
        };
    };
    var route1 = function (p) {
        return function (f) {
            return routes1(p)([ f ]);
        };
    };
    var routes2 = function (p) {
        return function (f) {
            return route(p)(Prelude["<$>"](Data_Array.functorArray)(function (r) {
                return wrap2(function (set) {
                    return function (p1) {
                        return function (p2) {
                            return runCallback(r(p1)(p2))(set);
                        };
                    };
                });
            })(f));
        };
    };
    var route2 = function (p) {
        return function (f) {
            return routes2(p)([ f ]);
        };
    };
    var routes3 = function (p) {
        return function (f) {
            return route(p)(Prelude["<$>"](Data_Array.functorArray)(function (r) {
                return wrap3(function (set) {
                    return function (p1) {
                        return function (p2) {
                            return function (p3) {
                                return runCallback(r(p1)(p2)(p3))(set);
                            };
                        };
                    };
                });
            })(f));
        };
    };
    var route3 = function (p) {
        return function (f) {
            return routes3(p)([ f ]);
        };
    };
    var applyCallback = new Prelude.Apply(function (_483) {
        return function (_484) {
            return Callback(function (s) {
                return function __do() {
                    var _32 = _483(s)();
                    var _31 = _484(s)();
                    return _32(_31);
                };
            });
        };
    }, function () {
        return functorCallback;
    });
    var bindCallback = new Prelude.Bind(function (_485) {
        return function (_486) {
            return Callback(function (s) {
                return function __do() {
                    var _34 = _485(s)();
                    var _33 = _486(_34);
                    return _33(s)();
                };
            });
        };
    }, function () {
        return applyCallback;
    });
    var applicativeRoutingM = new Prelude.Applicative(function () {
        return applyRoutingM;
    }, function (a) {
        return RoutingM(function (s) {
            return Prelude["return"](Control_Monad_Eff.monadEff)({
                a: a, 
                s: s
            });
        });
    });
    var monadRoutingM = new Prelude.Monad(function () {
        return applicativeRoutingM;
    }, function () {
        return bindRoutingM;
    });
    var param = function (v) {
        return Prelude[">>="](bindRoutingM)(getState)(function (_35) {
            var n = ":v" + Prelude.show(Prelude.showNumber)(_35.variableIndex);
            return Prelude[">>="](bindRoutingM)(liftRoutingM(paramImpl(_35.routerInstance, n, pathToString(v))))(function () {
                return Prelude[">>="](bindRoutingM)(succIndex)(function () {
                    return Prelude["return"](monadRoutingM)(new Param(n));
                });
            });
        });
    };
    var applicativeCallback = new Prelude.Applicative(function () {
        return applyCallback;
    }, function (a) {
        return Callback(function (_465) {
            return Prelude["return"](Control_Monad_Eff.monadEff)(a);
        });
    });
    var monadCallback = new Prelude.Monad(function () {
        return applicativeCallback;
    }, function () {
        return bindCallback;
    });
    var monadEffCallback = new Control_Monad_Eff_Class.MonadEff(function () {
        return monadCallback;
    }, function (m) {
        return Callback(function (_466) {
            return m;
        });
    });
    var any = Any.value;
    return {
        route3: route3, 
        route2: route2, 
        route1: route1, 
        route0: route0, 
        routes3: routes3, 
        routes2: routes2, 
        routes1: routes1, 
        routes0: routes0, 
        param: param, 
        "+/": $plus$div, 
        "-/": $minus$div, 
        regex: regex, 
        any: any, 
        exact: exact, 
        empty: empty, 
        notFound: notFound, 
        useHistoryAPI: useHistoryAPI, 
        setRoute: setRoute, 
        unsafeGlobalRoute: unsafeGlobalRoute, 
        runRouter: runRouter, 
        functorRoutingM: functorRoutingM, 
        applyRoutingM: applyRoutingM, 
        applicativeRoutingM: applicativeRoutingM, 
        bindRoutingM: bindRoutingM, 
        monadRoutingM: monadRoutingM, 
        functorCallback: functorCallback, 
        applyCallback: applyCallback, 
        applicativeCallback: applicativeCallback, 
        bindCallback: bindCallback, 
        monadCallback: monadCallback, 
        monadEffCallback: monadEffCallback, 
        showPath: showPath, 
        showPathes: showPathes
    };
})();
var PS = PS || {};
PS.Main = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Network_Routing_Client = PS.Network_Routing_Client;
    var Control_Monad_Eff_Class = PS.Control_Monad_Eff_Class;
    var Debug_Trace = PS.Debug_Trace;
    var Data_Function = PS.Data_Function;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    
function onDOMConentLoaded(f){
  return function Eff(){
    document.addEventListener("DOMContentLoaded", function(){f()});
  }
};
    
function attachOnClickById(id, fn) {
  return function Eff(){
    document.getElementById(id).addEventListener('click', function(){
      fn();
    });
  }
};
    var main = function __do() {
        var _39 = Network_Routing_Client.runRouter(Prelude[">>="](Network_Routing_Client.bindRoutingM)(Network_Routing_Client.param(Network_Routing_Client.exact("api")))(function (_38) {
            return Prelude[">>="](Network_Routing_Client.bindRoutingM)(Network_Routing_Client.param(Network_Routing_Client.regex("[0-9]+")))(function (_37) {
                return Prelude[">>="](Network_Routing_Client.bindRoutingM)(Network_Routing_Client.route0(Network_Routing_Client.empty)(Control_Monad_Eff_Class.liftEff(Control_Monad_Eff_Class.monadEffEff)(Debug_Trace.trace("root"))))(function () {
                    return Prelude[">>="](Network_Routing_Client.bindRoutingM)(Network_Routing_Client.route0(Network_Routing_Client["-/"](_38)(Network_Routing_Client.empty))(Control_Monad_Eff_Class.liftEff(Control_Monad_Eff_Class.monadEffEff)(Debug_Trace.trace("api"))))(function () {
                        return Prelude[">>="](Network_Routing_Client.bindRoutingM)(Network_Routing_Client.route1(Network_Routing_Client["-/"](_38)(Network_Routing_Client["+/"](_37)(Network_Routing_Client.empty)))(function (n) {
                            return Prelude[">>="](Network_Routing_Client.bindCallback)(Control_Monad_Eff_Class.liftEff(Network_Routing_Client.monadEffCallback)(Debug_Trace.trace("api number: " + n)))(function () {
                                var _1363 = n === "1";
                                if (_1363) {
                                    return Prelude[">>="](Network_Routing_Client.bindCallback)(Control_Monad_Eff_Class.liftEff(Network_Routing_Client.monadEffCallback)(Debug_Trace.trace("redirect to /")))(function () {
                                        return Network_Routing_Client.setRoute("/");
                                    });
                                };
                                if (!_1363) {
                                    return Prelude["return"](Network_Routing_Client.monadCallback)(Prelude.unit);
                                };
                                throw new Error("Failed pattern match");
                            });
                        }))(function () {
                            return Prelude[">>="](Network_Routing_Client.bindRoutingM)(Network_Routing_Client.route2(Network_Routing_Client["-/"](_38)(Network_Routing_Client["-/"](Network_Routing_Client.exact("show"))(Network_Routing_Client["+/"](_37)(Network_Routing_Client["+/"](Network_Routing_Client.any)(Network_Routing_Client.empty)))))(function (i) {
                                return function (a) {
                                    return Control_Monad_Eff_Class.liftEff(Network_Routing_Client.monadEffCallback)(Debug_Trace.trace("api show: " + (i + (", " + a))));
                                };
                            }))(function () {
                                return Network_Routing_Client.notFound(Prelude[">>="](Network_Routing_Client.bindCallback)(Control_Monad_Eff_Class.liftEff(Network_Routing_Client.monadEffCallback)(Debug_Trace.trace("not found")))(function () {
                                    return Network_Routing_Client.setRoute("/");
                                }));
                            });
                        });
                    });
                });
            });
        }))();
        return onDOMConentLoaded(function __do() {
            attachOnClickById("root", _39("/"))();
            attachOnClickById("api", _39("/api"))();
            attachOnClickById("api-1", _39("/api/1"))();
            attachOnClickById("api-12", _39("/api/12"))();
            attachOnClickById("api-bad", _39("/api/bad"))();
            return attachOnClickById("api-show", _39("/api/show/12/cat"))();
        })();
    };
    return {
        main: main, 
        attachOnClickById: attachOnClickById, 
        onDOMConentLoaded: onDOMConentLoaded
    };
})();
PS.Main.main();

